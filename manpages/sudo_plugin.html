<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="generator" content="ExDoc v0.29.2">
    <meta name="project" content="Manpages v2.2.0">

    <title>sudo_plugin — Manpages v2.2.0</title>
    <link rel="stylesheet" href="dist/html-elixir-ZA3CNPHL.css" />


    <script src="dist/handlebars.runtime-NWIB6V2M.js"></script>
    <script src="dist/handlebars.templates-XRYTXUVD.js"></script>
    <script src="dist/sidebar_items-06493C4F.js"></script>

      <script src="doc-versions.js"></script>

    <script async src="dist/html-3CAFJ3W7.js"></script>

<link rel="stylesheet" href="assets/doc.css">
  </head>
  <body data-type="extras" class="page-extra">
    <script>

      try {
        var settings = JSON.parse(localStorage.getItem('ex_doc:settings') || '{}');

        if (settings.theme === 'dark' ||
           ((settings.theme === 'system' || settings.theme == null) &&
             window.matchMedia('(prefers-color-scheme: dark)').matches)
           ) {
          document.body.classList.add('dark')
        }
      } catch (error) { }
    </script>

<div class="main">

<button class="sidebar-button sidebar-toggle" aria-label="toggle sidebar">
  <i class="ri-menu-line ri-lg" title="Collapse/expand sidebar"></i>
</button>

<section class="sidebar">
  <form class="sidebar-search" action="search.html">
    <button type="submit" class="search-button" aria-label="Submit Search">
      <i class="ri-search-2-line" aria-hidden="true" title="Submit search"></i>
    </button>
    <button type="button" tabindex="-1" class="search-close-button" aria-label="Cancel Search">
      <i class="ri-close-line ri-lg" aria-hidden="true" title="Cancel search"></i>
    </button>
    <label class="search-label">
      <p class="sr-only">Search</p>
      <input name="q" type="text" class="search-input" placeholder="Search..." aria-label="Input your search terms" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" />
    </label>
  </form>

  <div class="autocomplete">
    <div class="autocomplete-results">
    </div>
  </div>

  <div class="sidebar-header">

      <a href="https://kaisenlinux.org/manpages/">
        <img src="assets/logo.jpg" alt="Manpages" class="sidebar-projectImage">
      </a>

    <div class="sidebar-projectDetails">
      <a href="https://kaisenlinux.org/manpages/" class="sidebar-projectName" translate="no">
Manpages
      </a>
      <strong class="sidebar-projectVersion" translate="no">
        v2.2.0
      </strong>
    </div>
    <ul class="sidebar-listNav">
      <li><a id="extras-list-link" href="#full-list">MANUALS</a></li>


    </ul>
  </div>

  <div class="gradient"></div>
  <ul id="full-list"></ul>
</section>

<section class="content">
  <output role="status" id="toast"></output>
  <div class="content-outer">
    <div id="content" class="content-inner">

<h1>
<button class="icon-action display-settings">
  <i class="ri-settings-3-line"></i>
  <span class="sr-only">Settings</span>
</button>



  <span>sudo_plugin</span>
</h1>

<p>SUDO_PLUGIN(5)                                                                   BSD File Formats Manual                                                                   SUDO_PLUGIN(5)</p><p>NAME</p><pre><code class="makeup elixir" translate="no"><span class="w"> </span><span class="n">sudo_plugin</span><span class="w"> </span><span class="err">—</span><span class="w"> </span><span class="nc">Sudo</span><span class="w"> </span><span class="nc">Plugin</span><span class="w"> </span><span class="nc">API</span></code></pre><p>DESCRIPTION</p><pre><code class="makeup elixir" translate="no"><span class="w"> </span><span class="nc">Starting</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">version</span><span class="w"> </span><span class="mf">1.8</span><span class="p">,</span><span class="w"> </span><span class="n">sudo</span><span class="w"> </span><span class="n">supports</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">plugin</span><span class="w"> </span><span class="nc">API</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">policy</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">session</span><span class="w"> </span><span class="n">logging</span><span class="o">.</span><span class="w">  </span><span class="nc">Plugins</span><span class="w"> </span><span class="n">may</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">compiled</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="n">dynamic</span><span class="w"> </span><span class="n">shared</span><span class="w"> </span><span class="n">objects</span><span class="w"> </span><span class="p" data-group-id="2419232078-1">(</span><span class="n">the</span><span class="w"> </span><span class="n">default</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">systems</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">support</span><span class="w"> </span><span class="n">them</span><span class="p" data-group-id="2419232078-1">)</span><span class="w">
 </span><span class="ow">or</span><span class="w"> </span><span class="n">compiled</span><span class="w"> </span><span class="n">statically</span><span class="w"> </span><span class="n">into</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">sudo</span><span class="w"> </span><span class="n">binary</span><span class="w"> </span><span class="n">itself</span><span class="o">.</span><span class="w">  </span><span class="nc">By</span><span class="w"> </span><span class="n">default</span><span class="p">,</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">sudoers</span><span class="w"> </span><span class="n">plugin</span><span class="w"> </span><span class="n">provides</span><span class="w"> </span><span class="n">audit</span><span class="p">,</span><span class="w"> </span><span class="n">security</span><span class="w"> </span><span class="n">policy</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="nc">I</span><span class="o">/</span><span class="nc">O</span><span class="w"> </span><span class="n">logging</span><span class="w"> </span><span class="n">capabilities</span><span class="o">.</span><span class="w">  </span><span class="nc">Via</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">plugin</span><span class="w"> </span><span class="nc">API</span><span class="p">,</span><span class="w"> </span><span class="n">sudo</span><span class="w"> </span><span class="n">can</span><span class="w"> </span><span class="n">be</span><span class="w">
 </span><span class="n">configured</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="kn">use</span><span class="w"> </span><span class="n">alternate</span><span class="w"> </span><span class="n">plugins</span><span class="w"> </span><span class="n">provided</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">third</span><span class="w"> </span><span class="n">parties</span><span class="o">.</span><span class="w">  </span><span class="nc">The</span><span class="w"> </span><span class="n">plugins</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">used</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">specified</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">sudo</span><span class="o">.</span><span class="n">conf</span><span class="p" data-group-id="2419232078-2">(</span><span class="mi">5</span><span class="p" data-group-id="2419232078-2">)</span><span class="w"> </span><span class="n">file</span><span class="o">.</span><span class="w">

 </span><span class="nc">The</span><span class="w"> </span><span class="nc">API</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">versioned</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">major</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">minor</span><span class="w"> </span><span class="n">number</span><span class="o">.</span><span class="w">  </span><span class="nc">The</span><span class="w"> </span><span class="n">minor</span><span class="w"> </span><span class="n">version</span><span class="w"> </span><span class="n">number</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">incremented</span><span class="w"> </span><span class="ow">when</span><span class="w"> </span><span class="n">additions</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">made</span><span class="o">.</span><span class="w">  </span><span class="nc">The</span><span class="w"> </span><span class="n">major</span><span class="w"> </span><span class="n">number</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">incremented</span><span class="w"> </span><span class="ow">when</span><span class="w"> </span><span class="n">incompatible</span><span class="w"> </span><span class="n">changes</span><span class="w"> </span><span class="n">are</span><span class="w">
 </span><span class="n">made</span><span class="o">.</span><span class="w">  </span><span class="nc">A</span><span class="w"> </span><span class="n">plugin</span><span class="w"> </span><span class="n">should</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">check</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">version</span><span class="w"> </span><span class="n">passed</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">it</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">make</span><span class="w"> </span><span class="n">sure</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">major</span><span class="w"> </span><span class="n">version</span><span class="w"> </span><span class="n">matches</span><span class="o">.</span><span class="w">

 </span><span class="nc">The</span><span class="w"> </span><span class="n">plugin</span><span class="w"> </span><span class="nc">API</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">defined</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="o">&lt;</span><span class="n">sudo_plugin</span><span class="o">.</span><span class="n">h</span><span class="o">&gt;</span><span class="w"> </span><span class="n">header</span><span class="w"> </span><span class="n">file</span><span class="o">.</span></code></pre><p>   Policy plugin API</p><pre><code class="makeup elixir" translate="no"><span class="w"> </span><span class="nc">A</span><span class="w"> </span><span class="n">policy</span><span class="w"> </span><span class="n">plugin</span><span class="w"> </span><span class="n">must</span><span class="w"> </span><span class="n">declare</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">populate</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">struct</span><span class="w"> </span><span class="n">policy_plugin</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">global</span><span class="w"> </span><span class="n">scope</span><span class="o">.</span><span class="w">  </span><span class="nc">This</span><span class="w"> </span><span class="n">structure</span><span class="w"> </span><span class="n">contains</span><span class="w"> </span><span class="n">pointers</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">functions</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">implement</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">sudo</span><span class="w"> </span><span class="n">policy</span><span class="w"> </span><span class="n">checks</span><span class="o">.</span><span class="w">  </span><span class="nc">The</span><span class="w">
 </span><span class="n">name</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">symbol</span><span class="w"> </span><span class="n">should</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">specified</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">sudo</span><span class="o">.</span><span class="n">conf</span><span class="p" data-group-id="7867108359-1">(</span><span class="mi">5</span><span class="p" data-group-id="7867108359-1">)</span><span class="w"> </span><span class="n">along</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">path</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">plugin</span><span class="w"> </span><span class="n">so</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">sudo</span><span class="w"> </span><span class="n">can</span><span class="w"> </span><span class="n">load</span><span class="w"> </span><span class="n">it</span><span class="o">.</span><span class="w">

 </span><span class="n">struct</span><span class="w"> </span><span class="n">policy_plugin</span><span class="w"> </span><span class="p" data-group-id="7867108359-2">{</span><span class="w">
 </span><span class="c1">#define SUDO_POLICY_PLUGIN     1</span><span class="w">
     </span><span class="n">unsigned</span><span class="w"> </span><span class="n">int</span><span class="w"> </span><span class="n">type</span><span class="p">;</span><span class="w"> </span><span class="o">/</span><span class="o">*</span><span class="w"> </span><span class="n">always</span><span class="w"> </span><span class="nc">SUDO_POLICY_PLUGIN</span><span class="w"> </span><span class="o">*</span><span class="o">/</span><span class="w">
     </span><span class="n">unsigned</span><span class="w"> </span><span class="n">int</span><span class="w"> </span><span class="n">version</span><span class="p">;</span><span class="w"> </span><span class="o">/</span><span class="o">*</span><span class="w"> </span><span class="n">always</span><span class="w"> </span><span class="nc">SUDO_API_VERSION</span><span class="w"> </span><span class="o">*</span><span class="o">/</span><span class="w">
     </span><span class="n">int</span><span class="w"> </span><span class="p" data-group-id="7867108359-3">(</span><span class="o">*</span><span class="n">open</span><span class="p" data-group-id="7867108359-3">)</span><span class="p" data-group-id="7867108359-4">(</span><span class="n">unsigned</span><span class="w"> </span><span class="n">int</span><span class="w"> </span><span class="n">version</span><span class="p">,</span><span class="w"> </span><span class="n">sudo_conv_t</span><span class="w"> </span><span class="n">conversation</span><span class="p">,</span><span class="w">
         </span><span class="n">sudo_printf_t</span><span class="w"> </span><span class="n">sudo_plugin_printf</span><span class="p">,</span><span class="w"> </span><span class="n">char</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">const</span><span class="w"> </span><span class="n">settings</span><span class="p" data-group-id="7867108359-5">[</span><span class="p" data-group-id="7867108359-5">]</span><span class="p">,</span><span class="w">
         </span><span class="n">char</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">const</span><span class="w"> </span><span class="n">user_info</span><span class="p" data-group-id="7867108359-6">[</span><span class="p" data-group-id="7867108359-6">]</span><span class="p">,</span><span class="w"> </span><span class="n">char</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">const</span><span class="w"> </span><span class="n">user_env</span><span class="p" data-group-id="7867108359-7">[</span><span class="p" data-group-id="7867108359-7">]</span><span class="p">,</span><span class="w">
         </span><span class="n">char</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">const</span><span class="w"> </span><span class="n">plugin_options</span><span class="p" data-group-id="7867108359-8">[</span><span class="p" data-group-id="7867108359-8">]</span><span class="p">,</span><span class="w"> </span><span class="n">const</span><span class="w"> </span><span class="n">char</span><span class="w"> </span><span class="o">*</span><span class="o">*</span><span class="n">errstr</span><span class="p" data-group-id="7867108359-4">)</span><span class="p">;</span><span class="w">
     </span><span class="n">void</span><span class="w"> </span><span class="p" data-group-id="7867108359-9">(</span><span class="o">*</span><span class="n">close</span><span class="p" data-group-id="7867108359-9">)</span><span class="p" data-group-id="7867108359-10">(</span><span class="n">int</span><span class="w"> </span><span class="n">exit_status</span><span class="p">,</span><span class="w"> </span><span class="n">int</span><span class="w"> </span><span class="n">error</span><span class="p" data-group-id="7867108359-10">)</span><span class="p">;</span><span class="w">
     </span><span class="n">int</span><span class="w"> </span><span class="p" data-group-id="7867108359-11">(</span><span class="o">*</span><span class="n">show_version</span><span class="p" data-group-id="7867108359-11">)</span><span class="p" data-group-id="7867108359-12">(</span><span class="n">int</span><span class="w"> </span><span class="n">verbose</span><span class="p" data-group-id="7867108359-12">)</span><span class="p">;</span><span class="w">
     </span><span class="n">int</span><span class="w"> </span><span class="p" data-group-id="7867108359-13">(</span><span class="o">*</span><span class="n">check_policy</span><span class="p" data-group-id="7867108359-13">)</span><span class="p" data-group-id="7867108359-14">(</span><span class="n">int</span><span class="w"> </span><span class="n">argc</span><span class="p">,</span><span class="w"> </span><span class="n">char</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">const</span><span class="w"> </span><span class="n">argv</span><span class="p" data-group-id="7867108359-15">[</span><span class="p" data-group-id="7867108359-15">]</span><span class="p">,</span><span class="w">
         </span><span class="n">char</span><span class="w"> </span><span class="o">*</span><span class="n">env_add</span><span class="p" data-group-id="7867108359-16">[</span><span class="p" data-group-id="7867108359-16">]</span><span class="p">,</span><span class="w"> </span><span class="n">char</span><span class="w"> </span><span class="o">*</span><span class="o">*</span><span class="n">command_info</span><span class="p" data-group-id="7867108359-17">[</span><span class="p" data-group-id="7867108359-17">]</span><span class="p">,</span><span class="w">
         </span><span class="n">char</span><span class="w"> </span><span class="o">*</span><span class="o">*</span><span class="n">argv_out</span><span class="p" data-group-id="7867108359-18">[</span><span class="p" data-group-id="7867108359-18">]</span><span class="p">,</span><span class="w"> </span><span class="n">char</span><span class="w"> </span><span class="o">*</span><span class="o">*</span><span class="n">user_env_out</span><span class="p" data-group-id="7867108359-19">[</span><span class="p" data-group-id="7867108359-19">]</span><span class="p">,</span><span class="w"> </span><span class="n">const</span><span class="w"> </span><span class="n">char</span><span class="w"> </span><span class="o">*</span><span class="o">*</span><span class="n">errstr</span><span class="p" data-group-id="7867108359-14">)</span><span class="p">;</span><span class="w">
     </span><span class="n">int</span><span class="w"> </span><span class="p" data-group-id="7867108359-20">(</span><span class="o">*</span><span class="n">list</span><span class="p" data-group-id="7867108359-20">)</span><span class="p" data-group-id="7867108359-21">(</span><span class="n">int</span><span class="w"> </span><span class="n">argc</span><span class="p">,</span><span class="w"> </span><span class="n">char</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">const</span><span class="w"> </span><span class="n">argv</span><span class="p" data-group-id="7867108359-22">[</span><span class="p" data-group-id="7867108359-22">]</span><span class="p">,</span><span class="w"> </span><span class="n">int</span><span class="w"> </span><span class="n">verbose</span><span class="p">,</span><span class="w">
         </span><span class="n">const</span><span class="w"> </span><span class="n">char</span><span class="w"> </span><span class="o">*</span><span class="n">user</span><span class="p">,</span><span class="w"> </span><span class="n">const</span><span class="w"> </span><span class="n">char</span><span class="w"> </span><span class="o">*</span><span class="o">*</span><span class="n">errstr</span><span class="p" data-group-id="7867108359-21">)</span><span class="p">;</span><span class="w">
     </span><span class="n">int</span><span class="w"> </span><span class="p" data-group-id="7867108359-23">(</span><span class="o">*</span><span class="n">validate</span><span class="p" data-group-id="7867108359-23">)</span><span class="p" data-group-id="7867108359-24">(</span><span class="n">const</span><span class="w"> </span><span class="n">char</span><span class="w"> </span><span class="o">*</span><span class="o">*</span><span class="n">errstr</span><span class="p" data-group-id="7867108359-24">)</span><span class="p">;</span><span class="w">
     </span><span class="n">void</span><span class="w"> </span><span class="p" data-group-id="7867108359-25">(</span><span class="o">*</span><span class="n">invalidate</span><span class="p" data-group-id="7867108359-25">)</span><span class="p" data-group-id="7867108359-26">(</span><span class="n">int</span><span class="w"> </span><span class="n">rmcred</span><span class="p" data-group-id="7867108359-26">)</span><span class="p">;</span><span class="w">
     </span><span class="n">int</span><span class="w"> </span><span class="p" data-group-id="7867108359-27">(</span><span class="o">*</span><span class="n">init_session</span><span class="p" data-group-id="7867108359-27">)</span><span class="p" data-group-id="7867108359-28">(</span><span class="n">struct</span><span class="w"> </span><span class="n">passwd</span><span class="w"> </span><span class="o">*</span><span class="n">pwd</span><span class="p">,</span><span class="w"> </span><span class="n">char</span><span class="w"> </span><span class="o">*</span><span class="o">*</span><span class="n">user_env</span><span class="p" data-group-id="7867108359-29">[</span><span class="p" data-group-id="7867108359-29">]</span><span class="p">,</span><span class="w">
         </span><span class="n">const</span><span class="w"> </span><span class="n">char</span><span class="w"> </span><span class="o">*</span><span class="o">*</span><span class="n">errstr</span><span class="p" data-group-id="7867108359-28">)</span><span class="p">;</span><span class="w">
     </span><span class="n">void</span><span class="w"> </span><span class="p" data-group-id="7867108359-30">(</span><span class="o">*</span><span class="n">register_hooks</span><span class="p" data-group-id="7867108359-30">)</span><span class="p" data-group-id="7867108359-31">(</span><span class="n">int</span><span class="w"> </span><span class="n">version</span><span class="p">,</span><span class="w">
        </span><span class="n">int</span><span class="w"> </span><span class="p" data-group-id="7867108359-32">(</span><span class="o">*</span><span class="n">register_hook</span><span class="p" data-group-id="7867108359-32">)</span><span class="p" data-group-id="7867108359-33">(</span><span class="n">struct</span><span class="w"> </span><span class="n">sudo_hook</span><span class="w"> </span><span class="o">*</span><span class="n">hook</span><span class="p" data-group-id="7867108359-33">)</span><span class="p" data-group-id="7867108359-31">)</span><span class="p">;</span><span class="w">
     </span><span class="n">void</span><span class="w"> </span><span class="p" data-group-id="7867108359-34">(</span><span class="o">*</span><span class="n">deregister_hooks</span><span class="p" data-group-id="7867108359-34">)</span><span class="p" data-group-id="7867108359-35">(</span><span class="n">int</span><span class="w"> </span><span class="n">version</span><span class="p">,</span><span class="w">
        </span><span class="n">int</span><span class="w"> </span><span class="p" data-group-id="7867108359-36">(</span><span class="o">*</span><span class="n">deregister_hook</span><span class="p" data-group-id="7867108359-36">)</span><span class="p" data-group-id="7867108359-37">(</span><span class="n">struct</span><span class="w"> </span><span class="n">sudo_hook</span><span class="w"> </span><span class="o">*</span><span class="n">hook</span><span class="p" data-group-id="7867108359-37">)</span><span class="p" data-group-id="7867108359-35">)</span><span class="p">;</span><span class="w">
     </span><span class="n">struct</span><span class="w"> </span><span class="n">sudo_plugin_event</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p" data-group-id="7867108359-38">(</span><span class="o">*</span><span class="n">event_alloc</span><span class="p" data-group-id="7867108359-38">)</span><span class="p" data-group-id="7867108359-39">(</span><span class="n">void</span><span class="p" data-group-id="7867108359-39">)</span><span class="p">;</span><span class="w">
 </span><span class="p" data-group-id="7867108359-2">}</span><span class="p">;</span><span class="w">

 </span><span class="nc">A</span><span class="w"> </span><span class="n">struct</span><span class="w"> </span><span class="n">policy_plugin</span><span class="w"> </span><span class="n">has</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">following</span><span class="w"> </span><span class="ss">fields</span><span class="p">:</span><span class="w">

 </span><span class="n">type</span><span class="w">  </span><span class="nc">The</span><span class="w"> </span><span class="n">type</span><span class="w"> </span><span class="n">field</span><span class="w"> </span><span class="n">should</span><span class="w"> </span><span class="n">always</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">set</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="nc">SUDO_POLICY_PLUGIN</span><span class="o">.</span><span class="w">

 </span><span class="n">version</span><span class="w">
       </span><span class="nc">The</span><span class="w"> </span><span class="n">version</span><span class="w"> </span><span class="n">field</span><span class="w"> </span><span class="n">should</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">set</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="nc">SUDO_API_VERSION</span><span class="o">.</span><span class="w">

       </span><span class="nc">This</span><span class="w"> </span><span class="n">allows</span><span class="w"> </span><span class="n">sudo</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">determine</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nc">API</span><span class="w"> </span><span class="n">version</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">plugin</span><span class="w"> </span><span class="n">was</span><span class="w"> </span><span class="n">built</span><span class="w"> </span><span class="n">against</span><span class="o">.</span><span class="w">

 </span><span class="n">open</span><span class="w">
       </span><span class="n">int</span><span class="w"> </span><span class="p" data-group-id="7867108359-40">(</span><span class="o">*</span><span class="n">open</span><span class="p" data-group-id="7867108359-40">)</span><span class="p" data-group-id="7867108359-41">(</span><span class="n">unsigned</span><span class="w"> </span><span class="n">int</span><span class="w"> </span><span class="n">version</span><span class="p">,</span><span class="w"> </span><span class="n">sudo_conv_t</span><span class="w"> </span><span class="n">conversation</span><span class="p">,</span><span class="w">
           </span><span class="n">sudo_printf_t</span><span class="w"> </span><span class="n">sudo_plugin_printf</span><span class="p">,</span><span class="w"> </span><span class="n">char</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">const</span><span class="w"> </span><span class="n">settings</span><span class="p" data-group-id="7867108359-42">[</span><span class="p" data-group-id="7867108359-42">]</span><span class="p">,</span><span class="w">
           </span><span class="n">char</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">const</span><span class="w"> </span><span class="n">user_info</span><span class="p" data-group-id="7867108359-43">[</span><span class="p" data-group-id="7867108359-43">]</span><span class="p">,</span><span class="w"> </span><span class="n">char</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">const</span><span class="w"> </span><span class="n">user_env</span><span class="p" data-group-id="7867108359-44">[</span><span class="p" data-group-id="7867108359-44">]</span><span class="p">,</span><span class="w">
           </span><span class="n">char</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">const</span><span class="w"> </span><span class="n">plugin_options</span><span class="p" data-group-id="7867108359-45">[</span><span class="p" data-group-id="7867108359-45">]</span><span class="p">,</span><span class="w"> </span><span class="n">const</span><span class="w"> </span><span class="n">char</span><span class="w"> </span><span class="o">*</span><span class="o">*</span><span class="n">errstr</span><span class="p" data-group-id="7867108359-41">)</span><span class="p">;</span><span class="w">

       </span><span class="nc">Returns</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">success</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">failure</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mi">1</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">general</span><span class="w"> </span><span class="n">error</span><span class="w"> </span><span class="n">occurred</span><span class="p">,</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="o">-</span><span class="mi">2</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">there</span><span class="w"> </span><span class="n">was</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">usage</span><span class="w"> </span><span class="n">error</span><span class="o">.</span><span class="w">  </span><span class="nc">In</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">latter</span><span class="w"> </span><span class="k">case</span><span class="p">,</span><span class="w"> </span><span class="n">sudo</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">print</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">usage</span><span class="w"> </span><span class="n">message</span><span class="w"> </span><span class="n">before</span><span class="w"> </span><span class="n">it</span><span class="w"> </span><span class="n">exits</span><span class="o">.</span><span class="w">
       </span><span class="nc">If</span><span class="w"> </span><span class="n">an</span><span class="w"> </span><span class="n">error</span><span class="w"> </span><span class="n">occurs</span><span class="p">,</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">plugin</span><span class="w"> </span><span class="n">may</span><span class="w"> </span><span class="n">optionally</span><span class="w"> </span><span class="n">call</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">conversation</span><span class="p" data-group-id="7867108359-46">(</span><span class="p" data-group-id="7867108359-46">)</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">sudo_plugin_printf</span><span class="p" data-group-id="7867108359-47">(</span><span class="p" data-group-id="7867108359-47">)</span><span class="w"> </span><span class="n">function</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="nc">SUDO_CONF_ERROR_MSG</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">present</span><span class="w"> </span><span class="n">additional</span><span class="w"> </span><span class="n">error</span><span class="w"> </span><span class="n">information</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">the</span><span class="w">
       </span><span class="n">user</span><span class="o">.</span><span class="w">

       </span><span class="nc">The</span><span class="w"> </span><span class="n">function</span><span class="w"> </span><span class="n">arguments</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="ss">follows</span><span class="p">:</span><span class="w">

       </span><span class="n">version</span><span class="w">
             </span><span class="nc">The</span><span class="w"> </span><span class="n">version</span><span class="w"> </span><span class="n">passed</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">sudo</span><span class="w"> </span><span class="n">allows</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">plugin</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">determine</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">major</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">minor</span><span class="w"> </span><span class="n">version</span><span class="w"> </span><span class="n">number</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">plugin</span><span class="w"> </span><span class="nc">API</span><span class="w"> </span><span class="n">supported</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">sudo</span><span class="o">.</span><span class="w">

       </span><span class="n">conversation</span><span class="w">
             </span><span class="nc">A</span><span class="w"> </span><span class="n">pointer</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">conversation</span><span class="p" data-group-id="7867108359-48">(</span><span class="p" data-group-id="7867108359-48">)</span><span class="w"> </span><span class="n">function</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">can</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">used</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">plugin</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">interact</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">user</span><span class="w"> </span><span class="p" data-group-id="7867108359-49">(</span><span class="n">see</span><span class="w"> </span><span class="nc">Conversation</span><span class="w"> </span><span class="nc">API</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">details</span><span class="p" data-group-id="7867108359-49">)</span><span class="o">.</span><span class="w">  </span><span class="nc">Returns</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">success</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="o">-</span><span class="mi">1</span><span class="w"> </span><span class="n">on</span><span class="w">
             </span><span class="n">failure</span><span class="o">.</span><span class="w">

       </span><span class="n">sudo_plugin_printf</span><span class="w">
             </span><span class="nc">A</span><span class="w"> </span><span class="n">pointer</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">printf</span><span class="p" data-group-id="7867108359-50">(</span><span class="p" data-group-id="7867108359-50">)</span><span class="o">-</span><span class="n">style</span><span class="w"> </span><span class="n">function</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">may</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">used</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">display</span><span class="w"> </span><span class="n">informational</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">error</span><span class="w"> </span><span class="n">messages</span><span class="w"> </span><span class="p" data-group-id="7867108359-51">(</span><span class="n">see</span><span class="w"> </span><span class="nc">Conversation</span><span class="w"> </span><span class="nc">API</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">details</span><span class="p" data-group-id="7867108359-51">)</span><span class="o">.</span><span class="w">  </span><span class="nc">Returns</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">number</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">characters</span><span class="w">
             </span><span class="n">printed</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">success</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="o">-</span><span class="mi">1</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">failure</span><span class="o">.</span><span class="w">

       </span><span class="n">settings</span><span class="w">
             </span><span class="nc">A</span><span class="w"> </span><span class="n">vector</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">user</span><span class="o">-</span><span class="n">supplied</span><span class="w"> </span><span class="n">sudo</span><span class="w"> </span><span class="n">settings</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">form</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="err">“</span><span class="n">name</span><span class="o">=</span><span class="n">value</span><span class="err">”</span><span class="w"> </span><span class="n">strings</span><span class="o">.</span><span class="w">  </span><span class="nc">The</span><span class="w"> </span><span class="n">vector</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">terminated</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="nc">NULL</span><span class="w"> </span><span class="n">pointer</span><span class="o">.</span><span class="w">  </span><span class="nc">These</span><span class="w"> </span><span class="n">settings</span><span class="w"> </span><span class="n">correspond</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">options</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">user</span><span class="w">
             </span><span class="n">specified</span><span class="w"> </span><span class="ow">when</span><span class="w"> </span><span class="n">running</span><span class="w"> </span><span class="n">sudo</span><span class="o">.</span><span class="w">  </span><span class="nc">As</span><span class="w"> </span><span class="n">such</span><span class="p">,</span><span class="w"> </span><span class="n">they</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">only</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">present</span><span class="w"> </span><span class="ow">when</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">corresponding</span><span class="w"> </span><span class="n">option</span><span class="w"> </span><span class="n">has</span><span class="w"> </span><span class="n">been</span><span class="w"> </span><span class="n">specified</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">command</span><span class="w"> </span><span class="n">line</span><span class="o">.</span><span class="w">

             </span><span class="nc">When</span><span class="w"> </span><span class="n">parsing</span><span class="w"> </span><span class="n">settings</span><span class="p">,</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">plugin</span><span class="w"> </span><span class="n">should</span><span class="w"> </span><span class="n">split</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">first</span><span class="w"> </span><span class="n">equal</span><span class="w"> </span><span class="n">sign</span><span class="w"> </span><span class="p" data-group-id="7867108359-52">(</span><span class="err">‘</span><span class="o">=</span><span class="err">’</span><span class="p" data-group-id="7867108359-52">)</span><span class="w"> </span><span class="n">since</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="n">field</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">never</span><span class="w"> </span><span class="n">include</span><span class="w"> </span><span class="n">one</span><span class="w"> </span><span class="n">itself</span><span class="w"> </span><span class="n">but</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">value</span><span class="w"> </span><span class="n">might</span><span class="o">.</span><span class="w">

             </span><span class="nc">The</span><span class="w"> </span><span class="n">following</span><span class="w"> </span><span class="n">values</span><span class="w"> </span><span class="n">may</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">set</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="ss">sudo</span><span class="p">:</span><span class="w">

             </span><span class="n">bsdauth_type</span><span class="o">=</span><span class="n">string</span><span class="w">
                   </span><span class="nc">Authentication</span><span class="w"> </span><span class="n">type</span><span class="p">,</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">specified</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="o">-</span><span class="n">a</span><span class="w"> </span><span class="n">option</span><span class="p">,</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="kn">use</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">systems</span><span class="w"> </span><span class="n">where</span><span class="w"> </span><span class="nc">BSD</span><span class="w"> </span><span class="n">authentication</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">supported</span><span class="o">.</span><span class="w">

             </span><span class="n">closefrom</span><span class="o">=</span><span class="n">number</span><span class="w">
                   </span><span class="nc">If</span><span class="w"> </span><span class="n">specified</span><span class="p">,</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">user</span><span class="w"> </span><span class="n">has</span><span class="w"> </span><span class="n">requested</span><span class="w"> </span><span class="n">via</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="o">-</span><span class="nc">C</span><span class="w"> </span><span class="n">option</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">sudo</span><span class="w"> </span><span class="n">close</span><span class="w"> </span><span class="n">all</span><span class="w"> </span><span class="n">files</span><span class="w"> </span><span class="n">descriptors</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">value</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">number</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">higher</span><span class="o">.</span><span class="w">  </span><span class="nc">The</span><span class="w"> </span><span class="n">plugin</span><span class="w"> </span><span class="n">may</span><span class="w"> </span><span class="n">optionally</span><span class="w"> </span><span class="n">pass</span><span class="w">
                   </span><span class="n">this</span><span class="p">,</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">another</span><span class="w"> </span><span class="n">value</span><span class="p">,</span><span class="w"> </span><span class="n">back</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">command_info</span><span class="w"> </span><span class="n">list</span><span class="o">.</span><span class="w">

             </span><span class="n">cmnd_chroot</span><span class="o">=</span><span class="n">string</span><span class="w">
                   </span><span class="nc">The</span><span class="w"> </span><span class="n">root</span><span class="w"> </span><span class="n">directory</span><span class="w"> </span><span class="p" data-group-id="7867108359-53">(</span><span class="n">see</span><span class="w"> </span><span class="n">chroot</span><span class="p" data-group-id="7867108359-54">(</span><span class="mi">2</span><span class="p" data-group-id="7867108359-54">)</span><span class="p" data-group-id="7867108359-53">)</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">run</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">command</span><span class="w"> </span><span class="ow">in</span><span class="p">,</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="n">specified</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">user</span><span class="w"> </span><span class="n">via</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="o">-</span><span class="nc">R</span><span class="w"> </span><span class="n">option</span><span class="o">.</span><span class="w">  </span><span class="nc">The</span><span class="w"> </span><span class="n">plugin</span><span class="w"> </span><span class="n">may</span><span class="w"> </span><span class="n">ignore</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">restrict</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">user</span><span class="sc">&#39;s ability to
                   specify a new root directory.  Only available starting with API version 1.16.

             cmnd_cwd=string
                   The working directory to run the command in, as specified by the user via the -D option.  The plugin may ignore or restrict the user&#39;</span><span class="n">s</span><span class="w"> </span><span class="n">ability</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">specify</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">new</span><span class="w">
                   </span><span class="n">working</span><span class="w"> </span><span class="n">directory</span><span class="o">.</span><span class="w">  </span><span class="nc">Only</span><span class="w"> </span><span class="n">available</span><span class="w"> </span><span class="n">starting</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="nc">API</span><span class="w"> </span><span class="n">version</span><span class="w"> </span><span class="mf">1.16</span><span class="o">.</span><span class="w">

             </span><span class="n">debug_flags</span><span class="o">=</span><span class="n">string</span><span class="w">
                   </span><span class="nc">A</span><span class="w"> </span><span class="n">debug</span><span class="w"> </span><span class="n">file</span><span class="w"> </span><span class="n">path</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="n">followed</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">space</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">comma</span><span class="o">-</span><span class="n">separated</span><span class="w"> </span><span class="n">list</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">debug</span><span class="w"> </span><span class="n">flags</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">correspond</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">plugin</span><span class="sc">&#39;s Debug entry in sudo.conf(5), if there is one.
                   The flags are passed to the plugin exactly as they appear in sudo.conf(5).  The syntax used by sudo and the sudoers plugin is subsystem@priority but a plugin is
                   free to use a different format so long as it does not include a comma (‘,’).  Prior to sudo 1.8.12, there was no way to specify plugin-specific debug_flags so the
                   value was always the same as that used by the sudo front-end and did not include a path name, only the flags themselves.  As of version 1.7 of the plugin inter‐
                   face, sudo will only pass debug_flags if sudo.conf(5) contains a plugin-specific Debug entry.

             ignore_ticket=bool
                   Set to true if the user specified the -k option along with a command, indicating that the user wishes to ignore any cached authentication credentials.
                   implied_shell to true.  This allows sudo with no arguments to be used similarly to su(1).  If the plugin does not to support this usage, it may return a value of
                   -2 from the check_policy() function, which will cause sudo to print a usage message and exit.

             implied_shell=bool
                   If the user does not specify a program on the command line, sudo will pass the plugin the path to the user&#39;</span><span class="n">s</span><span class="w"> </span><span class="n">shell</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">set</span><span class="w"> </span><span class="n">implied_shell</span><span class="o">.</span><span class="w">

             </span><span class="n">intercept_ptrace</span><span class="o">=</span><span class="n">bool</span><span class="w">
                   </span><span class="nc">Indicates</span><span class="w"> </span><span class="n">whether</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">system</span><span class="w"> </span><span class="n">supports</span><span class="w"> </span><span class="n">intercept</span><span class="w"> </span><span class="n">mode</span><span class="w"> </span><span class="n">using</span><span class="w"> </span><span class="n">ptrace</span><span class="p" data-group-id="7867108359-55">(</span><span class="mi">2</span><span class="p" data-group-id="7867108359-55">)</span><span class="o">.</span><span class="w">  </span><span class="nc">This</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">currently</span><span class="w"> </span><span class="n">only</span><span class="w"> </span><span class="no">true</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="nc">Linux</span><span class="w"> </span><span class="n">systems</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">support</span><span class="w"> </span><span class="n">seccomp</span><span class="p" data-group-id="7867108359-56">(</span><span class="mi">2</span><span class="p" data-group-id="7867108359-56">)</span><span class="w"> </span><span class="n">filtering</span><span class="w"> </span><span class="ow">and</span><span class="w">
                   </span><span class="n">the</span><span class="w"> </span><span class="err">“</span><span class="n">trap</span><span class="err">”</span><span class="w"> </span><span class="n">action</span><span class="o">.</span><span class="w">  </span><span class="nc">Other</span><span class="w"> </span><span class="n">systems</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="kn">use</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">dynamic</span><span class="w"> </span><span class="n">shared</span><span class="w"> </span><span class="n">object</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">implement</span><span class="w"> </span><span class="n">intercept</span><span class="o">.</span><span class="w">  </span><span class="nc">Only</span><span class="w"> </span><span class="n">available</span><span class="w"> </span><span class="n">starting</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="nc">API</span><span class="w"> </span><span class="n">version</span><span class="w"> </span><span class="mf">1.19</span><span class="o">.</span><span class="w">

             </span><span class="n">intercept_setid</span><span class="o">=</span><span class="n">bool</span><span class="w">
                   </span><span class="nc">Indicates</span><span class="w"> </span><span class="n">whether</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">system</span><span class="w"> </span><span class="n">supports</span><span class="w"> </span><span class="n">running</span><span class="w"> </span><span class="n">set</span><span class="o">-</span><span class="n">user</span><span class="o">-</span><span class="nc">ID</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">set</span><span class="o">-</span><span class="n">group</span><span class="o">-</span><span class="nc">ID</span><span class="w"> </span><span class="n">binaries</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">intercept</span><span class="w"> </span><span class="n">mode</span><span class="o">.</span><span class="w">  </span><span class="nc">This</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">currently</span><span class="w"> </span><span class="n">only</span><span class="w"> </span><span class="no">true</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="nc">Linux</span><span class="w"> </span><span class="n">systems</span><span class="w"> </span><span class="n">that</span><span class="w">
                   </span><span class="n">support</span><span class="w"> </span><span class="n">seccomp</span><span class="p" data-group-id="7867108359-57">(</span><span class="mi">2</span><span class="p" data-group-id="7867108359-57">)</span><span class="w"> </span><span class="n">filtering</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="err">“</span><span class="n">trap</span><span class="err">”</span><span class="w"> </span><span class="n">action</span><span class="o">.</span><span class="w">  </span><span class="nc">On</span><span class="w"> </span><span class="n">systems</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="kn">use</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">dynamic</span><span class="w"> </span><span class="n">shared</span><span class="w"> </span><span class="n">object</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">implement</span><span class="w"> </span><span class="n">intercept</span><span class="p">,</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">dynamic</span><span class="w"> </span><span class="n">linker</span><span class="w"> </span><span class="p" data-group-id="7867108359-58">(</span><span class="n">ld</span><span class="o">.</span><span class="n">so</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">equiva</span><span class="err">‐</span><span class="w">
                   </span><span class="n">lent</span><span class="p" data-group-id="7867108359-58">)</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">disable</span><span class="w"> </span><span class="n">preloading</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">shared</span><span class="w"> </span><span class="n">objects</span><span class="w"> </span><span class="ow">when</span><span class="w"> </span><span class="n">executing</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">set</span><span class="o">-</span><span class="n">user</span><span class="o">-</span><span class="nc">ID</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">set</span><span class="o">-</span><span class="n">group</span><span class="o">-</span><span class="nc">ID</span><span class="w"> </span><span class="n">binary</span><span class="o">.</span><span class="w">  </span><span class="nc">This</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">disable</span><span class="w"> </span><span class="n">intercept</span><span class="w"> </span><span class="n">mode</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">program</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">any</span><span class="w">
                   </span><span class="n">other</span><span class="w"> </span><span class="n">programs</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">it</span><span class="w"> </span><span class="n">executes</span><span class="o">.</span><span class="w">  </span><span class="nc">The</span><span class="w"> </span><span class="n">policy</span><span class="w"> </span><span class="n">plugin</span><span class="w"> </span><span class="n">may</span><span class="w"> </span><span class="n">refuse</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">execute</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">set</span><span class="o">-</span><span class="n">user</span><span class="o">-</span><span class="nc">ID</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">set</span><span class="o">-</span><span class="n">group</span><span class="o">-</span><span class="nc">ID</span><span class="w"> </span><span class="n">binary</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">intercept</span><span class="w"> </span><span class="n">mode</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">avoid</span><span class="w"> </span><span class="n">this</span><span class="o">.</span><span class="w">  </span><span class="nc">Only</span><span class="w"> </span><span class="n">available</span><span class="w">
                   </span><span class="n">starting</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="nc">API</span><span class="w"> </span><span class="n">version</span><span class="w"> </span><span class="mf">1.19</span><span class="o">.</span><span class="w">

             </span><span class="n">login_class</span><span class="o">=</span><span class="n">string</span><span class="w">
                   </span><span class="nc">BSD</span><span class="w"> </span><span class="n">login</span><span class="w"> </span><span class="n">class</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="kn">use</span><span class="w"> </span><span class="ow">when</span><span class="w"> </span><span class="n">setting</span><span class="w"> </span><span class="n">resource</span><span class="w"> </span><span class="n">limits</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">nice</span><span class="w"> </span><span class="n">value</span><span class="p">,</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">specified</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="o">-</span><span class="n">c</span><span class="w"> </span><span class="n">option</span><span class="o">.</span><span class="w">

             </span><span class="n">login_shell</span><span class="o">=</span><span class="n">bool</span><span class="w">
                   </span><span class="nc">Set</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="no">true</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">user</span><span class="w"> </span><span class="n">specified</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="o">-</span><span class="n">i</span><span class="w"> </span><span class="n">option</span><span class="p">,</span><span class="w"> </span><span class="n">indicating</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">user</span><span class="w"> </span><span class="n">wishes</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">run</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">login</span><span class="w"> </span><span class="n">shell</span><span class="o">.</span><span class="w">

             </span><span class="n">max_groups</span><span class="o">=</span><span class="n">int</span><span class="w">
                   </span><span class="nc">The</span><span class="w"> </span><span class="n">maximum</span><span class="w"> </span><span class="n">number</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">groups</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">user</span><span class="w"> </span><span class="n">may</span><span class="w"> </span><span class="n">belong</span><span class="w"> </span><span class="n">to</span><span class="o">.</span><span class="w">  </span><span class="nc">This</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">only</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">present</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">there</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">corresponding</span><span class="w"> </span><span class="n">setting</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">sudo</span><span class="o">.</span><span class="n">conf</span><span class="p" data-group-id="7867108359-59">(</span><span class="mi">5</span><span class="p" data-group-id="7867108359-59">)</span><span class="o">.</span><span class="w">

             </span><span class="n">network_addrs</span><span class="o">=</span><span class="n">list</span><span class="w">
                   </span><span class="nc">A</span><span class="w"> </span><span class="n">space</span><span class="o">-</span><span class="n">separated</span><span class="w"> </span><span class="n">list</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="nc">IP</span><span class="w"> </span><span class="n">network</span><span class="w"> </span><span class="n">addresses</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">netmasks</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">form</span><span class="w"> </span><span class="err">“</span><span class="n">addr</span><span class="o">/</span><span class="n">netmask</span><span class="err">”</span><span class="p">,</span><span class="w"> </span><span class="n">e</span><span class="o">.</span><span class="n">g</span><span class="o">.</span><span class="p">,</span><span class="w"> </span><span class="err">“</span><span class="mf">192.168</span><span class="o">.</span><span class="mf">1.2</span><span class="o">/</span><span class="mf">255.255</span><span class="o">.</span><span class="mf">255.0</span><span class="err">”</span><span class="o">.</span><span class="w">  </span><span class="nc">The</span><span class="w"> </span><span class="n">address</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">netmask</span><span class="w"> </span><span class="n">pairs</span><span class="w"> </span><span class="n">may</span><span class="w"> </span><span class="n">be</span><span class="w">
                   </span><span class="n">either</span><span class="w"> </span><span class="nc">IPv4</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="nc">IPv6</span><span class="p">,</span><span class="w"> </span><span class="n">depending</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">what</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">operating</span><span class="w"> </span><span class="n">system</span><span class="w"> </span><span class="n">supports</span><span class="o">.</span><span class="w">  </span><span class="nc">If</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">address</span><span class="w"> </span><span class="n">contains</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">colon</span><span class="w"> </span><span class="p" data-group-id="7867108359-60">(</span><span class="err">‘</span><span class="p">:</span><span class="err">’</span><span class="p" data-group-id="7867108359-60">)</span><span class="p">,</span><span class="w"> </span><span class="n">it</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">an</span><span class="w"> </span><span class="nc">IPv6</span><span class="w"> </span><span class="n">address</span><span class="p">,</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="n">it</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="nc">IPv4</span><span class="o">.</span><span class="w">

             </span><span class="n">noninteractive</span><span class="o">=</span><span class="n">bool</span><span class="w">
                   </span><span class="nc">Set</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="no">true</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">user</span><span class="w"> </span><span class="n">specified</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="o">-</span><span class="n">n</span><span class="w"> </span><span class="n">option</span><span class="p">,</span><span class="w"> </span><span class="n">indicating</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">sudo</span><span class="w"> </span><span class="n">should</span><span class="w"> </span><span class="n">operate</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">non</span><span class="o">-</span><span class="n">interactive</span><span class="w"> </span><span class="n">mode</span><span class="o">.</span><span class="w">  </span><span class="nc">The</span><span class="w"> </span><span class="n">plugin</span><span class="w"> </span><span class="n">may</span><span class="w"> </span><span class="n">reject</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">command</span><span class="w"> </span><span class="n">run</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">non</span><span class="o">-</span><span class="n">interac</span><span class="err">‐</span><span class="w">
                   </span><span class="n">tive</span><span class="w"> </span><span class="n">mode</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">user</span><span class="w"> </span><span class="n">interaction</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">required</span><span class="o">.</span><span class="w">

             </span><span class="n">plugin_dir</span><span class="o">=</span><span class="n">string</span><span class="w">
                   </span><span class="nc">The</span><span class="w"> </span><span class="n">default</span><span class="w"> </span><span class="n">plugin</span><span class="w"> </span><span class="n">directory</span><span class="w"> </span><span class="n">used</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">sudo</span><span class="w"> </span><span class="n">front</span><span class="o">-</span><span class="k">end</span><span class="o">.</span><span class="w">  </span><span class="nc">This</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">default</span><span class="w"> </span><span class="n">directory</span><span class="w"> </span><span class="n">set</span><span class="w"> </span><span class="n">at</span><span class="w"> </span><span class="n">compile</span><span class="w"> </span><span class="n">time</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">may</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">correspond</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">directory</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">running</span><span class="w">
                   </span><span class="n">plugin</span><span class="w"> </span><span class="n">was</span><span class="w"> </span><span class="n">loaded</span><span class="w"> </span><span class="n">from</span><span class="o">.</span><span class="w">  </span><span class="nc">It</span><span class="w"> </span><span class="n">may</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">used</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">plugin</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">locate</span><span class="w"> </span><span class="n">support</span><span class="w"> </span><span class="n">files</span><span class="o">.</span><span class="w">

             </span><span class="n">plugin_path</span><span class="o">=</span><span class="n">string</span><span class="w">
                   </span><span class="nc">The</span><span class="w"> </span><span class="n">path</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">plugin</span><span class="w"> </span><span class="n">loaded</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">sudo</span><span class="w"> </span><span class="n">front</span><span class="o">-</span><span class="k">end</span><span class="o">.</span><span class="w">  </span><span class="nc">The</span><span class="w"> </span><span class="n">path</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">fully</span><span class="o">-</span><span class="n">qualified</span><span class="w"> </span><span class="k">unless</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">plugin</span><span class="w"> </span><span class="n">was</span><span class="w"> </span><span class="n">statically</span><span class="w"> </span><span class="n">compiled</span><span class="w"> </span><span class="n">into</span><span class="w"> </span><span class="n">sudo</span><span class="o">.</span><span class="w">

             </span><span class="n">preserve_environment</span><span class="o">=</span><span class="n">bool</span><span class="w">
                   </span><span class="nc">Set</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="no">true</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">user</span><span class="w"> </span><span class="n">specified</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="o">-</span><span class="nc">E</span><span class="w"> </span><span class="n">option</span><span class="p">,</span><span class="w"> </span><span class="n">indicating</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">user</span><span class="w"> </span><span class="n">wishes</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">preserve</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">environment</span><span class="o">.</span><span class="w">

             </span><span class="n">preserve_groups</span><span class="o">=</span><span class="n">bool</span><span class="w">
                   </span><span class="nc">Set</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="no">true</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">user</span><span class="w"> </span><span class="n">specified</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="o">-</span><span class="nc">P</span><span class="w"> </span><span class="n">option</span><span class="p">,</span><span class="w"> </span><span class="n">indicating</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">user</span><span class="w"> </span><span class="n">wishes</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">preserve</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">group</span><span class="w"> </span><span class="n">vector</span><span class="w"> </span><span class="n">instead</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">setting</span><span class="w"> </span><span class="n">it</span><span class="w"> </span><span class="n">based</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">runas</span><span class="w"> </span><span class="n">user</span><span class="o">.</span><span class="w">

             </span><span class="n">progname</span><span class="o">=</span><span class="n">string</span><span class="w">
                   </span><span class="nc">The</span><span class="w"> </span><span class="n">command</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">sudo</span><span class="w"> </span><span class="n">was</span><span class="w"> </span><span class="n">run</span><span class="w"> </span><span class="n">as</span><span class="p">,</span><span class="w"> </span><span class="n">typically</span><span class="w"> </span><span class="err">“</span><span class="n">sudo</span><span class="err">”</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="err">“</span><span class="n">sudoedit</span><span class="err">”</span><span class="o">.</span><span class="w">

             </span><span class="n">prompt</span><span class="o">=</span><span class="n">string</span><span class="w">
                   </span><span class="nc">The</span><span class="w"> </span><span class="n">prompt</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="kn">use</span><span class="w"> </span><span class="ow">when</span><span class="w"> </span><span class="n">requesting</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">password</span><span class="p">,</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">specified</span><span class="w"> </span><span class="n">via</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="o">-</span><span class="n">p</span><span class="w"> </span><span class="n">option</span><span class="o">.</span><span class="w">

             </span><span class="n">remote_host</span><span class="o">=</span><span class="n">string</span><span class="w">
                   </span><span class="nc">The</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">remote</span><span class="w"> </span><span class="n">host</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">run</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">command</span><span class="w"> </span><span class="n">on</span><span class="p">,</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">specified</span><span class="w"> </span><span class="n">via</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="o">-</span><span class="n">h</span><span class="w"> </span><span class="n">option</span><span class="o">.</span><span class="w">  </span><span class="nc">Support</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">running</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">command</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">remote</span><span class="w"> </span><span class="n">host</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">meant</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">implemented</span><span class="w">
                   </span><span class="n">via</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">helper</span><span class="w"> </span><span class="n">program</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">executed</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">place</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">user</span><span class="o">-</span><span class="n">specified</span><span class="w"> </span><span class="n">command</span><span class="o">.</span><span class="w">  </span><span class="nc">The</span><span class="w"> </span><span class="n">sudo</span><span class="w"> </span><span class="n">front</span><span class="o">-</span><span class="k">end</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">only</span><span class="w"> </span><span class="n">capable</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">executing</span><span class="w"> </span><span class="n">commands</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">local</span><span class="w"> </span><span class="n">host</span><span class="o">.</span><span class="w">  </span><span class="nc">Only</span><span class="w">
                   </span><span class="n">available</span><span class="w"> </span><span class="n">starting</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="nc">API</span><span class="w"> </span><span class="n">version</span><span class="w"> </span><span class="mf">1.4</span><span class="o">.</span><span class="w">

             </span><span class="n">run_shell</span><span class="o">=</span><span class="n">bool</span><span class="w">
                   </span><span class="nc">Set</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="no">true</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">user</span><span class="w"> </span><span class="n">specified</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="o">-</span><span class="n">s</span><span class="w"> </span><span class="n">option</span><span class="p">,</span><span class="w"> </span><span class="n">indicating</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">user</span><span class="w"> </span><span class="n">wishes</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">run</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">shell</span><span class="o">.</span><span class="w">

             </span><span class="n">runas_group</span><span class="o">=</span><span class="n">string</span><span class="w">
                   </span><span class="nc">The</span><span class="w"> </span><span class="n">group</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">group</span><span class="o">-</span><span class="nc">ID</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">run</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">command</span><span class="w"> </span><span class="n">as</span><span class="p">,</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">specified</span><span class="w"> </span><span class="n">via</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="o">-</span><span class="n">g</span><span class="w"> </span><span class="n">option</span><span class="o">.</span><span class="w">

             </span><span class="n">runas_user</span><span class="o">=</span><span class="n">string</span><span class="w">
                   </span><span class="nc">The</span><span class="w"> </span><span class="n">user</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">user</span><span class="o">-</span><span class="nc">ID</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">run</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">command</span><span class="w"> </span><span class="n">as</span><span class="p">,</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">specified</span><span class="w"> </span><span class="n">via</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="o">-</span><span class="n">u</span><span class="w"> </span><span class="n">option</span><span class="o">.</span><span class="w">

             </span><span class="n">selinux_role</span><span class="o">=</span><span class="n">string</span><span class="w">
                   </span><span class="nc">SELinux</span><span class="w"> </span><span class="n">role</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="kn">use</span><span class="w"> </span><span class="ow">when</span><span class="w"> </span><span class="n">executing</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">command</span><span class="p">,</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">specified</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="o">-</span><span class="n">r</span><span class="w"> </span><span class="n">option</span><span class="o">.</span><span class="w">

             </span><span class="n">selinux_type</span><span class="o">=</span><span class="n">string</span><span class="w">
                   </span><span class="nc">SELinux</span><span class="w"> </span><span class="n">type</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="kn">use</span><span class="w"> </span><span class="ow">when</span><span class="w"> </span><span class="n">executing</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">command</span><span class="p">,</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">specified</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="o">-</span><span class="n">t</span><span class="w"> </span><span class="n">option</span><span class="o">.</span><span class="w">

             </span><span class="n">set_home</span><span class="o">=</span><span class="n">bool</span><span class="w">
                   </span><span class="nc">Set</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="no">true</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">user</span><span class="w"> </span><span class="n">specified</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="o">-</span><span class="nc">H</span><span class="w"> </span><span class="n">option</span><span class="o">.</span><span class="w">  </span><span class="nc">If</span><span class="w"> </span><span class="no">true</span><span class="p">,</span><span class="w"> </span><span class="n">set</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nc">HOME</span><span class="w"> </span><span class="n">environment</span><span class="w"> </span><span class="n">variable</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">target</span><span class="w"> </span><span class="n">user</span><span class="sc">&#39;s home directory.

             sudoedit=bool
                   Set to true when the -e option is specified or if invoked as sudoedit.  The plugin shall substitute an editor into argv in the check_policy() function or return
                   -2 with a usage error if the plugin does not support sudoedit.  For more information, see the check_policy() section.

             timeout=string
                   Command timeout specified by the user via the -T option.  Not all plugins support command timeouts and the ability of the user to set a timeout may be restricted
                   by policy.  The format of the timeout string is plugin-specific.

             update_ticket=bool
                   Set to false if the user specified the -N option, indicating that the user wishes to avoid updating any cached authentication credentials.  Only available start‐
                   ing with API version 1.20.

             Additional settings may be added in the future so the plugin should silently ignore settings that it does not recognize.

       user_info
             A vector of information about the user running the command in the form of “name=value” strings.  The vector is terminated by a NULL pointer.

             When parsing user_info, the plugin should split on the first equal sign (‘=’) since the name field will never include one itself but the value might.

             The following values may be set by sudo:

             cols=int
                   The number of columns the user&#39;</span><span class="n">s</span><span class="w"> </span><span class="n">terminal</span><span class="w"> </span><span class="n">supports</span><span class="o">.</span><span class="w">  </span><span class="nc">If</span><span class="w"> </span><span class="n">there</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">no</span><span class="w"> </span><span class="n">terminal</span><span class="w"> </span><span class="n">device</span><span class="w"> </span><span class="n">available</span><span class="p">,</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">default</span><span class="w"> </span><span class="n">value</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="mi">80</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">used</span><span class="o">.</span><span class="w">

             </span><span class="n">cwd</span><span class="o">=</span><span class="n">string</span><span class="w">
                   </span><span class="nc">The</span><span class="w"> </span><span class="n">user</span><span class="sc">&#39;s current working directory.

             egid=gid_t
                   The effective group-ID of the user invoking sudo.

             euid=uid_t
                   The effective user-ID of the user invoking sudo.

             gid=gid_t
                   The real group-ID of the user invoking sudo.

             groups=list
                   The user&#39;</span><span class="n">s</span><span class="w"> </span><span class="n">supplementary</span><span class="w"> </span><span class="n">group</span><span class="w"> </span><span class="n">list</span><span class="w"> </span><span class="n">formatted</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">string</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">comma</span><span class="o">-</span><span class="n">separated</span><span class="w"> </span><span class="n">group</span><span class="o">-</span><span class="nc">IDs</span><span class="o">.</span><span class="w">

             </span><span class="n">host</span><span class="o">=</span><span class="n">string</span><span class="w">
                   </span><span class="nc">The</span><span class="w"> </span><span class="n">local</span><span class="w"> </span><span class="n">machine</span><span class="sc">&#39;s hostname as returned by the gethostname(2) system call.

             lines=int
                   The number of lines the user&#39;</span><span class="n">s</span><span class="w"> </span><span class="n">terminal</span><span class="w"> </span><span class="n">supports</span><span class="o">.</span><span class="w">  </span><span class="nc">If</span><span class="w"> </span><span class="n">there</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">no</span><span class="w"> </span><span class="n">terminal</span><span class="w"> </span><span class="n">device</span><span class="w"> </span><span class="n">available</span><span class="p">,</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">default</span><span class="w"> </span><span class="n">value</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="mi">24</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">used</span><span class="o">.</span><span class="w">

             </span><span class="n">pgid</span><span class="o">=</span><span class="n">int</span><span class="w">
                   </span><span class="nc">The</span><span class="w"> </span><span class="nc">ID</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">process</span><span class="w"> </span><span class="n">group</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">running</span><span class="w"> </span><span class="n">sudo</span><span class="w"> </span><span class="n">process</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">member</span><span class="w"> </span><span class="n">of</span><span class="o">.</span><span class="w">  </span><span class="nc">Only</span><span class="w"> </span><span class="n">available</span><span class="w"> </span><span class="n">starting</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="nc">API</span><span class="w"> </span><span class="n">version</span><span class="w"> </span><span class="mf">1.2</span><span class="o">.</span><span class="w">

             </span><span class="n">pid</span><span class="o">=</span><span class="n">int</span><span class="w">
                   </span><span class="nc">The</span><span class="w"> </span><span class="n">process</span><span class="w"> </span><span class="nc">ID</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">running</span><span class="w"> </span><span class="n">sudo</span><span class="w"> </span><span class="n">process</span><span class="o">.</span><span class="w">  </span><span class="nc">Only</span><span class="w"> </span><span class="n">available</span><span class="w"> </span><span class="n">starting</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="nc">API</span><span class="w"> </span><span class="n">version</span><span class="w"> </span><span class="mf">1.2</span><span class="o">.</span><span class="w">

             </span><span class="n">ppid</span><span class="o">=</span><span class="n">int</span><span class="w">
                   </span><span class="nc">The</span><span class="w"> </span><span class="n">parent</span><span class="w"> </span><span class="n">process</span><span class="w"> </span><span class="nc">ID</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">running</span><span class="w"> </span><span class="n">sudo</span><span class="w"> </span><span class="n">process</span><span class="o">.</span><span class="w">  </span><span class="nc">Only</span><span class="w"> </span><span class="n">available</span><span class="w"> </span><span class="n">starting</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="nc">API</span><span class="w"> </span><span class="n">version</span><span class="w"> </span><span class="mf">1.2</span><span class="o">.</span><span class="w">

             </span><span class="n">rlimit_as</span><span class="o">=</span><span class="n">soft</span><span class="p">,</span><span class="n">hard</span><span class="w">
                   </span><span class="nc">The</span><span class="w"> </span><span class="n">maximum</span><span class="w"> </span><span class="n">size</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">which</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">process</span><span class="sc">&#39;s address space may grow (in bytes), if supported by the operating system.  The soft and hard limits are separated by a
                   comma.  A value of “infinity” indicates that there is no limit.  Only available starting with API version 1.16.

             rlimit_core=soft,hard
                   The largest size core dump file that may be created (in bytes).  The soft and hard limits are separated by a comma.  A value of “infinity” indicates that there is
                   no limit.  Only available starting with API version 1.16.

             rlimit_cpu=soft,hard
                   The maximum amount of CPU time that the process may use (in seconds).  The soft and hard limits are separated by a comma.  A value of “infinity” indicates that
                   there is no limit.  Only available starting with API version 1.16.

             rlimit_data=soft,hard
                   The maximum size of the data segment for the process (in bytes).  The soft and hard limits are separated by a comma.  A value of “infinity” indicates that there
                   is no limit.  Only available starting with API version 1.16.

             rlimit_fsize=soft,hard
                   The largest size file that the process may create (in bytes).  The soft and hard limits are separated by a comma.  A value of “infinity” indicates that there is
                   no limit.  Only available starting with API version 1.16.

             rlimit_locks=soft,hard
                   The maximum number of locks that the process may establish, if supported by the operating system.  The soft and hard limits are separated by a comma.  A value of
                   “infinity” indicates that there is no limit.  Only available starting with API version 1.16.

             rlimit_memlock=soft,hard
                   The maximum size that the process may lock in memory (in bytes), if supported by the operating system.  The soft and hard limits are separated by a comma.  A
                   value of “infinity” indicates that there is no limit.  Only available starting with API version 1.16.

             rlimit_nofile=soft,hard
                   The maximum number of files that the process may have open.  The soft and hard limits are separated by a comma.  A value of “infinity” indicates that there is no
                   limit.  Only available starting with API version 1.16.

             rlimit_nproc=soft,hard
                   The maximum number of processes that the user may run simultaneously.  The soft and hard limits are separated by a comma.  A value of “infinity” indicates that
                   there is no limit.  Only available starting with API version 1.16.

             rlimit_rss=soft,hard
                   The maximum size to which the process&#39;</span><span class="n">s</span><span class="w"> </span><span class="n">resident</span><span class="w"> </span><span class="n">set</span><span class="w"> </span><span class="n">size</span><span class="w"> </span><span class="n">may</span><span class="w"> </span><span class="n">grow</span><span class="w"> </span><span class="p" data-group-id="7867108359-61">(</span><span class="ow">in</span><span class="w"> </span><span class="n">bytes</span><span class="p" data-group-id="7867108359-61">)</span><span class="o">.</span><span class="w">  </span><span class="nc">The</span><span class="w"> </span><span class="n">soft</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">hard</span><span class="w"> </span><span class="n">limits</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">separated</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">comma</span><span class="o">.</span><span class="w">  </span><span class="nc">A</span><span class="w"> </span><span class="n">value</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="err">“</span><span class="n">infinity</span><span class="err">”</span><span class="w"> </span><span class="n">indi</span><span class="err">‐</span><span class="w">
                   </span><span class="n">cates</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">there</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">no</span><span class="w"> </span><span class="n">limit</span><span class="o">.</span><span class="w">  </span><span class="nc">Only</span><span class="w"> </span><span class="n">available</span><span class="w"> </span><span class="n">starting</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="nc">API</span><span class="w"> </span><span class="n">version</span><span class="w"> </span><span class="mf">1.16</span><span class="o">.</span><span class="w">

             </span><span class="n">rlimit_stack</span><span class="o">=</span><span class="n">soft</span><span class="p">,</span><span class="n">hard</span><span class="w">
                   </span><span class="nc">The</span><span class="w"> </span><span class="n">maximum</span><span class="w"> </span><span class="n">size</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">which</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">process</span><span class="sc">&#39;s stack may grow (in bytes).  The soft and hard limits are separated by a comma.  A value of “infinity” indicates that there
                   is no limit.  Only available starting with API version 1.16.

             sid=int
                   The session ID of the running sudo process or 0 if sudo is not part of a POSIX job control session.  Only available starting with API version 1.2.

             tcpgid=int
                   The ID of the foreground process group associated with the terminal device associated with the sudo process or 0 if there is no terminal present.  Only available
                   starting with API version 1.2.

             tty=string
                   The path to the user&#39;</span><span class="n">s</span><span class="w"> </span><span class="n">terminal</span><span class="w"> </span><span class="n">device</span><span class="o">.</span><span class="w">  </span><span class="nc">If</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">user</span><span class="w"> </span><span class="n">has</span><span class="w"> </span><span class="n">no</span><span class="w"> </span><span class="n">terminal</span><span class="w"> </span><span class="n">device</span><span class="w"> </span><span class="n">associated</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">session</span><span class="p">,</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">value</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">empty</span><span class="p">,</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="err">‘</span><span class="n">tty</span><span class="o">=</span><span class="err">’</span><span class="o">.</span><span class="w">

             </span><span class="n">uid</span><span class="o">=</span><span class="n">uid_t</span><span class="w">
                   </span><span class="nc">The</span><span class="w"> </span><span class="n">real</span><span class="w"> </span><span class="n">user</span><span class="o">-</span><span class="nc">ID</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">user</span><span class="w"> </span><span class="n">invoking</span><span class="w"> </span><span class="n">sudo</span><span class="o">.</span><span class="w">

             </span><span class="n">umask</span><span class="o">=</span><span class="n">octal</span><span class="w">
                   </span><span class="nc">The</span><span class="w"> </span><span class="n">invoking</span><span class="w"> </span><span class="n">user</span><span class="sc">&#39;s file creation mask.  Only available starting with API version 1.10.

             user=string
                   The name of the user invoking sudo.

       user_env
             The user&#39;</span><span class="n">s</span><span class="w"> </span><span class="n">environment</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">form</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="nc">NULL</span><span class="o">-</span><span class="n">terminated</span><span class="w"> </span><span class="n">vector</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="err">“</span><span class="n">name</span><span class="o">=</span><span class="n">value</span><span class="err">”</span><span class="w"> </span><span class="n">strings</span><span class="o">.</span><span class="w">

             </span><span class="nc">When</span><span class="w"> </span><span class="n">parsing</span><span class="w"> </span><span class="n">user_env</span><span class="p">,</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">plugin</span><span class="w"> </span><span class="n">should</span><span class="w"> </span><span class="n">split</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">first</span><span class="w"> </span><span class="n">equal</span><span class="w"> </span><span class="n">sign</span><span class="w"> </span><span class="p" data-group-id="7867108359-62">(</span><span class="err">‘</span><span class="o">=</span><span class="err">’</span><span class="p" data-group-id="7867108359-62">)</span><span class="w"> </span><span class="n">since</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="n">field</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">never</span><span class="w"> </span><span class="n">include</span><span class="w"> </span><span class="n">one</span><span class="w"> </span><span class="n">itself</span><span class="w"> </span><span class="n">but</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">value</span><span class="w"> </span><span class="n">might</span><span class="o">.</span><span class="w">

       </span><span class="n">plugin_options</span><span class="w">
             </span><span class="nc">Any</span><span class="w"> </span><span class="p" data-group-id="7867108359-63">(</span><span class="n">non</span><span class="o">-</span><span class="n">comment</span><span class="p" data-group-id="7867108359-63">)</span><span class="w"> </span><span class="n">strings</span><span class="w"> </span><span class="n">immediately</span><span class="w"> </span><span class="k">after</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">plugin</span><span class="w"> </span><span class="n">path</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">passed</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="n">arguments</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">plugin</span><span class="o">.</span><span class="w">  </span><span class="nc">These</span><span class="w"> </span><span class="n">arguments</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">split</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">white</span><span class="w"> </span><span class="n">space</span><span class="w"> </span><span class="n">boundary</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">passed</span><span class="w">
             </span><span class="n">to</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">plugin</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">form</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="nc">NULL</span><span class="o">-</span><span class="n">terminated</span><span class="w"> </span><span class="n">array</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">strings</span><span class="o">.</span><span class="w">  </span><span class="nc">If</span><span class="w"> </span><span class="n">no</span><span class="w"> </span><span class="n">arguments</span><span class="w"> </span><span class="n">were</span><span class="w"> </span><span class="n">specified</span><span class="p">,</span><span class="w"> </span><span class="n">plugin_options</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nc">NULL</span><span class="w"> </span><span class="n">pointer</span><span class="o">.</span><span class="w">

             </span><span class="nc">The</span><span class="w"> </span><span class="n">plugin_options</span><span class="w"> </span><span class="n">parameter</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">only</span><span class="w"> </span><span class="n">available</span><span class="w"> </span><span class="n">starting</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="nc">API</span><span class="w"> </span><span class="n">version</span><span class="w"> </span><span class="mf">1.2</span><span class="o">.</span><span class="w">  </span><span class="nc">A</span><span class="w"> </span><span class="n">plugin</span><span class="w"> </span><span class="n">must</span><span class="w"> </span><span class="n">check</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nc">API</span><span class="w"> </span><span class="n">version</span><span class="w"> </span><span class="n">specified</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">sudo</span><span class="w"> </span><span class="n">front</span><span class="o">-</span><span class="k">end</span><span class="w"> </span><span class="n">before</span><span class="w"> </span><span class="n">using</span><span class="w">
             </span><span class="n">plugin_options</span><span class="o">.</span><span class="w">  </span><span class="nc">Failure</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="k" data-group-id="7867108359-64">do</span><span class="w"> </span><span class="n">so</span><span class="w"> </span><span class="n">may</span><span class="w"> </span><span class="n">result</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">crash</span><span class="o">.</span><span class="w">

       </span><span class="n">errstr</span><span class="w">
             </span><span class="nc">If</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">open</span><span class="p" data-group-id="7867108359-65">(</span><span class="p" data-group-id="7867108359-65">)</span><span class="w"> </span><span class="n">function</span><span class="w"> </span><span class="n">returns</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">value</span><span class="w"> </span><span class="n">other</span><span class="w"> </span><span class="n">than</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">plugin</span><span class="w"> </span><span class="n">may</span><span class="w"> </span><span class="n">store</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">message</span><span class="w"> </span><span class="n">describing</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">failure</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">error</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">errstr</span><span class="o">.</span><span class="w">  </span><span class="nc">The</span><span class="w"> </span><span class="n">sudo</span><span class="w"> </span><span class="n">front</span><span class="o">-</span><span class="k" data-group-id="7867108359-64">end</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">then</span><span class="w"> </span><span class="n">pass</span><span class="w"> </span><span class="n">this</span><span class="w">
             </span><span class="n">value</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">any</span><span class="w"> </span><span class="n">registered</span><span class="w"> </span><span class="n">audit</span><span class="w"> </span><span class="n">plugins</span><span class="o">.</span><span class="w">  </span><span class="nc">The</span><span class="w"> </span><span class="n">string</span><span class="w"> </span><span class="n">stored</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">errstr</span><span class="w"> </span><span class="n">must</span><span class="w"> </span><span class="n">remain</span><span class="w"> </span><span class="n">valid</span><span class="w"> </span><span class="n">until</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">plugin</span><span class="sc">&#39;s close() function is called.

             The errstr parameter is only available starting with API version 1.15.  A plugin must check the API version specified by the sudo front-end before using errstr.  Fail‐
             ure to do so may result in a crash.

 close
       void (*close)(int exit_status, int error);

       The close() function is called when sudo is finished, shortly before it exits.  Starting with API version 1.15, close() is called regardless of whether or not a command was
       actually executed.  This makes it possible for plugins to perform cleanup even when a command was not run.  It is not possible to tell whether a command was run based solely
       on the arguments passed to the close() function.  To determine if a command was actually run, the plugin must keep track of whether or not the check_policy() function re‐
       turned successfully.

       The function arguments are as follows:

       exit_status
             The command&#39;</span><span class="n">s</span><span class="w"> </span><span class="n">exit</span><span class="w"> </span><span class="n">status</span><span class="p">,</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="n">returned</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">wait</span><span class="p" data-group-id="7867108359-66">(</span><span class="mi">2</span><span class="p" data-group-id="7867108359-66">)</span><span class="w"> </span><span class="n">system</span><span class="w"> </span><span class="n">call</span><span class="p">,</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">zero</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">no</span><span class="w"> </span><span class="n">command</span><span class="w"> </span><span class="n">was</span><span class="w"> </span><span class="n">run</span><span class="o">.</span><span class="w">  </span><span class="nc">The</span><span class="w"> </span><span class="n">value</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">exit_status</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">undefined</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">error</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">non</span><span class="o">-</span><span class="n">zero</span><span class="o">.</span><span class="w">

       </span><span class="n">error</span><span class="w">
             </span><span class="nc">If</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">command</span><span class="w"> </span><span class="n">could</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">executed</span><span class="p">,</span><span class="w"> </span><span class="n">this</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">set</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">value</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">errno</span><span class="w"> </span><span class="n">set</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">execve</span><span class="p" data-group-id="7867108359-67">(</span><span class="mi">2</span><span class="p" data-group-id="7867108359-67">)</span><span class="w"> </span><span class="n">system</span><span class="w"> </span><span class="n">call</span><span class="o">.</span><span class="w">  </span><span class="nc">The</span><span class="w"> </span><span class="n">plugin</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">responsible</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">displaying</span><span class="w"> </span><span class="n">error</span><span class="w"> </span><span class="n">information</span><span class="w">
             </span><span class="n">via</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">conversation</span><span class="p" data-group-id="7867108359-68">(</span><span class="p" data-group-id="7867108359-68">)</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">sudo_plugin_printf</span><span class="p" data-group-id="7867108359-69">(</span><span class="p" data-group-id="7867108359-69">)</span><span class="w"> </span><span class="n">function</span><span class="o">.</span><span class="w">  </span><span class="nc">If</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">command</span><span class="w"> </span><span class="n">was</span><span class="w"> </span><span class="n">successfully</span><span class="w"> </span><span class="n">executed</span><span class="p">,</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">value</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">error</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">zero</span><span class="o">.</span><span class="w">

       </span><span class="nc">If</span><span class="w"> </span><span class="n">no</span><span class="w"> </span><span class="n">close</span><span class="p" data-group-id="7867108359-70">(</span><span class="p" data-group-id="7867108359-70">)</span><span class="w"> </span><span class="n">function</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">defined</span><span class="p">,</span><span class="w"> </span><span class="n">no</span><span class="w"> </span><span class="nc">I</span><span class="o">/</span><span class="nc">O</span><span class="w"> </span><span class="n">logging</span><span class="w"> </span><span class="n">plugins</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">loaded</span><span class="p">,</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">neither</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">timeout</span><span class="w"> </span><span class="n">nor</span><span class="w"> </span><span class="n">use_pty</span><span class="w"> </span><span class="n">options</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">set</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">command_info</span><span class="w"> </span><span class="n">list</span><span class="p">,</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">sudo</span><span class="w"> </span><span class="n">front</span><span class="o">-</span><span class="k">end</span><span class="w"> </span><span class="n">may</span><span class="w"> </span><span class="n">ex</span><span class="err">‐</span><span class="w">
       </span><span class="n">ecute</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">command</span><span class="w"> </span><span class="n">directly</span><span class="w"> </span><span class="n">instead</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">running</span><span class="w"> </span><span class="n">it</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">child</span><span class="w"> </span><span class="n">process</span><span class="o">.</span><span class="w">

 </span><span class="n">show_version</span><span class="w">
       </span><span class="n">int</span><span class="w"> </span><span class="p" data-group-id="7867108359-71">(</span><span class="o">*</span><span class="n">show_version</span><span class="p" data-group-id="7867108359-71">)</span><span class="p" data-group-id="7867108359-72">(</span><span class="n">int</span><span class="w"> </span><span class="n">verbose</span><span class="p" data-group-id="7867108359-72">)</span><span class="p">;</span><span class="w">

       </span><span class="nc">The</span><span class="w"> </span><span class="n">show_version</span><span class="p" data-group-id="7867108359-73">(</span><span class="p" data-group-id="7867108359-73">)</span><span class="w"> </span><span class="n">function</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">called</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">sudo</span><span class="w"> </span><span class="ow">when</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">user</span><span class="w"> </span><span class="n">specifies</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="o">-</span><span class="nc">V</span><span class="w"> </span><span class="n">option</span><span class="o">.</span><span class="w">  </span><span class="nc">The</span><span class="w"> </span><span class="n">plugin</span><span class="w"> </span><span class="n">may</span><span class="w"> </span><span class="n">display</span><span class="w"> </span><span class="n">its</span><span class="w"> </span><span class="n">version</span><span class="w"> </span><span class="n">information</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">user</span><span class="w"> </span><span class="n">via</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">conversation</span><span class="p" data-group-id="7867108359-74">(</span><span class="p" data-group-id="7867108359-74">)</span><span class="w"> </span><span class="ow">or</span><span class="w">
       </span><span class="n">sudo_plugin_printf</span><span class="p" data-group-id="7867108359-75">(</span><span class="p" data-group-id="7867108359-75">)</span><span class="w"> </span><span class="n">function</span><span class="w"> </span><span class="n">using</span><span class="w"> </span><span class="nc">SUDO_CONV_INFO_MSG</span><span class="o">.</span><span class="w">  </span><span class="nc">If</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">user</span><span class="w"> </span><span class="n">requests</span><span class="w"> </span><span class="n">detailed</span><span class="w"> </span><span class="n">version</span><span class="w"> </span><span class="n">information</span><span class="p">,</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">verbose</span><span class="w"> </span><span class="n">flag</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">non</span><span class="o">-</span><span class="n">zero</span><span class="o">.</span><span class="w">

       </span><span class="nc">Returns</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">success</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">failure</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mi">1</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">general</span><span class="w"> </span><span class="n">error</span><span class="w"> </span><span class="n">occurred</span><span class="p">,</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="o">-</span><span class="mi">2</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">there</span><span class="w"> </span><span class="n">was</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">usage</span><span class="w"> </span><span class="n">error</span><span class="p">,</span><span class="w"> </span><span class="n">although</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">return</span><span class="w"> </span><span class="n">value</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">currently</span><span class="w"> </span><span class="n">ignored</span><span class="o">.</span><span class="w">

 </span><span class="n">check_policy</span><span class="w">
       </span><span class="n">int</span><span class="w"> </span><span class="p" data-group-id="7867108359-76">(</span><span class="o">*</span><span class="n">check_policy</span><span class="p" data-group-id="7867108359-76">)</span><span class="p" data-group-id="7867108359-77">(</span><span class="n">int</span><span class="w"> </span><span class="n">argc</span><span class="p">,</span><span class="w"> </span><span class="n">char</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">const</span><span class="w"> </span><span class="n">argv</span><span class="p" data-group-id="7867108359-78">[</span><span class="p" data-group-id="7867108359-78">]</span><span class="p">,</span><span class="w"> </span><span class="n">char</span><span class="w"> </span><span class="o">*</span><span class="n">env_add</span><span class="p" data-group-id="7867108359-79">[</span><span class="p" data-group-id="7867108359-79">]</span><span class="p">,</span><span class="w">
           </span><span class="n">char</span><span class="w"> </span><span class="o">*</span><span class="o">*</span><span class="n">command_info</span><span class="p" data-group-id="7867108359-80">[</span><span class="p" data-group-id="7867108359-80">]</span><span class="p">,</span><span class="w"> </span><span class="n">char</span><span class="w"> </span><span class="o">*</span><span class="o">*</span><span class="n">argv_out</span><span class="p" data-group-id="7867108359-81">[</span><span class="p" data-group-id="7867108359-81">]</span><span class="p">,</span><span class="w"> </span><span class="n">char</span><span class="w"> </span><span class="o">*</span><span class="o">*</span><span class="n">user_env_out</span><span class="p" data-group-id="7867108359-82">[</span><span class="p" data-group-id="7867108359-82">]</span><span class="p">,</span><span class="w">
           </span><span class="n">const</span><span class="w"> </span><span class="n">char</span><span class="w"> </span><span class="o">*</span><span class="o">*</span><span class="n">errstr</span><span class="p" data-group-id="7867108359-77">)</span><span class="p">;</span><span class="w">

       </span><span class="nc">The</span><span class="w"> </span><span class="n">check_policy</span><span class="p" data-group-id="7867108359-83">(</span><span class="p" data-group-id="7867108359-83">)</span><span class="w"> </span><span class="n">function</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">called</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">sudo</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">determine</span><span class="w"> </span><span class="n">whether</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">user</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">allowed</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">run</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">specified</span><span class="w"> </span><span class="n">commands</span><span class="o">.</span><span class="w">

       </span><span class="nc">If</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">sudoedit</span><span class="w"> </span><span class="n">option</span><span class="w"> </span><span class="n">was</span><span class="w"> </span><span class="n">enabled</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">settings</span><span class="w"> </span><span class="n">array</span><span class="w"> </span><span class="n">passed</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">open</span><span class="p" data-group-id="7867108359-84">(</span><span class="p" data-group-id="7867108359-84">)</span><span class="w"> </span><span class="n">function</span><span class="p">,</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">user</span><span class="w"> </span><span class="n">has</span><span class="w"> </span><span class="n">requested</span><span class="w"> </span><span class="n">sudoedit</span><span class="w"> </span><span class="n">mode</span><span class="o">.</span><span class="w">  </span><span class="n">sudoedit</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">mechanism</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">editing</span><span class="w"> </span><span class="n">one</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">more</span><span class="w">
       </span><span class="n">files</span><span class="w"> </span><span class="n">where</span><span class="w"> </span><span class="n">an</span><span class="w"> </span><span class="n">editor</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">run</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">user</span><span class="sc">&#39;s credentials instead of with elevated privileges.  sudo achieves this by creating user-writable temporary copies of the files to
       be edited and then overwriting the originals with the temporary copies after editing is complete.  If the plugin supports sudoedit, it must set sudoedit=true in the
       command_info list.  The plugin is responsible for choosing the editor to be used, potentially from a variable in the user&#39;</span><span class="n">s</span><span class="w"> </span><span class="n">environment</span><span class="p">,</span><span class="w"> </span><span class="n">such</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="nc">EDITOR</span><span class="p">,</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">should</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">stored</span><span class="w">
       </span><span class="ow">in</span><span class="w"> </span><span class="n">argv_out</span><span class="w"> </span><span class="p" data-group-id="7867108359-85">(</span><span class="n">environment</span><span class="w"> </span><span class="n">variables</span><span class="w"> </span><span class="n">may</span><span class="w"> </span><span class="n">include</span><span class="w"> </span><span class="n">command</span><span class="w"> </span><span class="n">line</span><span class="w"> </span><span class="n">options</span><span class="p" data-group-id="7867108359-85">)</span><span class="o">.</span><span class="w">  </span><span class="nc">The</span><span class="w"> </span><span class="n">files</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">edited</span><span class="w"> </span><span class="n">should</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">copied</span><span class="w"> </span><span class="n">from</span><span class="w"> </span><span class="n">argv</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">argv_out</span><span class="p">,</span><span class="w"> </span><span class="n">separated</span><span class="w"> </span><span class="n">from</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">editor</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">its</span><span class="w"> </span><span class="n">argu</span><span class="err">‐</span><span class="w">
       </span><span class="n">ments</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="err">‘</span><span class="o">--</span><span class="err">’</span><span class="w"> </span><span class="n">element</span><span class="o">.</span><span class="w">  </span><span class="nc">The</span><span class="w"> </span><span class="err">‘</span><span class="o">--</span><span class="err">’</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">removed</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">sudo</span><span class="w"> </span><span class="n">before</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">editor</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">executed</span><span class="o">.</span><span class="w">  </span><span class="nc">The</span><span class="w"> </span><span class="n">plugin</span><span class="w"> </span><span class="n">may</span><span class="w"> </span><span class="n">also</span><span class="w"> </span><span class="n">set</span><span class="w"> </span><span class="n">sudoedit_nfiles</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">number</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">files</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">edited</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">the</span><span class="w">
       </span><span class="n">command_info</span><span class="w"> </span><span class="n">list</span><span class="p">;</span><span class="w"> </span><span class="n">this</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">only</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">used</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">sudo</span><span class="w"> </span><span class="n">front</span><span class="o">-</span><span class="k">end</span><span class="w"> </span><span class="n">starting</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="nc">API</span><span class="w"> </span><span class="n">version</span><span class="w"> </span><span class="mf">1.21</span><span class="o">.</span><span class="w">

       </span><span class="nc">The</span><span class="w"> </span><span class="n">check_policy</span><span class="p" data-group-id="7867108359-86">(</span><span class="p" data-group-id="7867108359-86">)</span><span class="w"> </span><span class="n">function</span><span class="w"> </span><span class="n">returns</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">command</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">allowed</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">allowed</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mi">1</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">general</span><span class="w"> </span><span class="n">error</span><span class="p">,</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="o">-</span><span class="mi">2</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">usage</span><span class="w"> </span><span class="n">error</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">sudoedit</span><span class="w"> </span><span class="n">was</span><span class="w"> </span><span class="n">specified</span><span class="w"> </span><span class="n">but</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">unsup</span><span class="err">‐</span><span class="w">
       </span><span class="n">ported</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">plugin</span><span class="o">.</span><span class="w">  </span><span class="nc">In</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">latter</span><span class="w"> </span><span class="k">case</span><span class="p">,</span><span class="w"> </span><span class="n">sudo</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">print</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">usage</span><span class="w"> </span><span class="n">message</span><span class="w"> </span><span class="n">before</span><span class="w"> </span><span class="n">it</span><span class="w"> </span><span class="n">exits</span><span class="o">.</span><span class="w">  </span><span class="nc">If</span><span class="w"> </span><span class="n">an</span><span class="w"> </span><span class="n">error</span><span class="w"> </span><span class="n">occurs</span><span class="p">,</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">plugin</span><span class="w"> </span><span class="n">may</span><span class="w"> </span><span class="n">optionally</span><span class="w"> </span><span class="n">call</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">conversation</span><span class="p" data-group-id="7867108359-87">(</span><span class="p" data-group-id="7867108359-87">)</span><span class="w"> </span><span class="ow">or</span><span class="w">
       </span><span class="n">sudo_plugin_printf</span><span class="p" data-group-id="7867108359-88">(</span><span class="p" data-group-id="7867108359-88">)</span><span class="w"> </span><span class="n">function</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="nc">SUDO_CONF_ERROR_MSG</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">present</span><span class="w"> </span><span class="n">additional</span><span class="w"> </span><span class="n">error</span><span class="w"> </span><span class="n">information</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">user</span><span class="o">.</span><span class="w">

       </span><span class="nc">The</span><span class="w"> </span><span class="n">function</span><span class="w"> </span><span class="n">arguments</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="ss">follows</span><span class="p">:</span><span class="w">

       </span><span class="n">argc</span><span class="w">  </span><span class="nc">The</span><span class="w"> </span><span class="n">number</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">elements</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">argv</span><span class="p">,</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">counting</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">final</span><span class="w"> </span><span class="nc">NULL</span><span class="w"> </span><span class="n">pointer</span><span class="o">.</span><span class="w">

       </span><span class="n">argv</span><span class="w">  </span><span class="nc">The</span><span class="w"> </span><span class="n">argument</span><span class="w"> </span><span class="n">vector</span><span class="w"> </span><span class="n">describing</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">command</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">user</span><span class="w"> </span><span class="n">wishes</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">run</span><span class="p">,</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">same</span><span class="w"> </span><span class="n">form</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="n">what</span><span class="w"> </span><span class="n">would</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">passed</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">execve</span><span class="p" data-group-id="7867108359-89">(</span><span class="mi">2</span><span class="p" data-group-id="7867108359-89">)</span><span class="w"> </span><span class="n">system</span><span class="w"> </span><span class="n">call</span><span class="o">.</span><span class="w">  </span><span class="nc">The</span><span class="w"> </span><span class="n">vector</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">terminated</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">a</span><span class="w">
             </span><span class="nc">NULL</span><span class="w"> </span><span class="n">pointer</span><span class="o">.</span><span class="w">

       </span><span class="n">env_add</span><span class="w">
             </span><span class="nc">Additional</span><span class="w"> </span><span class="n">environment</span><span class="w"> </span><span class="n">variables</span><span class="w"> </span><span class="n">specified</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">user</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">command</span><span class="w"> </span><span class="n">line</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">form</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="nc">NULL</span><span class="o">-</span><span class="n">terminated</span><span class="w"> </span><span class="n">vector</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="err">“</span><span class="n">name</span><span class="o">=</span><span class="n">value</span><span class="err">”</span><span class="w"> </span><span class="n">strings</span><span class="o">.</span><span class="w">  </span><span class="nc">The</span><span class="w"> </span><span class="n">plugin</span><span class="w"> </span><span class="n">may</span><span class="w"> </span><span class="n">reject</span><span class="w"> </span><span class="n">the</span><span class="w">
             </span><span class="n">command</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">one</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">more</span><span class="w"> </span><span class="n">variables</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">allowed</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">set</span><span class="p">,</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">it</span><span class="w"> </span><span class="n">may</span><span class="w"> </span><span class="n">silently</span><span class="w"> </span><span class="n">ignore</span><span class="w"> </span><span class="n">such</span><span class="w"> </span><span class="n">variables</span><span class="o">.</span><span class="w">

             </span><span class="nc">When</span><span class="w"> </span><span class="n">parsing</span><span class="w"> </span><span class="n">env_add</span><span class="p">,</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">plugin</span><span class="w"> </span><span class="n">should</span><span class="w"> </span><span class="n">split</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">first</span><span class="w"> </span><span class="n">equal</span><span class="w"> </span><span class="n">sign</span><span class="w"> </span><span class="p" data-group-id="7867108359-90">(</span><span class="err">‘</span><span class="o">=</span><span class="err">’</span><span class="p" data-group-id="7867108359-90">)</span><span class="w"> </span><span class="n">since</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="n">field</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">never</span><span class="w"> </span><span class="n">include</span><span class="w"> </span><span class="n">one</span><span class="w"> </span><span class="n">itself</span><span class="w"> </span><span class="n">but</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">value</span><span class="w"> </span><span class="n">might</span><span class="o">.</span><span class="w">

       </span><span class="n">command_info</span><span class="w">
             </span><span class="nc">Information</span><span class="w"> </span><span class="n">about</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">command</span><span class="w"> </span><span class="n">being</span><span class="w"> </span><span class="n">run</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">form</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="err">“</span><span class="n">name</span><span class="o">=</span><span class="n">value</span><span class="err">”</span><span class="w"> </span><span class="n">strings</span><span class="o">.</span><span class="w">  </span><span class="nc">These</span><span class="w"> </span><span class="n">values</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">used</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">sudo</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">set</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">execution</span><span class="w"> </span><span class="n">environment</span><span class="w"> </span><span class="ow">when</span><span class="w"> </span><span class="n">running</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">command</span><span class="o">.</span><span class="w">
             </span><span class="nc">The</span><span class="w"> </span><span class="n">plugin</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">responsible</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">creating</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">populating</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">vector</span><span class="p">,</span><span class="w"> </span><span class="n">which</span><span class="w"> </span><span class="n">must</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">terminated</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="nc">NULL</span><span class="w"> </span><span class="n">pointer</span><span class="o">.</span><span class="w">  </span><span class="nc">The</span><span class="w"> </span><span class="n">following</span><span class="w"> </span><span class="n">values</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">recognized</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="ss">sudo</span><span class="p">:</span><span class="w">

             </span><span class="n">apparmor_profile</span><span class="o">=</span><span class="n">string</span><span class="w">
                   </span><span class="nc">AppArmor</span><span class="w"> </span><span class="n">profile</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">transition</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="ow">when</span><span class="w"> </span><span class="n">executing</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">command</span><span class="o">.</span><span class="w">  </span><span class="nc">Only</span><span class="w"> </span><span class="n">available</span><span class="w"> </span><span class="n">starting</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="nc">API</span><span class="w"> </span><span class="n">version</span><span class="w"> </span><span class="mf">1.19</span><span class="o">.</span><span class="w">

             </span><span class="n">chroot</span><span class="o">=</span><span class="n">string</span><span class="w">
                   </span><span class="nc">The</span><span class="w"> </span><span class="n">root</span><span class="w"> </span><span class="n">directory</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="kn">use</span><span class="w"> </span><span class="ow">when</span><span class="w"> </span><span class="n">running</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">command</span><span class="o">.</span><span class="w">

             </span><span class="n">closefrom</span><span class="o">=</span><span class="n">number</span><span class="w">
                   </span><span class="nc">If</span><span class="w"> </span><span class="n">specified</span><span class="p">,</span><span class="w"> </span><span class="n">sudo</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">close</span><span class="w"> </span><span class="n">all</span><span class="w"> </span><span class="n">files</span><span class="w"> </span><span class="n">descriptors</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">value</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">number</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">higher</span><span class="o">.</span><span class="w">

             </span><span class="n">command</span><span class="o">=</span><span class="n">string</span><span class="w">
                   </span><span class="nc">Fully</span><span class="w"> </span><span class="n">qualified</span><span class="w"> </span><span class="n">path</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">command</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">executed</span><span class="o">.</span><span class="w">

             </span><span class="n">cwd</span><span class="o">=</span><span class="n">string</span><span class="w">
                   </span><span class="nc">The</span><span class="w"> </span><span class="n">current</span><span class="w"> </span><span class="n">working</span><span class="w"> </span><span class="n">directory</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">change</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="ow">when</span><span class="w"> </span><span class="n">executing</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">command</span><span class="o">.</span><span class="w">  </span><span class="nc">If</span><span class="w"> </span><span class="n">sudo</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">unable</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">change</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">new</span><span class="w"> </span><span class="n">working</span><span class="w"> </span><span class="n">directory</span><span class="p">,</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">command</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">run</span><span class="w"> </span><span class="n">un</span><span class="err">‐</span><span class="w">
                   </span><span class="n">less</span><span class="w"> </span><span class="n">cwd_optional</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">also</span><span class="w"> </span><span class="n">set</span><span class="w"> </span><span class="p" data-group-id="7867108359-91">(</span><span class="n">see</span><span class="w"> </span><span class="n">below</span><span class="p" data-group-id="7867108359-91">)</span><span class="o">.</span><span class="w">

             </span><span class="n">cwd_optional</span><span class="o">=</span><span class="n">bool</span><span class="w">
                   </span><span class="nc">If</span><span class="w"> </span><span class="n">set</span><span class="p">,</span><span class="w"> </span><span class="n">sudo</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">treat</span><span class="w"> </span><span class="n">an</span><span class="w"> </span><span class="n">inability</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">change</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">new</span><span class="w"> </span><span class="n">working</span><span class="w"> </span><span class="n">directory</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">non</span><span class="o">-</span><span class="n">fatal</span><span class="w"> </span><span class="n">error</span><span class="o">.</span><span class="w">  </span><span class="nc">This</span><span class="w"> </span><span class="n">setting</span><span class="w"> </span><span class="n">has</span><span class="w"> </span><span class="n">no</span><span class="w"> </span><span class="n">effect</span><span class="w"> </span><span class="k">unless</span><span class="w"> </span><span class="n">cwd</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">also</span><span class="w"> </span><span class="n">set</span><span class="o">.</span><span class="w">

             </span><span class="n">exec_background</span><span class="o">=</span><span class="n">bool</span><span class="w">
                   </span><span class="nc">By</span><span class="w"> </span><span class="n">default</span><span class="p">,</span><span class="w"> </span><span class="n">sudo</span><span class="w"> </span><span class="n">runs</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">command</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">foreground</span><span class="w"> </span><span class="n">process</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="n">long</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="n">sudo</span><span class="w"> </span><span class="n">itself</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">running</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">foreground</span><span class="o">.</span><span class="w">  </span><span class="nc">When</span><span class="w"> </span><span class="n">exec_background</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">enabled</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">command</span><span class="w"> </span><span class="n">is</span><span class="w">
                   </span><span class="n">being</span><span class="w"> </span><span class="n">run</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">pseudo</span><span class="o">-</span><span class="n">terminal</span><span class="w"> </span><span class="p" data-group-id="7867108359-92">(</span><span class="n">due</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="nc">I</span><span class="o">/</span><span class="nc">O</span><span class="w"> </span><span class="n">logging</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">use_pty</span><span class="w"> </span><span class="n">setting</span><span class="p" data-group-id="7867108359-92">)</span><span class="p">,</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">command</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">run</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">background</span><span class="w"> </span><span class="n">process</span><span class="o">.</span><span class="w">  </span><span class="nc">Attempts</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">read</span><span class="w"> </span><span class="n">from</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">control</span><span class="err">‐</span><span class="w">
                   </span><span class="n">ling</span><span class="w"> </span><span class="n">terminal</span><span class="w"> </span><span class="p" data-group-id="7867108359-93">(</span><span class="ow">or</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">change</span><span class="w"> </span><span class="n">terminal</span><span class="w"> </span><span class="n">settings</span><span class="p" data-group-id="7867108359-93">)</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">result</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">command</span><span class="w"> </span><span class="n">being</span><span class="w"> </span><span class="n">suspended</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nc">SIGTTIN</span><span class="w"> </span><span class="n">signal</span><span class="w"> </span><span class="p" data-group-id="7867108359-94">(</span><span class="ow">or</span><span class="w"> </span><span class="nc">SIGTTOU</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="k">case</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">terminal</span><span class="w"> </span><span class="n">settings</span><span class="p" data-group-id="7867108359-94">)</span><span class="o">.</span><span class="w">
                   </span><span class="nc">If</span><span class="w"> </span><span class="n">this</span><span class="w"> </span><span class="n">happens</span><span class="w"> </span><span class="ow">when</span><span class="w"> </span><span class="n">sudo</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">foreground</span><span class="w"> </span><span class="n">process</span><span class="p">,</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">command</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">granted</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">controlling</span><span class="w"> </span><span class="n">terminal</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">resumed</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">foreground</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">no</span><span class="w"> </span><span class="n">user</span><span class="w"> </span><span class="n">intervention</span><span class="w">
                   </span><span class="n">required</span><span class="o">.</span><span class="w">  </span><span class="nc">The</span><span class="w"> </span><span class="n">advantage</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">initially</span><span class="w"> </span><span class="n">running</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">command</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">background</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">sudo</span><span class="w"> </span><span class="n">need</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">read</span><span class="w"> </span><span class="n">from</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">terminal</span><span class="w"> </span><span class="k">unless</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">command</span><span class="w"> </span><span class="n">explicitly</span><span class="w"> </span><span class="n">requests</span><span class="w">
                   </span><span class="n">it</span><span class="o">.</span><span class="w">  </span><span class="nc">Otherwise</span><span class="p">,</span><span class="w"> </span><span class="n">any</span><span class="w"> </span><span class="n">terminal</span><span class="w"> </span><span class="n">input</span><span class="w"> </span><span class="n">must</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">passed</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">command</span><span class="p">,</span><span class="w"> </span><span class="n">whether</span><span class="w"> </span><span class="n">it</span><span class="w"> </span><span class="n">has</span><span class="w"> </span><span class="n">required</span><span class="w"> </span><span class="n">it</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="p" data-group-id="7867108359-95">(</span><span class="n">the</span><span class="w"> </span><span class="n">kernel</span><span class="w"> </span><span class="n">buffers</span><span class="w"> </span><span class="n">terminals</span><span class="w"> </span><span class="n">so</span><span class="w"> </span><span class="n">it</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">possible</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">tell</span><span class="w">
                   </span><span class="n">whether</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">command</span><span class="w"> </span><span class="n">really</span><span class="w"> </span><span class="n">wants</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">input</span><span class="p" data-group-id="7867108359-95">)</span><span class="o">.</span><span class="w">  </span><span class="nc">This</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">different</span><span class="w"> </span><span class="n">from</span><span class="w"> </span><span class="n">historic</span><span class="w"> </span><span class="n">sudo</span><span class="w"> </span><span class="n">behavior</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="ow">when</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">command</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">being</span><span class="w"> </span><span class="n">run</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">pseudo</span><span class="o">-</span><span class="n">terminal</span><span class="o">.</span><span class="w">

                   </span><span class="nc">For</span><span class="w"> </span><span class="n">this</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">work</span><span class="w"> </span><span class="n">seamlessly</span><span class="p">,</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">operating</span><span class="w"> </span><span class="n">system</span><span class="w"> </span><span class="n">must</span><span class="w"> </span><span class="n">support</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">automatic</span><span class="w"> </span><span class="n">restarting</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">system</span><span class="w"> </span><span class="n">calls</span><span class="o">.</span><span class="w">  </span><span class="nc">Unfortunately</span><span class="p">,</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">all</span><span class="w"> </span><span class="n">operating</span><span class="w"> </span><span class="n">systems</span><span class="w"> </span><span class="k" data-group-id="7867108359-96">do</span><span class="w"> </span><span class="n">this</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">de</span><span class="err">‐</span><span class="w">
                   </span><span class="n">fault</span><span class="p">,</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">even</span><span class="w"> </span><span class="n">those</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="k" data-group-id="7867108359-97">do</span><span class="w"> </span><span class="n">may</span><span class="w"> </span><span class="n">have</span><span class="w"> </span><span class="n">bugs</span><span class="o">.</span><span class="w">  </span><span class="nc">For</span><span class="w"> </span><span class="n">example</span><span class="p">,</span><span class="w"> </span><span class="n">macOS</span><span class="w"> </span><span class="n">fails</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">restart</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">tcgetattr</span><span class="p" data-group-id="7867108359-98">(</span><span class="p" data-group-id="7867108359-98">)</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">tcsetattr</span><span class="p" data-group-id="7867108359-99">(</span><span class="p" data-group-id="7867108359-99">)</span><span class="w"> </span><span class="n">system</span><span class="w"> </span><span class="n">calls</span><span class="w"> </span><span class="p" data-group-id="7867108359-100">(</span><span class="n">this</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">bug</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">macOS</span><span class="p" data-group-id="7867108359-100">)</span><span class="o">.</span><span class="w">  </span><span class="nc">Further</span><span class="err">‐</span><span class="w">
                   </span><span class="n">more</span><span class="p">,</span><span class="w"> </span><span class="n">because</span><span class="w"> </span><span class="n">this</span><span class="w"> </span><span class="n">behavior</span><span class="w"> </span><span class="n">depends</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">command</span><span class="w"> </span><span class="n">stopping</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nc">SIGTTIN</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="nc">SIGTTOU</span><span class="w"> </span><span class="n">signals</span><span class="p">,</span><span class="w"> </span><span class="n">programs</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="k" data-group-id="7867108359-97">catch</span><span class="w"> </span><span class="n">these</span><span class="w"> </span><span class="n">signals</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">suspend</span><span class="w"> </span><span class="n">themselves</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">a</span><span class="w">
                   </span><span class="n">different</span><span class="w"> </span><span class="n">signal</span><span class="w"> </span><span class="p" data-group-id="7867108359-101">(</span><span class="n">usually</span><span class="w"> </span><span class="nc">SIGTOP</span><span class="p" data-group-id="7867108359-101">)</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">automatically</span><span class="w"> </span><span class="n">foregrounded</span><span class="o">.</span><span class="w">  </span><span class="nc">Some</span><span class="w"> </span><span class="n">versions</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">linux</span><span class="w"> </span><span class="n">su</span><span class="p" data-group-id="7867108359-102">(</span><span class="mi">1</span><span class="p" data-group-id="7867108359-102">)</span><span class="w"> </span><span class="n">command</span><span class="w"> </span><span class="n">behave</span><span class="w"> </span><span class="n">this</span><span class="w"> </span><span class="n">way</span><span class="o">.</span><span class="w">  </span><span class="nc">Because</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">this</span><span class="p">,</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">plugin</span><span class="w">
                   </span><span class="n">should</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">set</span><span class="w"> </span><span class="n">exec_background</span><span class="w"> </span><span class="k">unless</span><span class="w"> </span><span class="n">it</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">explicitly</span><span class="w"> </span><span class="n">enabled</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">administrator</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">there</span><span class="w"> </span><span class="n">should</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">way</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">enabled</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">disable</span><span class="w"> </span><span class="n">it</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">per</span><span class="o">-</span><span class="n">command</span><span class="w"> </span><span class="n">basis</span><span class="o">.</span><span class="w">

                   </span><span class="nc">This</span><span class="w"> </span><span class="n">setting</span><span class="w"> </span><span class="n">has</span><span class="w"> </span><span class="n">no</span><span class="w"> </span><span class="n">effect</span><span class="w"> </span><span class="k">unless</span><span class="w"> </span><span class="nc">I</span><span class="o">/</span><span class="nc">O</span><span class="w"> </span><span class="n">logging</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">enabled</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">use_pty</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">enabled</span><span class="o">.</span><span class="w">

             </span><span class="n">execfd</span><span class="o">=</span><span class="n">number</span><span class="w">
                   </span><span class="nc">If</span><span class="w"> </span><span class="n">specified</span><span class="p">,</span><span class="w"> </span><span class="n">sudo</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="kn">use</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">fexecve</span><span class="p" data-group-id="7867108359-103">(</span><span class="mi">2</span><span class="p" data-group-id="7867108359-103">)</span><span class="w"> </span><span class="n">system</span><span class="w"> </span><span class="n">call</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">execute</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">command</span><span class="w"> </span><span class="n">instead</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">execve</span><span class="p" data-group-id="7867108359-104">(</span><span class="mi">2</span><span class="p" data-group-id="7867108359-104">)</span><span class="o">.</span><span class="w">  </span><span class="nc">The</span><span class="w"> </span><span class="n">specified</span><span class="w"> </span><span class="n">number</span><span class="w"> </span><span class="n">must</span><span class="w"> </span><span class="n">refer</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">an</span><span class="w"> </span><span class="n">open</span><span class="w"> </span><span class="n">file</span><span class="w"> </span><span class="n">descriptor</span><span class="o">.</span><span class="w">

             </span><span class="n">intercept</span><span class="o">=</span><span class="n">bool</span><span class="w">
                   </span><span class="nc">If</span><span class="w"> </span><span class="n">set</span><span class="p">,</span><span class="w"> </span><span class="n">sudo</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">intercept</span><span class="w"> </span><span class="n">attempts</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">execute</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">subsequent</span><span class="w"> </span><span class="n">command</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">perform</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">policy</span><span class="w"> </span><span class="n">check</span><span class="w"> </span><span class="n">via</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">policy</span><span class="w"> </span><span class="n">plugin</span><span class="sc">&#39;s check_policy() function to determine
                   whether or not the command is permitted.  This can be used to prevent shell escapes on supported platforms but it has a number of limitations.  See Preventing
                   shell escapes in sudoers(5) for details.  Only available starting with API version 1.18.

             intercept_verify=bool
                   If set, sudo will attempt to verify that a command run in intercept mode has the expected path name, command line arguments and environment.  This setting has no
                   effect unless use_ptrace is also enabled.  Only available starting with API version 1.20.

             iolog_compress=bool
                   Set to true if the I/O logging plugins, if any, should compress the log data.  This is a hint to the I/O logging plugin which may choose to ignore it.

             iolog_group=string
                   The group that will own newly created I/O log files and directories.  This is a hint to the I/O logging plugin which may choose to ignore it.

             iolog_mode=octal
                   The file permission mode to use when creating I/O log files and directories.  This is a hint to the I/O logging plugin which may choose to ignore it.

             iolog_user=string
                   The user that will own newly created I/O log files and directories.  This is a hint to the I/O logging plugin which may choose to ignore it.

             iolog_path=string
                   Fully qualified path to the file or directory in which I/O log is to be stored.  This is a hint to the I/O logging plugin which may choose to ignore it.  If no
                   I/O logging plugin is loaded, this setting has no effect.

             iolog_stdin=bool
                   Set to true if the I/O logging plugins, if any, should log the standard input if it is not connected to a terminal device.  This is a hint to the I/O logging
                   plugin which may choose to ignore it.

             iolog_stdout=bool
                   Set to true if the I/O logging plugins, if any, should log the standard output if it is not connected to a terminal device.  This is a hint to the I/O logging
                   plugin which may choose to ignore it.

             iolog_stderr=bool
                   Set to true if the I/O logging plugins, if any, should log the standard error if it is not connected to a terminal device.  This is a hint to the I/O logging
                   plugin which may choose to ignore it.

             iolog_ttyin=bool
                   Set to true if the I/O logging plugins, if any, should log all terminal input.  This only includes input typed by the user and not from a pipe or redirected from
                   a file.  This is a hint to the I/O logging plugin which may choose to ignore it.

             iolog_ttyout=bool
                   Set to true if the I/O logging plugins, if any, should log all terminal output.  This only includes output to the screen, not output to a pipe or file.  This is a
                   hint to the I/O logging plugin which may choose to ignore it.

             login_class=string
                   BSD login class to use when setting resource limits and nice value (optional).  This option is only set on systems that support login classes.

             nice=int
                   Nice value (priority) to use when executing the command.  The nice value, if specified, overrides the priority associated with the login_class on BSD systems.

             log_subcmds=bool
                   If set, sudo will call the audit plugin&#39;</span><span class="n">s</span><span class="w"> </span><span class="n">accept</span><span class="p" data-group-id="7867108359-105">(</span><span class="p" data-group-id="7867108359-105">)</span><span class="w"> </span><span class="n">function</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">log</span><span class="w"> </span><span class="ow">when</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">command</span><span class="w"> </span><span class="n">runs</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">subsequent</span><span class="w"> </span><span class="n">command</span><span class="p">,</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">supported</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">system</span><span class="o">.</span><span class="w">  </span><span class="nc">If</span><span class="w"> </span><span class="n">intercept</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">also</span><span class="w">
                   </span><span class="n">specified</span><span class="p">,</span><span class="w"> </span><span class="n">log_subcmds</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">ignored</span><span class="o">.</span><span class="w">  </span><span class="nc">See</span><span class="w"> </span><span class="nc">Preventing</span><span class="w"> </span><span class="n">shell</span><span class="w"> </span><span class="n">escapes</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">sudoers</span><span class="p" data-group-id="7867108359-106">(</span><span class="mi">5</span><span class="p" data-group-id="7867108359-106">)</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">more</span><span class="w"> </span><span class="n">information</span><span class="o">.</span><span class="w">  </span><span class="nc">Only</span><span class="w"> </span><span class="n">available</span><span class="w"> </span><span class="n">starting</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="nc">API</span><span class="w"> </span><span class="n">version</span><span class="w"> </span><span class="mf">1.18</span><span class="o">.</span><span class="w">

             </span><span class="n">noexec</span><span class="o">=</span><span class="n">bool</span><span class="w">
                   </span><span class="nc">If</span><span class="w"> </span><span class="n">set</span><span class="p">,</span><span class="w"> </span><span class="n">prevent</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">command</span><span class="w"> </span><span class="n">from</span><span class="w"> </span><span class="n">executing</span><span class="w"> </span><span class="n">other</span><span class="w"> </span><span class="n">programs</span><span class="o">.</span><span class="w">

             </span><span class="n">preserve_fds</span><span class="o">=</span><span class="n">list</span><span class="w">
                   </span><span class="nc">A</span><span class="w"> </span><span class="n">comma</span><span class="o">-</span><span class="n">separated</span><span class="w"> </span><span class="n">list</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">file</span><span class="w"> </span><span class="n">descriptors</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">should</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">preserved</span><span class="p">,</span><span class="w"> </span><span class="n">regardless</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">value</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">closefrom</span><span class="w"> </span><span class="n">setting</span><span class="o">.</span><span class="w">  </span><span class="nc">Only</span><span class="w"> </span><span class="n">available</span><span class="w"> </span><span class="n">starting</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="nc">API</span><span class="w"> </span><span class="n">version</span><span class="w">
                   </span><span class="mf">1.5</span><span class="o">.</span><span class="w">

             </span><span class="n">preserve_groups</span><span class="o">=</span><span class="n">bool</span><span class="w">
                   </span><span class="nc">If</span><span class="w"> </span><span class="n">set</span><span class="p">,</span><span class="w"> </span><span class="n">sudo</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">preserve</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">user</span><span class="sc">&#39;s group vector instead of initializing the group vector based on runas_user.

             rlimit_as=soft,hard
                   The maximum size to which the process&#39;</span><span class="n">s</span><span class="w"> </span><span class="n">address</span><span class="w"> </span><span class="n">space</span><span class="w"> </span><span class="n">may</span><span class="w"> </span><span class="n">grow</span><span class="w"> </span><span class="p" data-group-id="7867108359-107">(</span><span class="ow">in</span><span class="w"> </span><span class="n">bytes</span><span class="p" data-group-id="7867108359-107">)</span><span class="p">,</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">supported</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">operating</span><span class="w"> </span><span class="n">system</span><span class="o">.</span><span class="w">  </span><span class="nc">The</span><span class="w"> </span><span class="n">soft</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">hard</span><span class="w"> </span><span class="n">limits</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">separated</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">a</span><span class="w">
                   </span><span class="n">comma</span><span class="o">.</span><span class="w">  </span><span class="nc">If</span><span class="w"> </span><span class="n">only</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">single</span><span class="w"> </span><span class="n">value</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">specified</span><span class="p">,</span><span class="w"> </span><span class="n">both</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">hard</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">soft</span><span class="w"> </span><span class="n">limits</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">set</span><span class="o">.</span><span class="w">  </span><span class="nc">A</span><span class="w"> </span><span class="n">value</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="err">“</span><span class="n">infinity</span><span class="err">”</span><span class="w"> </span><span class="n">indicates</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">there</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">no</span><span class="w"> </span><span class="n">limit</span><span class="o">.</span><span class="w">  </span><span class="nc">A</span><span class="w"> </span><span class="n">value</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="err">“</span><span class="n">user</span><span class="err">”</span><span class="w">
                   </span><span class="n">will</span><span class="w"> </span><span class="n">cause</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">invoking</span><span class="w"> </span><span class="n">user</span><span class="sc">&#39;s resource limit to be preserved.  A value of “default” will cause the target user&#39;</span><span class="n">s</span><span class="w"> </span><span class="n">default</span><span class="w"> </span><span class="n">resource</span><span class="w"> </span><span class="n">limit</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">used</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">systems</span><span class="w">
                   </span><span class="n">that</span><span class="w"> </span><span class="n">allow</span><span class="w"> </span><span class="n">per</span><span class="o">-</span><span class="n">user</span><span class="w"> </span><span class="n">resource</span><span class="w"> </span><span class="n">limits</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">configured</span><span class="o">.</span><span class="w">  </span><span class="nc">Only</span><span class="w"> </span><span class="n">available</span><span class="w"> </span><span class="n">starting</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="nc">API</span><span class="w"> </span><span class="n">version</span><span class="w"> </span><span class="mf">1.18</span><span class="o">.</span><span class="w">

             </span><span class="n">rlimit_core</span><span class="o">=</span><span class="n">soft</span><span class="p">,</span><span class="n">hard</span><span class="w">
                   </span><span class="nc">The</span><span class="w"> </span><span class="n">largest</span><span class="w"> </span><span class="n">size</span><span class="w"> </span><span class="n">core</span><span class="w"> </span><span class="n">dump</span><span class="w"> </span><span class="n">file</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">may</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">created</span><span class="w"> </span><span class="p" data-group-id="7867108359-108">(</span><span class="ow">in</span><span class="w"> </span><span class="n">bytes</span><span class="p" data-group-id="7867108359-108">)</span><span class="o">.</span><span class="w">  </span><span class="nc">The</span><span class="w"> </span><span class="n">soft</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">hard</span><span class="w"> </span><span class="n">limits</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">separated</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">comma</span><span class="o">.</span><span class="w">  </span><span class="nc">If</span><span class="w"> </span><span class="n">only</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">single</span><span class="w"> </span><span class="n">value</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">specified</span><span class="p">,</span><span class="w"> </span><span class="n">both</span><span class="w"> </span><span class="n">the</span><span class="w">
                   </span><span class="n">hard</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">soft</span><span class="w"> </span><span class="n">limits</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">set</span><span class="o">.</span><span class="w">  </span><span class="nc">A</span><span class="w"> </span><span class="n">value</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="err">“</span><span class="n">infinity</span><span class="err">”</span><span class="w"> </span><span class="n">indicates</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">there</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">no</span><span class="w"> </span><span class="n">limit</span><span class="o">.</span><span class="w">  </span><span class="nc">A</span><span class="w"> </span><span class="n">value</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="err">“</span><span class="n">user</span><span class="err">”</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">cause</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">invoking</span><span class="w"> </span><span class="n">user</span><span class="sc">&#39;s resource limit to be pre‐
                   served.  A value of “default” will cause the target user&#39;</span><span class="n">s</span><span class="w"> </span><span class="n">default</span><span class="w"> </span><span class="n">resource</span><span class="w"> </span><span class="n">limit</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">used</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">systems</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">allow</span><span class="w"> </span><span class="n">per</span><span class="o">-</span><span class="n">user</span><span class="w"> </span><span class="n">resource</span><span class="w"> </span><span class="n">limits</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">configured</span><span class="o">.</span><span class="w">
                   </span><span class="nc">Only</span><span class="w"> </span><span class="n">available</span><span class="w"> </span><span class="n">starting</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="nc">API</span><span class="w"> </span><span class="n">version</span><span class="w"> </span><span class="mf">1.18</span><span class="o">.</span><span class="w">

             </span><span class="n">rlimit_cpu</span><span class="o">=</span><span class="n">soft</span><span class="p">,</span><span class="n">hard</span><span class="w">
                   </span><span class="nc">The</span><span class="w"> </span><span class="n">maximum</span><span class="w"> </span><span class="n">amount</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="nc">CPU</span><span class="w"> </span><span class="n">time</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">process</span><span class="w"> </span><span class="n">may</span><span class="w"> </span><span class="kn">use</span><span class="w"> </span><span class="p" data-group-id="7867108359-109">(</span><span class="ow">in</span><span class="w"> </span><span class="n">seconds</span><span class="p" data-group-id="7867108359-109">)</span><span class="o">.</span><span class="w">  </span><span class="nc">The</span><span class="w"> </span><span class="n">soft</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">hard</span><span class="w"> </span><span class="n">limits</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">separated</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">comma</span><span class="o">.</span><span class="w">  </span><span class="nc">If</span><span class="w"> </span><span class="n">only</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">single</span><span class="w"> </span><span class="n">value</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">specified</span><span class="p">,</span><span class="w">
                   </span><span class="n">both</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">hard</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">soft</span><span class="w"> </span><span class="n">limits</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">set</span><span class="o">.</span><span class="w">  </span><span class="nc">A</span><span class="w"> </span><span class="n">value</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="err">“</span><span class="n">infinity</span><span class="err">”</span><span class="w"> </span><span class="n">indicates</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">there</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">no</span><span class="w"> </span><span class="n">limit</span><span class="o">.</span><span class="w">  </span><span class="nc">A</span><span class="w"> </span><span class="n">value</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="err">“</span><span class="n">user</span><span class="err">”</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">cause</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">invoking</span><span class="w"> </span><span class="n">user</span><span class="sc">&#39;s resource limit
                   to be preserved.  A value of “default” will cause the target user&#39;</span><span class="n">s</span><span class="w"> </span><span class="n">default</span><span class="w"> </span><span class="n">resource</span><span class="w"> </span><span class="n">limit</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">used</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">systems</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">allow</span><span class="w"> </span><span class="n">per</span><span class="o">-</span><span class="n">user</span><span class="w"> </span><span class="n">resource</span><span class="w"> </span><span class="n">limits</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">config</span><span class="err">‐</span><span class="w">
                   </span><span class="n">ured</span><span class="o">.</span><span class="w">  </span><span class="nc">Only</span><span class="w"> </span><span class="n">available</span><span class="w"> </span><span class="n">starting</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="nc">API</span><span class="w"> </span><span class="n">version</span><span class="w"> </span><span class="mf">1.18</span><span class="o">.</span><span class="w">

             </span><span class="n">rlimit_data</span><span class="o">=</span><span class="n">soft</span><span class="p">,</span><span class="n">hard</span><span class="w">
                   </span><span class="nc">The</span><span class="w"> </span><span class="n">maximum</span><span class="w"> </span><span class="n">size</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="n">segment</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">process</span><span class="w"> </span><span class="p" data-group-id="7867108359-110">(</span><span class="ow">in</span><span class="w"> </span><span class="n">bytes</span><span class="p" data-group-id="7867108359-110">)</span><span class="o">.</span><span class="w">  </span><span class="nc">The</span><span class="w"> </span><span class="n">soft</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">hard</span><span class="w"> </span><span class="n">limits</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">separated</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">comma</span><span class="o">.</span><span class="w">  </span><span class="nc">If</span><span class="w"> </span><span class="n">only</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">single</span><span class="w"> </span><span class="n">value</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">specified</span><span class="p">,</span><span class="w"> </span><span class="n">both</span><span class="w">
                   </span><span class="n">the</span><span class="w"> </span><span class="n">hard</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">soft</span><span class="w"> </span><span class="n">limits</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">set</span><span class="o">.</span><span class="w">  </span><span class="nc">A</span><span class="w"> </span><span class="n">value</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="err">“</span><span class="n">infinity</span><span class="err">”</span><span class="w"> </span><span class="n">indicates</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">there</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">no</span><span class="w"> </span><span class="n">limit</span><span class="o">.</span><span class="w">  </span><span class="nc">A</span><span class="w"> </span><span class="n">value</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="err">“</span><span class="n">user</span><span class="err">”</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">cause</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">invoking</span><span class="w"> </span><span class="n">user</span><span class="sc">&#39;s resource limit to be
                   preserved.  A value of “default” will cause the target user&#39;</span><span class="n">s</span><span class="w"> </span><span class="n">default</span><span class="w"> </span><span class="n">resource</span><span class="w"> </span><span class="n">limit</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">used</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">systems</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">allow</span><span class="w"> </span><span class="n">per</span><span class="o">-</span><span class="n">user</span><span class="w"> </span><span class="n">resource</span><span class="w"> </span><span class="n">limits</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">configured</span><span class="o">.</span><span class="w">
                   </span><span class="nc">Only</span><span class="w"> </span><span class="n">available</span><span class="w"> </span><span class="n">starting</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="nc">API</span><span class="w"> </span><span class="n">version</span><span class="w"> </span><span class="mf">1.18</span><span class="o">.</span><span class="w">

             </span><span class="n">rlimit_fsize</span><span class="o">=</span><span class="n">soft</span><span class="p">,</span><span class="n">hard</span><span class="w">
                   </span><span class="nc">The</span><span class="w"> </span><span class="n">largest</span><span class="w"> </span><span class="n">size</span><span class="w"> </span><span class="n">file</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">process</span><span class="w"> </span><span class="n">may</span><span class="w"> </span><span class="n">create</span><span class="w"> </span><span class="p" data-group-id="7867108359-111">(</span><span class="ow">in</span><span class="w"> </span><span class="n">bytes</span><span class="p" data-group-id="7867108359-111">)</span><span class="o">.</span><span class="w">  </span><span class="nc">The</span><span class="w"> </span><span class="n">soft</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">hard</span><span class="w"> </span><span class="n">limits</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">separated</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">comma</span><span class="o">.</span><span class="w">  </span><span class="nc">If</span><span class="w"> </span><span class="n">only</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">single</span><span class="w"> </span><span class="n">value</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">specified</span><span class="p">,</span><span class="w"> </span><span class="n">both</span><span class="w"> </span><span class="n">the</span><span class="w">
                   </span><span class="n">hard</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">soft</span><span class="w"> </span><span class="n">limits</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">set</span><span class="o">.</span><span class="w">  </span><span class="nc">A</span><span class="w"> </span><span class="n">value</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="err">“</span><span class="n">infinity</span><span class="err">”</span><span class="w"> </span><span class="n">indicates</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">there</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">no</span><span class="w"> </span><span class="n">limit</span><span class="o">.</span><span class="w">  </span><span class="nc">A</span><span class="w"> </span><span class="n">value</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="err">“</span><span class="n">user</span><span class="err">”</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">cause</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">invoking</span><span class="w"> </span><span class="n">user</span><span class="sc">&#39;s resource limit to be pre‐
                   served.  A value of “default” will cause the target user&#39;</span><span class="n">s</span><span class="w"> </span><span class="n">default</span><span class="w"> </span><span class="n">resource</span><span class="w"> </span><span class="n">limit</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">used</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">systems</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">allow</span><span class="w"> </span><span class="n">per</span><span class="o">-</span><span class="n">user</span><span class="w"> </span><span class="n">resource</span><span class="w"> </span><span class="n">limits</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">configured</span><span class="o">.</span><span class="w">
                   </span><span class="nc">Only</span><span class="w"> </span><span class="n">available</span><span class="w"> </span><span class="n">starting</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="nc">API</span><span class="w"> </span><span class="n">version</span><span class="w"> </span><span class="mf">1.18</span><span class="o">.</span><span class="w">

             </span><span class="n">rlimit_locks</span><span class="o">=</span><span class="n">soft</span><span class="p">,</span><span class="n">hard</span><span class="w">
                   </span><span class="nc">The</span><span class="w"> </span><span class="n">maximum</span><span class="w"> </span><span class="n">number</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">locks</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">process</span><span class="w"> </span><span class="n">may</span><span class="w"> </span><span class="n">establish</span><span class="p">,</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">supported</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">operating</span><span class="w"> </span><span class="n">system</span><span class="o">.</span><span class="w">  </span><span class="nc">The</span><span class="w"> </span><span class="n">soft</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">hard</span><span class="w"> </span><span class="n">limits</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">separated</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">comma</span><span class="o">.</span><span class="w">  </span><span class="nc">If</span><span class="w"> </span><span class="n">only</span><span class="w"> </span><span class="n">a</span><span class="w">
                   </span><span class="n">single</span><span class="w"> </span><span class="n">value</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">specified</span><span class="p">,</span><span class="w"> </span><span class="n">both</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">hard</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">soft</span><span class="w"> </span><span class="n">limits</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">set</span><span class="o">.</span><span class="w">  </span><span class="nc">A</span><span class="w"> </span><span class="n">value</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="err">“</span><span class="n">infinity</span><span class="err">”</span><span class="w"> </span><span class="n">indicates</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">there</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">no</span><span class="w"> </span><span class="n">limit</span><span class="o">.</span><span class="w">  </span><span class="nc">A</span><span class="w"> </span><span class="n">value</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="err">“</span><span class="n">user</span><span class="err">”</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">cause</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="ow">in</span><span class="err">‐</span><span class="w">
                   </span><span class="n">voking</span><span class="w"> </span><span class="n">user</span><span class="sc">&#39;s resource limit to be preserved.  A value of “default” will cause the target user&#39;</span><span class="n">s</span><span class="w"> </span><span class="n">default</span><span class="w"> </span><span class="n">resource</span><span class="w"> </span><span class="n">limit</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">used</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">systems</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">allow</span><span class="w"> </span><span class="n">per</span><span class="o">-</span><span class="n">user</span><span class="w">
                   </span><span class="n">resource</span><span class="w"> </span><span class="n">limits</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">configured</span><span class="o">.</span><span class="w">  </span><span class="nc">Only</span><span class="w"> </span><span class="n">available</span><span class="w"> </span><span class="n">starting</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="nc">API</span><span class="w"> </span><span class="n">version</span><span class="w"> </span><span class="mf">1.18</span><span class="o">.</span><span class="w">

             </span><span class="n">rlimit_memlock</span><span class="o">=</span><span class="n">soft</span><span class="p">,</span><span class="n">hard</span><span class="w">
                   </span><span class="nc">The</span><span class="w"> </span><span class="n">maximum</span><span class="w"> </span><span class="n">size</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">process</span><span class="w"> </span><span class="n">may</span><span class="w"> </span><span class="n">lock</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">memory</span><span class="w"> </span><span class="p" data-group-id="7867108359-112">(</span><span class="ow">in</span><span class="w"> </span><span class="n">bytes</span><span class="p" data-group-id="7867108359-112">)</span><span class="p">,</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">supported</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">operating</span><span class="w"> </span><span class="n">system</span><span class="o">.</span><span class="w">  </span><span class="nc">The</span><span class="w"> </span><span class="n">soft</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">hard</span><span class="w"> </span><span class="n">limits</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">separated</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">comma</span><span class="o">.</span><span class="w">  </span><span class="nc">If</span><span class="w">
                   </span><span class="n">only</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">single</span><span class="w"> </span><span class="n">value</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">specified</span><span class="p">,</span><span class="w"> </span><span class="n">both</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">hard</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">soft</span><span class="w"> </span><span class="n">limits</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">set</span><span class="o">.</span><span class="w">  </span><span class="nc">A</span><span class="w"> </span><span class="n">value</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="err">“</span><span class="n">infinity</span><span class="err">”</span><span class="w"> </span><span class="n">indicates</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">there</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">no</span><span class="w"> </span><span class="n">limit</span><span class="o">.</span><span class="w">  </span><span class="nc">A</span><span class="w"> </span><span class="n">value</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="err">“</span><span class="n">user</span><span class="err">”</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">cause</span><span class="w">
                   </span><span class="n">the</span><span class="w"> </span><span class="n">invoking</span><span class="w"> </span><span class="n">user</span><span class="sc">&#39;s resource limit to be preserved.  A value of “default” will cause the target user&#39;</span><span class="n">s</span><span class="w"> </span><span class="n">default</span><span class="w"> </span><span class="n">resource</span><span class="w"> </span><span class="n">limit</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">used</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">systems</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">allow</span><span class="w">
                   </span><span class="n">per</span><span class="o">-</span><span class="n">user</span><span class="w"> </span><span class="n">resource</span><span class="w"> </span><span class="n">limits</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">configured</span><span class="o">.</span><span class="w">  </span><span class="nc">Only</span><span class="w"> </span><span class="n">available</span><span class="w"> </span><span class="n">starting</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="nc">API</span><span class="w"> </span><span class="n">version</span><span class="w"> </span><span class="mf">1.18</span><span class="o">.</span><span class="w">

             </span><span class="n">rlimit_nofile</span><span class="o">=</span><span class="n">soft</span><span class="p">,</span><span class="n">hard</span><span class="w">
                   </span><span class="nc">The</span><span class="w"> </span><span class="n">maximum</span><span class="w"> </span><span class="n">number</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">files</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">process</span><span class="w"> </span><span class="n">may</span><span class="w"> </span><span class="n">have</span><span class="w"> </span><span class="n">open</span><span class="o">.</span><span class="w">  </span><span class="nc">The</span><span class="w"> </span><span class="n">soft</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">hard</span><span class="w"> </span><span class="n">limits</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">separated</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">comma</span><span class="o">.</span><span class="w">  </span><span class="nc">If</span><span class="w"> </span><span class="n">only</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">single</span><span class="w"> </span><span class="n">value</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">specified</span><span class="p">,</span><span class="w"> </span><span class="n">both</span><span class="w"> </span><span class="n">the</span><span class="w">
                   </span><span class="n">hard</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">soft</span><span class="w"> </span><span class="n">limits</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">set</span><span class="o">.</span><span class="w">  </span><span class="nc">A</span><span class="w"> </span><span class="n">value</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="err">“</span><span class="n">infinity</span><span class="err">”</span><span class="w"> </span><span class="n">indicates</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">there</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">no</span><span class="w"> </span><span class="n">limit</span><span class="o">.</span><span class="w">  </span><span class="nc">A</span><span class="w"> </span><span class="n">value</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="err">“</span><span class="n">user</span><span class="err">”</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">cause</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">invoking</span><span class="w"> </span><span class="n">user</span><span class="sc">&#39;s resource limit to be pre‐
                   served.  A value of “default” will cause the target user&#39;</span><span class="n">s</span><span class="w"> </span><span class="n">default</span><span class="w"> </span><span class="n">resource</span><span class="w"> </span><span class="n">limit</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">used</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">systems</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">allow</span><span class="w"> </span><span class="n">per</span><span class="o">-</span><span class="n">user</span><span class="w"> </span><span class="n">resource</span><span class="w"> </span><span class="n">limits</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">configured</span><span class="o">.</span><span class="w">
                   </span><span class="nc">Only</span><span class="w"> </span><span class="n">available</span><span class="w"> </span><span class="n">starting</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="nc">API</span><span class="w"> </span><span class="n">version</span><span class="w"> </span><span class="mf">1.18</span><span class="o">.</span><span class="w">

             </span><span class="n">rlimit_nproc</span><span class="o">=</span><span class="n">soft</span><span class="p">,</span><span class="n">hard</span><span class="w">
                   </span><span class="nc">The</span><span class="w"> </span><span class="n">maximum</span><span class="w"> </span><span class="n">number</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">processes</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">user</span><span class="w"> </span><span class="n">may</span><span class="w"> </span><span class="n">run</span><span class="w"> </span><span class="n">simultaneously</span><span class="o">.</span><span class="w">  </span><span class="nc">The</span><span class="w"> </span><span class="n">soft</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">hard</span><span class="w"> </span><span class="n">limits</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">separated</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">comma</span><span class="o">.</span><span class="w">  </span><span class="nc">If</span><span class="w"> </span><span class="n">only</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">single</span><span class="w"> </span><span class="n">value</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">specified</span><span class="p">,</span><span class="w">
                   </span><span class="n">both</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">hard</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">soft</span><span class="w"> </span><span class="n">limits</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">set</span><span class="o">.</span><span class="w">  </span><span class="nc">A</span><span class="w"> </span><span class="n">value</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="err">“</span><span class="n">infinity</span><span class="err">”</span><span class="w"> </span><span class="n">indicates</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">there</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">no</span><span class="w"> </span><span class="n">limit</span><span class="o">.</span><span class="w">  </span><span class="nc">A</span><span class="w"> </span><span class="n">value</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="err">“</span><span class="n">user</span><span class="err">”</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">cause</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">invoking</span><span class="w"> </span><span class="n">user</span><span class="sc">&#39;s resource limit
                   to be preserved.  A value of “default” will cause the target user&#39;</span><span class="n">s</span><span class="w"> </span><span class="n">default</span><span class="w"> </span><span class="n">resource</span><span class="w"> </span><span class="n">limit</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">used</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">systems</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">allow</span><span class="w"> </span><span class="n">per</span><span class="o">-</span><span class="n">user</span><span class="w"> </span><span class="n">resource</span><span class="w"> </span><span class="n">limits</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">config</span><span class="err">‐</span><span class="w">
                   </span><span class="n">ured</span><span class="o">.</span><span class="w">  </span><span class="nc">Only</span><span class="w"> </span><span class="n">available</span><span class="w"> </span><span class="n">starting</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="nc">API</span><span class="w"> </span><span class="n">version</span><span class="w"> </span><span class="mf">1.18</span><span class="o">.</span><span class="w">

             </span><span class="n">rlimit_rss</span><span class="o">=</span><span class="n">soft</span><span class="p">,</span><span class="n">hard</span><span class="w">
                   </span><span class="nc">The</span><span class="w"> </span><span class="n">maximum</span><span class="w"> </span><span class="n">size</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">which</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">process</span><span class="sc">&#39;s resident set size may grow (in bytes).  The soft and hard limits are separated by a comma.  If only a single value is
                   specified, both the hard and soft limits are set.  A value of “infinity” indicates that there is no limit.  A value of “user” will cause the invoking user&#39;</span><span class="n">s</span><span class="w"> </span><span class="n">re</span><span class="err">‐</span><span class="w">
                   </span><span class="n">source</span><span class="w"> </span><span class="n">limit</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">preserved</span><span class="o">.</span><span class="w">  </span><span class="nc">A</span><span class="w"> </span><span class="n">value</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="err">“</span><span class="n">default</span><span class="err">”</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">cause</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">target</span><span class="w"> </span><span class="n">user</span><span class="sc">&#39;s default resource limit to be used on systems that allow per-user resource limits
                   to be configured.  Only available starting with API version 1.18.

             rlimit_stack=soft,hard
                   The maximum size to which the process&#39;</span><span class="n">s</span><span class="w"> </span><span class="n">stack</span><span class="w"> </span><span class="n">may</span><span class="w"> </span><span class="n">grow</span><span class="w"> </span><span class="p" data-group-id="7867108359-113">(</span><span class="ow">in</span><span class="w"> </span><span class="n">bytes</span><span class="p" data-group-id="7867108359-113">)</span><span class="o">.</span><span class="w">  </span><span class="nc">The</span><span class="w"> </span><span class="n">soft</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">hard</span><span class="w"> </span><span class="n">limits</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">separated</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">comma</span><span class="o">.</span><span class="w">  </span><span class="nc">If</span><span class="w"> </span><span class="n">only</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">single</span><span class="w"> </span><span class="n">value</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">specified</span><span class="p">,</span><span class="w"> </span><span class="n">both</span><span class="w">
                   </span><span class="n">the</span><span class="w"> </span><span class="n">hard</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">soft</span><span class="w"> </span><span class="n">limits</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">set</span><span class="o">.</span><span class="w">  </span><span class="nc">A</span><span class="w"> </span><span class="n">value</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="err">“</span><span class="n">infinity</span><span class="err">”</span><span class="w"> </span><span class="n">indicates</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">there</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">no</span><span class="w"> </span><span class="n">limit</span><span class="o">.</span><span class="w">  </span><span class="nc">A</span><span class="w"> </span><span class="n">value</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="err">“</span><span class="n">user</span><span class="err">”</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">cause</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">invoking</span><span class="w"> </span><span class="n">user</span><span class="sc">&#39;s resource limit to be
                   preserved.  A value of “default” will cause the target user&#39;</span><span class="n">s</span><span class="w"> </span><span class="n">default</span><span class="w"> </span><span class="n">resource</span><span class="w"> </span><span class="n">limit</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">used</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">systems</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">allow</span><span class="w"> </span><span class="n">per</span><span class="o">-</span><span class="n">user</span><span class="w"> </span><span class="n">resource</span><span class="w"> </span><span class="n">limits</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">configured</span><span class="o">.</span><span class="w">
                   </span><span class="nc">Only</span><span class="w"> </span><span class="n">available</span><span class="w"> </span><span class="n">starting</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="nc">API</span><span class="w"> </span><span class="n">version</span><span class="w"> </span><span class="mf">1.18</span><span class="o">.</span><span class="w">

             </span><span class="n">runas_egid</span><span class="o">=</span><span class="n">gid</span><span class="w">
                   </span><span class="nc">Effective</span><span class="w"> </span><span class="n">group</span><span class="o">-</span><span class="nc">ID</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">run</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">command</span><span class="w"> </span><span class="n">as</span><span class="o">.</span><span class="w">  </span><span class="nc">If</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">specified</span><span class="p">,</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">value</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">runas_gid</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">used</span><span class="o">.</span><span class="w">

             </span><span class="n">runas_euid</span><span class="o">=</span><span class="n">uid</span><span class="w">
                   </span><span class="nc">Effective</span><span class="w"> </span><span class="n">user</span><span class="o">-</span><span class="nc">ID</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">run</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">command</span><span class="w"> </span><span class="n">as</span><span class="o">.</span><span class="w">  </span><span class="nc">If</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">specified</span><span class="p">,</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">value</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">runas_uid</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">used</span><span class="o">.</span><span class="w">

             </span><span class="n">runas_gid</span><span class="o">=</span><span class="n">gid</span><span class="w">
                   </span><span class="nc">Group</span><span class="o">-</span><span class="nc">ID</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">run</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">command</span><span class="w"> </span><span class="n">as</span><span class="o">.</span><span class="w">

             </span><span class="n">runas_group</span><span class="o">=</span><span class="n">string</span><span class="w">
                   </span><span class="nc">The</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">group</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">command</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">run</span><span class="w"> </span><span class="n">as</span><span class="p">,</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">it</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">different</span><span class="w"> </span><span class="n">from</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">runas_user</span><span class="sc">&#39;s default group.  This value is provided for auditing purposes only, the
                   sudo front-end uses runas_egid and runas_gid when executing the command.

             runas_groups=list
                   The supplementary group vector to use for the command in the form of a comma-separated list of group-IDs.  If preserve_groups is set, this option is ignored.

             runas_uid=uid
                   User-ID to run the command as.

             runas_user=string
                   The name of the user the command will run as, which should correspond to runas_euid (or runas_uid if runas_euid is not set).  This value is provided for auditing
                   purposes only, the sudo front-end uses runas_euid and runas_uid when executing the command.

             selinux_role=string
                   SELinux role to use when executing the command.

             selinux_type=string
                   SELinux type to use when executing the command.

             set_utmp=bool
                   Create a utmp (or utmpx) entry when a pseudo-terminal is allocated.  By default, the new entry will be a copy of the user&#39;</span><span class="n">s</span><span class="w"> </span><span class="n">existing</span><span class="w"> </span><span class="n">utmp</span><span class="w"> </span><span class="n">entry</span><span class="w"> </span><span class="p" data-group-id="7867108359-114">(</span><span class="k">if</span><span class="w"> </span><span class="n">any</span><span class="p" data-group-id="7867108359-114">)</span><span class="p">,</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">the</span><span class="w">
                   </span><span class="n">tty</span><span class="p">,</span><span class="w"> </span><span class="n">time</span><span class="p">,</span><span class="w"> </span><span class="n">type</span><span class="p">,</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">pid</span><span class="w"> </span><span class="n">fields</span><span class="w"> </span><span class="n">updated</span><span class="o">.</span><span class="w">

             </span><span class="n">sudoedit</span><span class="o">=</span><span class="n">bool</span><span class="w">
                   </span><span class="nc">Set</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="no">true</span><span class="w"> </span><span class="ow">when</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">sudoedit</span><span class="w"> </span><span class="n">mode</span><span class="o">.</span><span class="w">  </span><span class="nc">The</span><span class="w"> </span><span class="n">plugin</span><span class="w"> </span><span class="n">may</span><span class="w"> </span><span class="n">enable</span><span class="w"> </span><span class="n">sudoedit</span><span class="w"> </span><span class="n">mode</span><span class="w"> </span><span class="n">even</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">sudo</span><span class="w"> </span><span class="n">was</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">invoked</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="n">sudoedit</span><span class="o">.</span><span class="w">  </span><span class="nc">This</span><span class="w"> </span><span class="n">allows</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">plugin</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">perform</span><span class="w"> </span><span class="n">command</span><span class="w"> </span><span class="n">sub</span><span class="err">‐</span><span class="w">
                   </span><span class="n">stitution</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">transparently</span><span class="w"> </span><span class="n">enable</span><span class="w"> </span><span class="n">sudoedit</span><span class="w"> </span><span class="ow">when</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">user</span><span class="w"> </span><span class="n">attempts</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">run</span><span class="w"> </span><span class="n">an</span><span class="w"> </span><span class="n">editor</span><span class="o">.</span><span class="w">

             </span><span class="n">sudoedit_checkdir</span><span class="o">=</span><span class="n">bool</span><span class="w">
                   </span><span class="nc">Set</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="no">false</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">disable</span><span class="w"> </span><span class="n">directory</span><span class="w"> </span><span class="n">writability</span><span class="w"> </span><span class="n">checks</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">sudoedit</span><span class="o">.</span><span class="w">  </span><span class="nc">By</span><span class="w"> </span><span class="n">default</span><span class="p">,</span><span class="w"> </span><span class="n">sudoedit</span><span class="w"> </span><span class="mf">1.8</span><span class="o">.</span><span class="mi">16</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">higher</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">check</span><span class="w"> </span><span class="n">all</span><span class="w"> </span><span class="n">directory</span><span class="w"> </span><span class="n">components</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">path</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">be</span><span class="w">
                   </span><span class="n">edited</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">writability</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">invoking</span><span class="w"> </span><span class="n">user</span><span class="o">.</span><span class="w">  </span><span class="nc">Symbolic</span><span class="w"> </span><span class="n">links</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">followed</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">writable</span><span class="w"> </span><span class="n">directories</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">sudoedit</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">refuse</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">edit</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">file</span><span class="w"> </span><span class="n">located</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">a</span><span class="w">
                   </span><span class="n">writable</span><span class="w"> </span><span class="n">directory</span><span class="o">.</span><span class="w">  </span><span class="nc">These</span><span class="w"> </span><span class="n">restrictions</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">enforced</span><span class="w"> </span><span class="ow">when</span><span class="w"> </span><span class="n">sudoedit</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">run</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">root</span><span class="o">.</span><span class="w">  </span><span class="nc">The</span><span class="w"> </span><span class="n">sudoedit_checkdir</span><span class="w"> </span><span class="n">option</span><span class="w"> </span><span class="n">can</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">set</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="no">false</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">disable</span><span class="w"> </span><span class="n">this</span><span class="w"> </span><span class="n">check</span><span class="o">.</span><span class="w">
                   </span><span class="nc">Only</span><span class="w"> </span><span class="n">available</span><span class="w"> </span><span class="n">starting</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="nc">API</span><span class="w"> </span><span class="n">version</span><span class="w"> </span><span class="mf">1.8</span><span class="o">.</span><span class="w">

             </span><span class="n">sudoedit_follow</span><span class="o">=</span><span class="n">bool</span><span class="w">
                   </span><span class="nc">Set</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="no">true</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">allow</span><span class="w"> </span><span class="n">sudoedit</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">edit</span><span class="w"> </span><span class="n">files</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">symbolic</span><span class="w"> </span><span class="n">links</span><span class="o">.</span><span class="w">  </span><span class="nc">By</span><span class="w"> </span><span class="n">default</span><span class="p">,</span><span class="w"> </span><span class="n">sudoedit</span><span class="w"> </span><span class="mf">1.8</span><span class="o">.</span><span class="mi">15</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">higher</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">refuse</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">open</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">symbolic</span><span class="w"> </span><span class="n">link</span><span class="o">.</span><span class="w">  </span><span class="nc">The</span><span class="w">
                   </span><span class="n">sudoedit_follow</span><span class="w"> </span><span class="n">option</span><span class="w"> </span><span class="n">can</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">used</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">restore</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">older</span><span class="w"> </span><span class="n">behavior</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">allow</span><span class="w"> </span><span class="n">sudoedit</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">open</span><span class="w"> </span><span class="n">symbolic</span><span class="w"> </span><span class="n">links</span><span class="o">.</span><span class="w">  </span><span class="nc">Only</span><span class="w"> </span><span class="n">available</span><span class="w"> </span><span class="n">starting</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="nc">API</span><span class="w"> </span><span class="n">version</span><span class="w"> </span><span class="mf">1.8</span><span class="o">.</span><span class="w">

             </span><span class="n">sudoedit_nfiles</span><span class="o">=</span><span class="n">number</span><span class="w">
                   </span><span class="nc">The</span><span class="w"> </span><span class="n">number</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">files</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">edited</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">user</span><span class="o">.</span><span class="w">  </span><span class="nc">If</span><span class="w"> </span><span class="n">present</span><span class="p">,</span><span class="w"> </span><span class="n">this</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">used</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">sudo</span><span class="w"> </span><span class="n">front</span><span class="o">-</span><span class="k" data-group-id="7867108359-97">end</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">determine</span><span class="w"> </span><span class="n">which</span><span class="w"> </span><span class="n">elements</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">argv_out</span><span class="w"> </span><span class="n">vector</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">files</span><span class="w">
                   </span><span class="n">to</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">edited</span><span class="o">.</span><span class="w">  </span><span class="nc">The</span><span class="w"> </span><span class="err">‘</span><span class="o">--</span><span class="err">’</span><span class="w"> </span><span class="n">element</span><span class="w"> </span><span class="n">must</span><span class="w"> </span><span class="n">immediately</span><span class="w"> </span><span class="n">precede</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">first</span><span class="w"> </span><span class="n">file</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">editied</span><span class="o">.</span><span class="w">  </span><span class="nc">If</span><span class="w"> </span><span class="n">sudoedit_nfiles</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">specified</span><span class="p">,</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">sudo</span><span class="w"> </span><span class="n">front</span><span class="o">-</span><span class="k" data-group-id="7867108359-96">end</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="kn">use</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">posi</span><span class="err">‐</span><span class="w">
                   </span><span class="n">tion</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="err">‘</span><span class="o">--</span><span class="err">’</span><span class="w"> </span><span class="n">element</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">determine</span><span class="w"> </span><span class="n">where</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">file</span><span class="w"> </span><span class="n">list</span><span class="w"> </span><span class="n">begins</span><span class="o">.</span><span class="w">  </span><span class="nc">Only</span><span class="w"> </span><span class="n">available</span><span class="w"> </span><span class="n">starting</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="nc">API</span><span class="w"> </span><span class="n">version</span><span class="w"> </span><span class="mf">1.21</span><span class="o">.</span><span class="w">

             </span><span class="n">timeout</span><span class="o">=</span><span class="n">int</span><span class="w">
                   </span><span class="nc">Command</span><span class="w"> </span><span class="n">timeout</span><span class="o">.</span><span class="w">  </span><span class="nc">If</span><span class="w"> </span><span class="n">non</span><span class="o">-</span><span class="n">zero</span><span class="w"> </span><span class="n">then</span><span class="w"> </span><span class="ow">when</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">timeout</span><span class="w"> </span><span class="n">expires</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">command</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">killed</span><span class="o">.</span><span class="w">

             </span><span class="n">umask</span><span class="o">=</span><span class="n">octal</span><span class="w">
                   </span><span class="nc">The</span><span class="w"> </span><span class="n">file</span><span class="w"> </span><span class="n">creation</span><span class="w"> </span><span class="n">mask</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="kn">use</span><span class="w"> </span><span class="ow">when</span><span class="w"> </span><span class="n">executing</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">command</span><span class="o">.</span><span class="w">  </span><span class="nc">This</span><span class="w"> </span><span class="n">value</span><span class="w"> </span><span class="n">may</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">overridden</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="nc">PAM</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">login</span><span class="o">.</span><span class="n">conf</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">some</span><span class="w"> </span><span class="n">systems</span><span class="w"> </span><span class="k">unless</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">umask_override</span><span class="w"> </span><span class="n">option</span><span class="w"> </span><span class="n">is</span><span class="w">
                   </span><span class="n">also</span><span class="w"> </span><span class="n">set</span><span class="o">.</span><span class="w">

             </span><span class="n">umask_override</span><span class="o">=</span><span class="n">bool</span><span class="w">
                   </span><span class="nc">Force</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">value</span><span class="w"> </span><span class="n">specified</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">umask</span><span class="w"> </span><span class="n">option</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">override</span><span class="w"> </span><span class="n">any</span><span class="w"> </span><span class="n">umask</span><span class="w"> </span><span class="n">set</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="nc">PAM</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">login</span><span class="o">.</span><span class="n">conf</span><span class="o">.</span><span class="w">

             </span><span class="n">use_ptrace</span><span class="o">=</span><span class="n">bool</span><span class="w">
                   </span><span class="nc">If</span><span class="w"> </span><span class="n">set</span><span class="p">,</span><span class="w"> </span><span class="n">sudo</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="kn">use</span><span class="w"> </span><span class="n">ptrace</span><span class="p" data-group-id="7867108359-115">(</span><span class="mi">2</span><span class="p" data-group-id="7867108359-115">)</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">implement</span><span class="w"> </span><span class="n">intercept</span><span class="w"> </span><span class="n">mode</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">supported</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">system</span><span class="o">.</span><span class="w">  </span><span class="nc">This</span><span class="w"> </span><span class="n">setting</span><span class="w"> </span><span class="n">has</span><span class="w"> </span><span class="n">no</span><span class="w"> </span><span class="n">effect</span><span class="w"> </span><span class="k">unless</span><span class="w"> </span><span class="n">intercept</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">also</span><span class="w"> </span><span class="n">set</span><span class="o">.</span><span class="w">  </span><span class="nc">Only</span><span class="w"> </span><span class="n">available</span><span class="w">
                   </span><span class="n">starting</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="nc">API</span><span class="w"> </span><span class="n">version</span><span class="w"> </span><span class="mf">1.19</span><span class="o">.</span><span class="w">

             </span><span class="n">use_pty</span><span class="o">=</span><span class="n">bool</span><span class="w">
                   </span><span class="nc">Allocate</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">pseudo</span><span class="o">-</span><span class="n">terminal</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">run</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">command</span><span class="w"> </span><span class="ow">in</span><span class="p">,</span><span class="w"> </span><span class="n">regardless</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">whether</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="nc">I</span><span class="o">/</span><span class="nc">O</span><span class="w"> </span><span class="n">logging</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="kn">use</span><span class="o">.</span><span class="w">  </span><span class="nc">By</span><span class="w"> </span><span class="n">default</span><span class="p">,</span><span class="w"> </span><span class="n">sudo</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">only</span><span class="w"> </span><span class="n">run</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">command</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">pseudo</span><span class="o">-</span><span class="n">ter</span><span class="err">‐</span><span class="w">
                   </span><span class="n">minal</span><span class="w"> </span><span class="ow">when</span><span class="w"> </span><span class="n">an</span><span class="w"> </span><span class="nc">I</span><span class="o">/</span><span class="nc">O</span><span class="w"> </span><span class="n">log</span><span class="w"> </span><span class="n">plugin</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">loaded</span><span class="o">.</span><span class="w">

             </span><span class="n">utmp_user</span><span class="o">=</span><span class="n">string</span><span class="w">
                   </span><span class="nc">User</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="kn">use</span><span class="w"> </span><span class="ow">when</span><span class="w"> </span><span class="n">constructing</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">new</span><span class="w"> </span><span class="n">utmp</span><span class="w"> </span><span class="p" data-group-id="7867108359-116">(</span><span class="ow">or</span><span class="w"> </span><span class="n">utmpx</span><span class="p" data-group-id="7867108359-116">)</span><span class="w"> </span><span class="n">entry</span><span class="w"> </span><span class="ow">when</span><span class="w"> </span><span class="n">set_utmp</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">enabled</span><span class="o">.</span><span class="w">  </span><span class="nc">This</span><span class="w"> </span><span class="n">option</span><span class="w"> </span><span class="n">can</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">used</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">set</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">user</span><span class="w"> </span><span class="n">field</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">utmp</span><span class="w"> </span><span class="n">entry</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">the</span><span class="w">
                   </span><span class="n">user</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">command</span><span class="w"> </span><span class="n">runs</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="n">rather</span><span class="w"> </span><span class="n">than</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">invoking</span><span class="w"> </span><span class="n">user</span><span class="o">.</span><span class="w">  </span><span class="nc">If</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">set</span><span class="p">,</span><span class="w"> </span><span class="n">sudo</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">base</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">new</span><span class="w"> </span><span class="n">entry</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">invoking</span><span class="w"> </span><span class="n">user</span><span class="sc">&#39;s existing entry.

             Unsupported values will be ignored.

       argv_out
             The NULL-terminated argument vector to pass to the execve(2) system call when executing the command.  The plugin is responsible for allocating and populating the vec‐
             tor.

       user_env_out
             The NULL-terminated environment vector to use when executing the command.  The plugin is responsible for allocating and populating the vector.

       errstr
             If the check_policy() function returns a value other than 1, the plugin may store a message describing the failure or error in errstr.  The sudo front-end will then
             pass this value to any registered audit plugins.  The string stored in errstr must remain valid until the plugin&#39;</span><span class="n">s</span><span class="w"> </span><span class="n">close</span><span class="p" data-group-id="7867108359-117">(</span><span class="p" data-group-id="7867108359-117">)</span><span class="w"> </span><span class="n">function</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">called</span><span class="o">.</span><span class="w">

             </span><span class="nc">The</span><span class="w"> </span><span class="n">errstr</span><span class="w"> </span><span class="n">parameter</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">only</span><span class="w"> </span><span class="n">available</span><span class="w"> </span><span class="n">starting</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="nc">API</span><span class="w"> </span><span class="n">version</span><span class="w"> </span><span class="mf">1.15</span><span class="o">.</span><span class="w">  </span><span class="nc">A</span><span class="w"> </span><span class="n">plugin</span><span class="w"> </span><span class="n">must</span><span class="w"> </span><span class="n">check</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nc">API</span><span class="w"> </span><span class="n">version</span><span class="w"> </span><span class="n">specified</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">sudo</span><span class="w"> </span><span class="n">front</span><span class="o">-</span><span class="k">end</span><span class="w"> </span><span class="n">before</span><span class="w"> </span><span class="n">using</span><span class="w"> </span><span class="n">errstr</span><span class="o">.</span><span class="w">  </span><span class="nc">Fail</span><span class="err">‐</span><span class="w">
             </span><span class="n">ure</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="k" data-group-id="7867108359-118">do</span><span class="w"> </span><span class="n">so</span><span class="w"> </span><span class="n">may</span><span class="w"> </span><span class="n">result</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">crash</span><span class="o">.</span><span class="w">

 </span><span class="n">list</span><span class="w">
       </span><span class="n">int</span><span class="w"> </span><span class="p" data-group-id="7867108359-119">(</span><span class="o">*</span><span class="n">list</span><span class="p" data-group-id="7867108359-119">)</span><span class="p" data-group-id="7867108359-120">(</span><span class="n">int</span><span class="w"> </span><span class="n">argc</span><span class="p">,</span><span class="w"> </span><span class="n">char</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">const</span><span class="w"> </span><span class="n">argv</span><span class="p" data-group-id="7867108359-121">[</span><span class="p" data-group-id="7867108359-121">]</span><span class="p">,</span><span class="w"> </span><span class="n">int</span><span class="w"> </span><span class="n">verbose</span><span class="p">,</span><span class="w">
           </span><span class="n">const</span><span class="w"> </span><span class="n">char</span><span class="w"> </span><span class="o">*</span><span class="n">user</span><span class="p">,</span><span class="w"> </span><span class="n">const</span><span class="w"> </span><span class="n">char</span><span class="w"> </span><span class="o">*</span><span class="o">*</span><span class="n">errstr</span><span class="p" data-group-id="7867108359-120">)</span><span class="p">;</span><span class="w">

       </span><span class="nc">List</span><span class="w"> </span><span class="n">available</span><span class="w"> </span><span class="n">privileges</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">invoking</span><span class="w"> </span><span class="n">user</span><span class="o">.</span><span class="w">  </span><span class="nc">Returns</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">success</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">failure</span><span class="p">,</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="o">-</span><span class="mi">1</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">error</span><span class="o">.</span><span class="w">  </span><span class="nc">On</span><span class="w"> </span><span class="n">error</span><span class="p">,</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">plugin</span><span class="w"> </span><span class="n">may</span><span class="w"> </span><span class="n">optionally</span><span class="w"> </span><span class="n">call</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">conversation</span><span class="p" data-group-id="7867108359-122">(</span><span class="p" data-group-id="7867108359-122">)</span><span class="w"> </span><span class="ow">or</span><span class="w">
       </span><span class="n">sudo_plugin_printf</span><span class="p" data-group-id="7867108359-123">(</span><span class="p" data-group-id="7867108359-123">)</span><span class="w"> </span><span class="n">function</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="nc">SUDO_CONF_ERROR_MSG</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">present</span><span class="w"> </span><span class="n">additional</span><span class="w"> </span><span class="n">error</span><span class="w"> </span><span class="n">information</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">user</span><span class="o">.</span><span class="w">

       </span><span class="nc">Privileges</span><span class="w"> </span><span class="n">should</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">output</span><span class="w"> </span><span class="n">via</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">conversation</span><span class="p" data-group-id="7867108359-124">(</span><span class="p" data-group-id="7867108359-124">)</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">sudo_plugin_printf</span><span class="p" data-group-id="7867108359-125">(</span><span class="p" data-group-id="7867108359-125">)</span><span class="w"> </span><span class="n">function</span><span class="w"> </span><span class="n">using</span><span class="w"> </span><span class="nc">SUDO_CONV_INFO_MSG</span><span class="o">.</span><span class="w">

       </span><span class="nc">The</span><span class="w"> </span><span class="n">function</span><span class="w"> </span><span class="n">arguments</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="ss">follows</span><span class="p">:</span><span class="w">

       </span><span class="n">argc</span><span class="w">  </span><span class="nc">The</span><span class="w"> </span><span class="n">number</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">elements</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">argv</span><span class="p">,</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">counting</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">final</span><span class="w"> </span><span class="nc">NULL</span><span class="w"> </span><span class="n">pointer</span><span class="o">.</span><span class="w">

       </span><span class="n">argv</span><span class="w">  </span><span class="nc">If</span><span class="w"> </span><span class="n">non</span><span class="o">-</span><span class="nc">NULL</span><span class="p">,</span><span class="w"> </span><span class="n">an</span><span class="w"> </span><span class="n">argument</span><span class="w"> </span><span class="n">vector</span><span class="w"> </span><span class="n">describing</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">command</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">user</span><span class="w"> </span><span class="n">wishes</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">check</span><span class="w"> </span><span class="n">against</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">policy</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">same</span><span class="w"> </span><span class="n">form</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="n">what</span><span class="w"> </span><span class="n">would</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">passed</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">execve</span><span class="p" data-group-id="7867108359-126">(</span><span class="mi">2</span><span class="p" data-group-id="7867108359-126">)</span><span class="w"> </span><span class="n">system</span><span class="w"> </span><span class="n">call</span><span class="o">.</span><span class="w">
             </span><span class="nc">If</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">command</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">permitted</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">policy</span><span class="p">,</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">fully</span><span class="o">-</span><span class="n">qualified</span><span class="w"> </span><span class="n">path</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">command</span><span class="w"> </span><span class="n">should</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">displayed</span><span class="w"> </span><span class="n">along</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">any</span><span class="w"> </span><span class="n">command</span><span class="w"> </span><span class="n">line</span><span class="w"> </span><span class="n">arguments</span><span class="o">.</span><span class="w">

       </span><span class="n">verbose</span><span class="w">
             </span><span class="nc">Flag</span><span class="w"> </span><span class="n">indicating</span><span class="w"> </span><span class="n">whether</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">list</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">verbose</span><span class="w"> </span><span class="n">mode</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="ow">not</span><span class="o">.</span><span class="w">

       </span><span class="n">user</span><span class="w">  </span><span class="nc">The</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">different</span><span class="w"> </span><span class="n">user</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">list</span><span class="w"> </span><span class="n">privileges</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">policy</span><span class="w"> </span><span class="n">allows</span><span class="w"> </span><span class="n">it</span><span class="o">.</span><span class="w">  </span><span class="nc">If</span><span class="w"> </span><span class="nc">NULL</span><span class="p">,</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">plugin</span><span class="w"> </span><span class="n">should</span><span class="w"> </span><span class="n">list</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">privileges</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">invoking</span><span class="w"> </span><span class="n">user</span><span class="o">.</span><span class="w">

       </span><span class="n">errstr</span><span class="w">
             </span><span class="nc">If</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">list</span><span class="p" data-group-id="7867108359-127">(</span><span class="p" data-group-id="7867108359-127">)</span><span class="w"> </span><span class="n">function</span><span class="w"> </span><span class="n">returns</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">value</span><span class="w"> </span><span class="n">other</span><span class="w"> </span><span class="n">than</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">plugin</span><span class="w"> </span><span class="n">may</span><span class="w"> </span><span class="n">store</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">message</span><span class="w"> </span><span class="n">describing</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">failure</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">error</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">errstr</span><span class="o">.</span><span class="w">  </span><span class="nc">The</span><span class="w"> </span><span class="n">sudo</span><span class="w"> </span><span class="n">front</span><span class="o">-</span><span class="k" data-group-id="7867108359-118">end</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">then</span><span class="w"> </span><span class="n">pass</span><span class="w"> </span><span class="n">this</span><span class="w">
             </span><span class="n">value</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">any</span><span class="w"> </span><span class="n">registered</span><span class="w"> </span><span class="n">audit</span><span class="w"> </span><span class="n">plugins</span><span class="o">.</span><span class="w">  </span><span class="nc">The</span><span class="w"> </span><span class="n">string</span><span class="w"> </span><span class="n">stored</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">errstr</span><span class="w"> </span><span class="n">must</span><span class="w"> </span><span class="n">remain</span><span class="w"> </span><span class="n">valid</span><span class="w"> </span><span class="n">until</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">plugin</span><span class="sc">&#39;s close() function is called.

             The errstr parameter is only available starting with API version 1.15.  A plugin must check the API version specified by the sudo front-end before using errstr.  Fail‐
             ure to do so may result in a crash.

 validate
       int (*validate)(const char **errstr);

       The validate() function is called when sudo is run with the -v option.  For policy plugins such as sudoers that cache authentication credentials, this function will validate
       and cache the credentials.

       The validate() function should be NULL if the plugin does not support credential caching.

       Returns 1 on success, 0 on failure, and -1 on error.  On error, the plugin may optionally call the conversation() or sudo_plugin_printf() function with SUDO_CONF_ERROR_MSG to
       present additional error information to the user.

       The function arguments are as follows:

       errstr
             If the validate() function returns a value other than 1, the plugin may store a message describing the failure or error in errstr.  The sudo front-end will then pass
             this value to any registered audit plugins.  The string stored in errstr must remain valid until the plugin&#39;</span><span class="n">s</span><span class="w"> </span><span class="n">close</span><span class="p" data-group-id="7867108359-128">(</span><span class="p" data-group-id="7867108359-128">)</span><span class="w"> </span><span class="n">function</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">called</span><span class="o">.</span><span class="w">

             </span><span class="nc">The</span><span class="w"> </span><span class="n">errstr</span><span class="w"> </span><span class="n">parameter</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">only</span><span class="w"> </span><span class="n">available</span><span class="w"> </span><span class="n">starting</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="nc">API</span><span class="w"> </span><span class="n">version</span><span class="w"> </span><span class="mf">1.15</span><span class="o">.</span><span class="w">  </span><span class="nc">A</span><span class="w"> </span><span class="n">plugin</span><span class="w"> </span><span class="n">must</span><span class="w"> </span><span class="n">check</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nc">API</span><span class="w"> </span><span class="n">version</span><span class="w"> </span><span class="n">specified</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">sudo</span><span class="w"> </span><span class="n">front</span><span class="o">-</span><span class="k">end</span><span class="w"> </span><span class="n">before</span><span class="w"> </span><span class="n">using</span><span class="w"> </span><span class="n">errstr</span><span class="o">.</span><span class="w">  </span><span class="nc">Fail</span><span class="err">‐</span><span class="w">
             </span><span class="n">ure</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="k" data-group-id="7867108359-129">do</span><span class="w"> </span><span class="n">so</span><span class="w"> </span><span class="n">may</span><span class="w"> </span><span class="n">result</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">crash</span><span class="o">.</span><span class="w">

 </span><span class="n">invalidate</span><span class="w">
       </span><span class="n">void</span><span class="w"> </span><span class="p" data-group-id="7867108359-130">(</span><span class="o">*</span><span class="n">invalidate</span><span class="p" data-group-id="7867108359-130">)</span><span class="p" data-group-id="7867108359-131">(</span><span class="n">int</span><span class="w"> </span><span class="n">rmcred</span><span class="p" data-group-id="7867108359-131">)</span><span class="p">;</span><span class="w">

       </span><span class="nc">The</span><span class="w"> </span><span class="n">invalidate</span><span class="p" data-group-id="7867108359-132">(</span><span class="p" data-group-id="7867108359-132">)</span><span class="w"> </span><span class="n">function</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">called</span><span class="w"> </span><span class="ow">when</span><span class="w"> </span><span class="n">sudo</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">run</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="o">-</span><span class="n">k</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="o">-</span><span class="nc">K</span><span class="w"> </span><span class="n">option</span><span class="o">.</span><span class="w">  </span><span class="nc">For</span><span class="w"> </span><span class="n">policy</span><span class="w"> </span><span class="n">plugins</span><span class="w"> </span><span class="n">such</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="n">sudoers</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">cache</span><span class="w"> </span><span class="n">authentication</span><span class="w"> </span><span class="n">credentials</span><span class="p">,</span><span class="w"> </span><span class="n">this</span><span class="w"> </span><span class="n">function</span><span class="w"> </span><span class="n">will</span><span class="w">
       </span><span class="n">invalidate</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">credentials</span><span class="o">.</span><span class="w">  </span><span class="nc">If</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">rmcred</span><span class="w"> </span><span class="n">flag</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">non</span><span class="o">-</span><span class="n">zero</span><span class="p">,</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">plugin</span><span class="w"> </span><span class="n">may</span><span class="w"> </span><span class="n">remove</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">credentials</span><span class="w"> </span><span class="n">instead</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">simply</span><span class="w"> </span><span class="n">invalidating</span><span class="w"> </span><span class="n">them</span><span class="o">.</span><span class="w">

       </span><span class="nc">The</span><span class="w"> </span><span class="n">invalidate</span><span class="p" data-group-id="7867108359-133">(</span><span class="p" data-group-id="7867108359-133">)</span><span class="w"> </span><span class="n">function</span><span class="w"> </span><span class="n">should</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="nc">NULL</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">plugin</span><span class="w"> </span><span class="n">does</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">support</span><span class="w"> </span><span class="n">credential</span><span class="w"> </span><span class="n">caching</span><span class="o">.</span><span class="w">

 </span><span class="n">init_session</span><span class="w">
       </span><span class="n">int</span><span class="w"> </span><span class="p" data-group-id="7867108359-134">(</span><span class="o">*</span><span class="n">init_session</span><span class="p" data-group-id="7867108359-134">)</span><span class="p" data-group-id="7867108359-135">(</span><span class="n">struct</span><span class="w"> </span><span class="n">passwd</span><span class="w"> </span><span class="o">*</span><span class="n">pwd</span><span class="p">,</span><span class="w"> </span><span class="n">char</span><span class="w"> </span><span class="o">*</span><span class="o">*</span><span class="n">user_env</span><span class="p" data-group-id="7867108359-136">[</span><span class="p" data-group-id="7867108359-136">]</span><span class="p">,</span><span class="w">
           </span><span class="n">const</span><span class="w"> </span><span class="n">char</span><span class="w"> </span><span class="o">*</span><span class="o">*</span><span class="n">errstr</span><span class="p" data-group-id="7867108359-135">)</span><span class="p">;</span><span class="w">

       </span><span class="nc">The</span><span class="w"> </span><span class="n">init_session</span><span class="p" data-group-id="7867108359-137">(</span><span class="p" data-group-id="7867108359-137">)</span><span class="w"> </span><span class="n">function</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">called</span><span class="w"> </span><span class="n">before</span><span class="w"> </span><span class="n">sudo</span><span class="w"> </span><span class="n">sets</span><span class="w"> </span><span class="n">up</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">execution</span><span class="w"> </span><span class="n">environment</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">command</span><span class="o">.</span><span class="w">  </span><span class="nc">It</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">run</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">parent</span><span class="w"> </span><span class="n">sudo</span><span class="w"> </span><span class="n">process</span><span class="w"> </span><span class="n">before</span><span class="w"> </span><span class="n">any</span><span class="w"> </span><span class="n">user</span><span class="o">-</span><span class="nc">ID</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">group</span><span class="o">-</span><span class="nc">ID</span><span class="w">
       </span><span class="n">changes</span><span class="o">.</span><span class="w">  </span><span class="nc">This</span><span class="w"> </span><span class="n">can</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">used</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">perform</span><span class="w"> </span><span class="n">session</span><span class="w"> </span><span class="n">setup</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">supported</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">command_info</span><span class="p">,</span><span class="w"> </span><span class="n">such</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="n">opening</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nc">PAM</span><span class="w"> </span><span class="n">session</span><span class="o">.</span><span class="w">  </span><span class="nc">The</span><span class="w"> </span><span class="n">close</span><span class="p" data-group-id="7867108359-138">(</span><span class="p" data-group-id="7867108359-138">)</span><span class="w"> </span><span class="n">function</span><span class="w"> </span><span class="n">can</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">used</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">tear</span><span class="w"> </span><span class="n">down</span><span class="w"> </span><span class="n">the</span><span class="w">
       </span><span class="n">session</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">was</span><span class="w"> </span><span class="n">opened</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">init_session</span><span class="p" data-group-id="7867108359-139">(</span><span class="p" data-group-id="7867108359-139">)</span><span class="o">.</span><span class="w">

       </span><span class="nc">Returns</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">success</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">failure</span><span class="p">,</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="o">-</span><span class="mi">1</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">error</span><span class="o">.</span><span class="w">  </span><span class="nc">On</span><span class="w"> </span><span class="n">error</span><span class="p">,</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">plugin</span><span class="w"> </span><span class="n">may</span><span class="w"> </span><span class="n">optionally</span><span class="w"> </span><span class="n">call</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">conversation</span><span class="p" data-group-id="7867108359-140">(</span><span class="p" data-group-id="7867108359-140">)</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">sudo_plugin_printf</span><span class="p" data-group-id="7867108359-141">(</span><span class="p" data-group-id="7867108359-141">)</span><span class="w"> </span><span class="n">function</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="nc">SUDO_CONF_ERROR_MSG</span><span class="w"> </span><span class="n">to</span><span class="w">
       </span><span class="n">present</span><span class="w"> </span><span class="n">additional</span><span class="w"> </span><span class="n">error</span><span class="w"> </span><span class="n">information</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">user</span><span class="o">.</span><span class="w">

       </span><span class="nc">The</span><span class="w"> </span><span class="n">function</span><span class="w"> </span><span class="n">arguments</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="ss">follows</span><span class="p">:</span><span class="w">

       </span><span class="n">pwd</span><span class="w">   </span><span class="nc">If</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">user</span><span class="o">-</span><span class="nc">ID</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">command</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">run</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="n">was</span><span class="w"> </span><span class="n">found</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">password</span><span class="w"> </span><span class="n">database</span><span class="p">,</span><span class="w"> </span><span class="n">pwd</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">describe</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">user</span><span class="p">,</span><span class="w"> </span><span class="n">otherwise</span><span class="w"> </span><span class="n">it</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="nc">NULL</span><span class="o">.</span><span class="w">

       </span><span class="n">user_env_out</span><span class="w">
             </span><span class="nc">The</span><span class="w"> </span><span class="nc">NULL</span><span class="o">-</span><span class="n">terminated</span><span class="w"> </span><span class="n">environment</span><span class="w"> </span><span class="n">vector</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="kn">use</span><span class="w"> </span><span class="ow">when</span><span class="w"> </span><span class="n">executing</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">command</span><span class="o">.</span><span class="w">  </span><span class="nc">This</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">same</span><span class="w"> </span><span class="n">string</span><span class="w"> </span><span class="n">passed</span><span class="w"> </span><span class="n">back</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">front</span><span class="o">-</span><span class="k" data-group-id="7867108359-129">end</span><span class="w"> </span><span class="n">via</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nc">Policy</span><span class="w"> </span><span class="nc">Plugin</span><span class="sc">&#39;s user_env_out pa‐
             rameter.  If the init_session() function needs to modify the user environment, it should update the pointer stored in user_env_out.  The expected use case is to merge
             the contents of the PAM environment (if any) with the contents of user_env_out.  The user_env_out parameter is only available starting with API version 1.2.  A plugin
             must check the API version specified by the sudo front-end before using user_env_out.  Failure to do so may result in a crash.

       errstr
             If the init_session() function returns a value other than 1, the plugin may store a message describing the failure or error in errstr.  The sudo front-end will then
             pass this value to any registered audit plugins.  The string stored in errstr must remain valid until the plugin&#39;</span><span class="n">s</span><span class="w"> </span><span class="n">close</span><span class="p" data-group-id="7867108359-142">(</span><span class="p" data-group-id="7867108359-142">)</span><span class="w"> </span><span class="n">function</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">called</span><span class="o">.</span><span class="w">

             </span><span class="nc">The</span><span class="w"> </span><span class="n">errstr</span><span class="w"> </span><span class="n">parameter</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">only</span><span class="w"> </span><span class="n">available</span><span class="w"> </span><span class="n">starting</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="nc">API</span><span class="w"> </span><span class="n">version</span><span class="w"> </span><span class="mf">1.15</span><span class="o">.</span><span class="w">  </span><span class="nc">A</span><span class="w"> </span><span class="n">plugin</span><span class="w"> </span><span class="n">must</span><span class="w"> </span><span class="n">check</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nc">API</span><span class="w"> </span><span class="n">version</span><span class="w"> </span><span class="n">specified</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">sudo</span><span class="w"> </span><span class="n">front</span><span class="o">-</span><span class="k">end</span><span class="w"> </span><span class="n">before</span><span class="w"> </span><span class="n">using</span><span class="w"> </span><span class="n">errstr</span><span class="o">.</span><span class="w">  </span><span class="nc">Fail</span><span class="err">‐</span><span class="w">
             </span><span class="n">ure</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="k" data-group-id="7867108359-143">do</span><span class="w"> </span><span class="n">so</span><span class="w"> </span><span class="n">may</span><span class="w"> </span><span class="n">result</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">crash</span><span class="o">.</span><span class="w">

 </span><span class="n">register_hooks</span><span class="w">
       </span><span class="n">void</span><span class="w"> </span><span class="p" data-group-id="7867108359-144">(</span><span class="o">*</span><span class="n">register_hooks</span><span class="p" data-group-id="7867108359-144">)</span><span class="p" data-group-id="7867108359-145">(</span><span class="n">int</span><span class="w"> </span><span class="n">version</span><span class="p">,</span><span class="w">
          </span><span class="n">int</span><span class="w"> </span><span class="p" data-group-id="7867108359-146">(</span><span class="o">*</span><span class="n">register_hook</span><span class="p" data-group-id="7867108359-146">)</span><span class="p" data-group-id="7867108359-147">(</span><span class="n">struct</span><span class="w"> </span><span class="n">sudo_hook</span><span class="w"> </span><span class="o">*</span><span class="n">hook</span><span class="p" data-group-id="7867108359-147">)</span><span class="p" data-group-id="7867108359-145">)</span><span class="p">;</span><span class="w">

       </span><span class="nc">The</span><span class="w"> </span><span class="n">register_hooks</span><span class="p" data-group-id="7867108359-148">(</span><span class="p" data-group-id="7867108359-148">)</span><span class="w"> </span><span class="n">function</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">called</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">sudo</span><span class="w"> </span><span class="n">front</span><span class="o">-</span><span class="k" data-group-id="7867108359-143">end</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">register</span><span class="w"> </span><span class="n">any</span><span class="w"> </span><span class="n">hooks</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">plugin</span><span class="w"> </span><span class="n">needs</span><span class="o">.</span><span class="w">  </span><span class="nc">If</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">plugin</span><span class="w"> </span><span class="n">does</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">support</span><span class="w"> </span><span class="n">hooks</span><span class="p">,</span><span class="w"> </span><span class="n">register_hooks</span><span class="w"> </span><span class="n">should</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">set</span><span class="w"> </span><span class="n">to</span><span class="w">
       </span><span class="n">the</span><span class="w"> </span><span class="nc">NULL</span><span class="w"> </span><span class="n">pointer</span><span class="o">.</span><span class="w">

       </span><span class="nc">The</span><span class="w"> </span><span class="n">version</span><span class="w"> </span><span class="n">argument</span><span class="w"> </span><span class="n">describes</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">version</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">hooks</span><span class="w"> </span><span class="nc">API</span><span class="w"> </span><span class="n">supported</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">sudo</span><span class="w"> </span><span class="n">front</span><span class="o">-</span><span class="k">end</span><span class="o">.</span><span class="w">

       </span><span class="nc">The</span><span class="w"> </span><span class="n">register_hook</span><span class="p" data-group-id="7867108359-149">(</span><span class="p" data-group-id="7867108359-149">)</span><span class="w"> </span><span class="n">function</span><span class="w"> </span><span class="n">should</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">used</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">register</span><span class="w"> </span><span class="n">any</span><span class="w"> </span><span class="n">supported</span><span class="w"> </span><span class="n">hooks</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">plugin</span><span class="w"> </span><span class="n">needs</span><span class="o">.</span><span class="w">  </span><span class="nc">It</span><span class="w"> </span><span class="n">returns</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">success</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">hook</span><span class="w"> </span><span class="n">type</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">supported</span><span class="p">,</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="o">-</span><span class="mi">1</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">ma</span><span class="err">‐</span><span class="w">
       </span><span class="n">jor</span><span class="w"> </span><span class="n">version</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">struct</span><span class="w"> </span><span class="n">sudo_hook</span><span class="w"> </span><span class="n">does</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">match</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">front</span><span class="o">-</span><span class="k">end</span><span class="sc">&#39;s major hook API version.

       See the Hook function API section below for more information about hooks.

       The register_hooks() function is only available starting with API version 1.2.  If the sudo front-end doesn&#39;</span><span class="n">t</span><span class="w"> </span><span class="n">support</span><span class="w"> </span><span class="nc">API</span><span class="w"> </span><span class="n">version</span><span class="w"> </span><span class="mf">1.2</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">higher</span><span class="p">,</span><span class="w"> </span><span class="n">register_hooks</span><span class="p" data-group-id="7867108359-150">(</span><span class="p" data-group-id="7867108359-150">)</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">be</span><span class="w">
       </span><span class="n">called</span><span class="o">.</span><span class="w">

 </span><span class="n">deregister_hooks</span><span class="w">
       </span><span class="n">void</span><span class="w"> </span><span class="p" data-group-id="7867108359-151">(</span><span class="o">*</span><span class="n">deregister_hooks</span><span class="p" data-group-id="7867108359-151">)</span><span class="p" data-group-id="7867108359-152">(</span><span class="n">int</span><span class="w"> </span><span class="n">version</span><span class="p">,</span><span class="w">
          </span><span class="n">int</span><span class="w"> </span><span class="p" data-group-id="7867108359-153">(</span><span class="o">*</span><span class="n">deregister_hook</span><span class="p" data-group-id="7867108359-153">)</span><span class="p" data-group-id="7867108359-154">(</span><span class="n">struct</span><span class="w"> </span><span class="n">sudo_hook</span><span class="w"> </span><span class="o">*</span><span class="n">hook</span><span class="p" data-group-id="7867108359-154">)</span><span class="p" data-group-id="7867108359-152">)</span><span class="p">;</span><span class="w">

       </span><span class="nc">The</span><span class="w"> </span><span class="n">deregister_hooks</span><span class="p" data-group-id="7867108359-155">(</span><span class="p" data-group-id="7867108359-155">)</span><span class="w"> </span><span class="n">function</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">called</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">sudo</span><span class="w"> </span><span class="n">front</span><span class="o">-</span><span class="k">end</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">deregister</span><span class="w"> </span><span class="n">any</span><span class="w"> </span><span class="n">hooks</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">plugin</span><span class="w"> </span><span class="n">has</span><span class="w"> </span><span class="n">registered</span><span class="o">.</span><span class="w">  </span><span class="nc">If</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">plugin</span><span class="w"> </span><span class="n">does</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">support</span><span class="w"> </span><span class="n">hooks</span><span class="p">,</span><span class="w"> </span><span class="n">deregister_hooks</span><span class="w">
       </span><span class="n">should</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">set</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nc">NULL</span><span class="w"> </span><span class="n">pointer</span><span class="o">.</span><span class="w">

       </span><span class="nc">The</span><span class="w"> </span><span class="n">version</span><span class="w"> </span><span class="n">argument</span><span class="w"> </span><span class="n">describes</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">version</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">hooks</span><span class="w"> </span><span class="nc">API</span><span class="w"> </span><span class="n">supported</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">sudo</span><span class="w"> </span><span class="n">front</span><span class="o">-</span><span class="k">end</span><span class="o">.</span><span class="w">

       </span><span class="nc">The</span><span class="w"> </span><span class="n">deregister_hook</span><span class="p" data-group-id="7867108359-156">(</span><span class="p" data-group-id="7867108359-156">)</span><span class="w"> </span><span class="n">function</span><span class="w"> </span><span class="n">should</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">used</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">deregister</span><span class="w"> </span><span class="n">any</span><span class="w"> </span><span class="n">hooks</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">were</span><span class="w"> </span><span class="n">put</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">place</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">register_hook</span><span class="p" data-group-id="7867108359-157">(</span><span class="p" data-group-id="7867108359-157">)</span><span class="w"> </span><span class="n">function</span><span class="o">.</span><span class="w">  </span><span class="nc">If</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">plugin</span><span class="w"> </span><span class="n">tries</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">deregister</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">hook</span><span class="w"> </span><span class="n">that</span><span class="w">
       </span><span class="n">the</span><span class="w"> </span><span class="n">front</span><span class="o">-</span><span class="k">end</span><span class="w"> </span><span class="n">does</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">support</span><span class="p">,</span><span class="w"> </span><span class="n">deregister_hook</span><span class="p" data-group-id="7867108359-158">(</span><span class="p" data-group-id="7867108359-158">)</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">return</span><span class="w"> </span><span class="n">an</span><span class="w"> </span><span class="n">error</span><span class="o">.</span><span class="w">

       </span><span class="nc">See</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nc">Hook</span><span class="w"> </span><span class="n">function</span><span class="w"> </span><span class="nc">API</span><span class="w"> </span><span class="n">section</span><span class="w"> </span><span class="n">below</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">more</span><span class="w"> </span><span class="n">information</span><span class="w"> </span><span class="n">about</span><span class="w"> </span><span class="n">hooks</span><span class="o">.</span><span class="w">

       </span><span class="nc">The</span><span class="w"> </span><span class="n">deregister_hooks</span><span class="p" data-group-id="7867108359-159">(</span><span class="p" data-group-id="7867108359-159">)</span><span class="w"> </span><span class="n">function</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">only</span><span class="w"> </span><span class="n">available</span><span class="w"> </span><span class="n">starting</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="nc">API</span><span class="w"> </span><span class="n">version</span><span class="w"> </span><span class="mf">1.2</span><span class="o">.</span><span class="w">  </span><span class="nc">If</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">sudo</span><span class="w"> </span><span class="n">front</span><span class="o">-</span><span class="k">end</span><span class="w"> </span><span class="n">doesn</span><span class="sc">&#39;t support API version 1.2 or higher, deregister_hooks() will not
       be called.

 event_alloc
       struct sudo_plugin_event * (*event_alloc)(void);

       The event_alloc() function is used to allocate a struct sudo_plugin_event which provides access to the main sudo event loop.  Unlike the other fields, the event_alloc pointer
       is filled in by the sudo front-end, not by the plugin.

       See the Event API section below for more information about events.

       The event_alloc() function is only available starting with API version 1.15.  If the sudo front-end doesn&#39;</span><span class="n">t</span><span class="w"> </span><span class="n">support</span><span class="w"> </span><span class="nc">API</span><span class="w"> </span><span class="n">version</span><span class="w"> </span><span class="mf">1.15</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">higher</span><span class="p">,</span><span class="w"> </span><span class="n">event_alloc</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">set</span><span class="o">.</span><span class="w">

 </span><span class="nc">Policy</span><span class="w"> </span><span class="nc">Plugin</span><span class="w"> </span><span class="nc">Version</span><span class="w"> </span><span class="nc">Macros</span><span class="w">

 </span><span class="o">/</span><span class="o">*</span><span class="w"> </span><span class="nc">Plugin</span><span class="w"> </span><span class="nc">API</span><span class="w"> </span><span class="n">version</span><span class="w"> </span><span class="n">major</span><span class="o">/</span><span class="n">minor</span><span class="o">.</span><span class="w"> </span><span class="o">*</span><span class="o">/</span><span class="w">
 </span><span class="c1">#define SUDO_API_VERSION_MAJOR 1</span><span class="w">
 </span><span class="c1">#define SUDO_API_VERSION_MINOR 13</span><span class="w">
 </span><span class="c1">#define SUDO_API_MKVERSION(x, y) ((x &lt;&lt; 16) | y)</span><span class="w">
 </span><span class="c1">#define SUDO_API_VERSION SUDO_API_MKVERSION(SUDO_API_VERSION_MAJOR,\</span><span class="w">
                                             </span><span class="nc">SUDO_API_VERSION_MINOR</span><span class="p">)</span><span class="w">

 </span><span class="o">/</span><span class="o">*</span><span class="w"> </span><span class="nc">Getters</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">setters</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="nc">API</span><span class="w"> </span><span class="n">version</span><span class="w"> </span><span class="o">*</span><span class="o">/</span><span class="w">
 </span><span class="c1">#define SUDO_API_VERSION_GET_MAJOR(v) ((v) &gt;&gt; 16)</span><span class="w">
 </span><span class="c1">#define SUDO_API_VERSION_GET_MINOR(v) ((v) &amp; 0xffff)</span><span class="w">
 </span><span class="c1">#define SUDO_API_VERSION_SET_MAJOR(vp, n) do { \</span><span class="w">
     </span><span class="o">*</span><span class="p" data-group-id="7867108359-160">(</span><span class="n">vp</span><span class="p" data-group-id="7867108359-160">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p" data-group-id="7867108359-161">(</span><span class="o">*</span><span class="p" data-group-id="7867108359-162">(</span><span class="n">vp</span><span class="p" data-group-id="7867108359-162">)</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="mh">0x0000ffff</span><span class="p" data-group-id="7867108359-161">)</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="p" data-group-id="7867108359-163">(</span><span class="p" data-group-id="7867108359-164">(</span><span class="n">n</span><span class="p" data-group-id="7867108359-164">)</span><span class="w"> </span><span class="p" data-group-id="7867108359-165">&lt;&lt;</span><span class="w"> </span><span class="mi">16</span><span class="p">)</span><span class="p">;</span><span class="w"> </span><span class="err">\</span><span class="w">
 </span><span class="err">}</span><span class="w"> </span><span class="n">while</span><span class="p" data-group-id="7867108359-166">(</span><span class="mi">0</span><span class="p" data-group-id="7867108359-166">)</span><span class="w">
 </span><span class="c1">#define SUDO_API_VERSION_SET_MINOR(vp, n) do { \</span><span class="w">
     </span><span class="o">*</span><span class="p" data-group-id="7867108359-167">(</span><span class="n">vp</span><span class="p" data-group-id="7867108359-167">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p" data-group-id="7867108359-168">(</span><span class="o">*</span><span class="p" data-group-id="7867108359-169">(</span><span class="n">vp</span><span class="p" data-group-id="7867108359-169">)</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="mh">0xffff0000</span><span class="p" data-group-id="7867108359-168">)</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="p" data-group-id="7867108359-170">(</span><span class="n">n</span><span class="p" data-group-id="7867108359-170">)</span><span class="p">;</span><span class="w"> </span><span class="err">\</span><span class="w">
 </span><span class="err">}</span><span class="w"> </span><span class="n">while</span><span class="p" data-group-id="7867108359-171">(</span><span class="mi">0</span><span class="p" data-group-id="7867108359-171">)</span></code></pre><p>   I/O plugin API</p><pre><code class="makeup elixir" translate="no"><span class="w"> </span><span class="n">struct</span><span class="w"> </span><span class="n">io_plugin</span><span class="w"> </span><span class="p" data-group-id="7384089649-1">{</span><span class="w">
 </span><span class="c1">#define SUDO_IO_PLUGIN 2</span><span class="w">
     </span><span class="n">unsigned</span><span class="w"> </span><span class="n">int</span><span class="w"> </span><span class="n">type</span><span class="p">;</span><span class="w"> </span><span class="o">/</span><span class="o">*</span><span class="w"> </span><span class="n">always</span><span class="w"> </span><span class="nc">SUDO_IO_PLUGIN</span><span class="w"> </span><span class="o">*</span><span class="o">/</span><span class="w">
     </span><span class="n">unsigned</span><span class="w"> </span><span class="n">int</span><span class="w"> </span><span class="n">version</span><span class="p">;</span><span class="w"> </span><span class="o">/</span><span class="o">*</span><span class="w"> </span><span class="n">always</span><span class="w"> </span><span class="nc">SUDO_API_VERSION</span><span class="w"> </span><span class="o">*</span><span class="o">/</span><span class="w">
     </span><span class="n">int</span><span class="w"> </span><span class="p" data-group-id="7384089649-2">(</span><span class="o">*</span><span class="n">open</span><span class="p" data-group-id="7384089649-2">)</span><span class="p" data-group-id="7384089649-3">(</span><span class="n">unsigned</span><span class="w"> </span><span class="n">int</span><span class="w"> </span><span class="n">version</span><span class="p">,</span><span class="w"> </span><span class="n">sudo_conv_t</span><span class="w"> </span><span class="n">conversation</span><span class="p">,</span><span class="w">
         </span><span class="n">sudo_printf_t</span><span class="w"> </span><span class="n">sudo_plugin_printf</span><span class="p">,</span><span class="w"> </span><span class="n">char</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">const</span><span class="w"> </span><span class="n">settings</span><span class="p" data-group-id="7384089649-4">[</span><span class="p" data-group-id="7384089649-4">]</span><span class="p">,</span><span class="w">
         </span><span class="n">char</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">const</span><span class="w"> </span><span class="n">user_info</span><span class="p" data-group-id="7384089649-5">[</span><span class="p" data-group-id="7384089649-5">]</span><span class="p">,</span><span class="w"> </span><span class="n">char</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">const</span><span class="w"> </span><span class="n">command_info</span><span class="p" data-group-id="7384089649-6">[</span><span class="p" data-group-id="7384089649-6">]</span><span class="p">,</span><span class="w">
         </span><span class="n">int</span><span class="w"> </span><span class="n">argc</span><span class="p">,</span><span class="w"> </span><span class="n">char</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">const</span><span class="w"> </span><span class="n">argv</span><span class="p" data-group-id="7384089649-7">[</span><span class="p" data-group-id="7384089649-7">]</span><span class="p">,</span><span class="w"> </span><span class="n">char</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">const</span><span class="w"> </span><span class="n">user_env</span><span class="p" data-group-id="7384089649-8">[</span><span class="p" data-group-id="7384089649-8">]</span><span class="p">,</span><span class="w">
         </span><span class="n">char</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">const</span><span class="w"> </span><span class="n">plugin_options</span><span class="p" data-group-id="7384089649-9">[</span><span class="p" data-group-id="7384089649-9">]</span><span class="p">,</span><span class="w"> </span><span class="n">const</span><span class="w"> </span><span class="n">char</span><span class="w"> </span><span class="o">*</span><span class="o">*</span><span class="n">errstr</span><span class="p" data-group-id="7384089649-3">)</span><span class="p">;</span><span class="w">
     </span><span class="n">void</span><span class="w"> </span><span class="p" data-group-id="7384089649-10">(</span><span class="o">*</span><span class="n">close</span><span class="p" data-group-id="7384089649-10">)</span><span class="p" data-group-id="7384089649-11">(</span><span class="n">int</span><span class="w"> </span><span class="n">exit_status</span><span class="p">,</span><span class="w"> </span><span class="n">int</span><span class="w"> </span><span class="n">error</span><span class="p" data-group-id="7384089649-11">)</span><span class="p">;</span><span class="w"> </span><span class="o">/</span><span class="o">*</span><span class="w"> </span><span class="n">wait</span><span class="w"> </span><span class="n">status</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">error</span><span class="w"> </span><span class="o">*</span><span class="o">/</span><span class="w">
     </span><span class="n">int</span><span class="w"> </span><span class="p" data-group-id="7384089649-12">(</span><span class="o">*</span><span class="n">show_version</span><span class="p" data-group-id="7384089649-12">)</span><span class="p" data-group-id="7384089649-13">(</span><span class="n">int</span><span class="w"> </span><span class="n">verbose</span><span class="p" data-group-id="7384089649-13">)</span><span class="p">;</span><span class="w">
     </span><span class="n">int</span><span class="w"> </span><span class="p" data-group-id="7384089649-14">(</span><span class="o">*</span><span class="n">log_ttyin</span><span class="p" data-group-id="7384089649-14">)</span><span class="p" data-group-id="7384089649-15">(</span><span class="n">const</span><span class="w"> </span><span class="n">char</span><span class="w"> </span><span class="o">*</span><span class="n">buf</span><span class="p">,</span><span class="w"> </span><span class="n">unsigned</span><span class="w"> </span><span class="n">int</span><span class="w"> </span><span class="n">len</span><span class="p">,</span><span class="w">
         </span><span class="n">const</span><span class="w"> </span><span class="n">char</span><span class="w"> </span><span class="o">*</span><span class="o">*</span><span class="n">errstr</span><span class="p" data-group-id="7384089649-15">)</span><span class="p">;</span><span class="w">
     </span><span class="n">int</span><span class="w"> </span><span class="p" data-group-id="7384089649-16">(</span><span class="o">*</span><span class="n">log_ttyout</span><span class="p" data-group-id="7384089649-16">)</span><span class="p" data-group-id="7384089649-17">(</span><span class="n">const</span><span class="w"> </span><span class="n">char</span><span class="w"> </span><span class="o">*</span><span class="n">buf</span><span class="p">,</span><span class="w"> </span><span class="n">unsigned</span><span class="w"> </span><span class="n">int</span><span class="w"> </span><span class="n">len</span><span class="p">,</span><span class="w">
         </span><span class="n">const</span><span class="w"> </span><span class="n">char</span><span class="w"> </span><span class="o">*</span><span class="o">*</span><span class="n">errstr</span><span class="p" data-group-id="7384089649-17">)</span><span class="p">;</span><span class="w">
     </span><span class="n">int</span><span class="w"> </span><span class="p" data-group-id="7384089649-18">(</span><span class="o">*</span><span class="n">log_stdin</span><span class="p" data-group-id="7384089649-18">)</span><span class="p" data-group-id="7384089649-19">(</span><span class="n">const</span><span class="w"> </span><span class="n">char</span><span class="w"> </span><span class="o">*</span><span class="n">buf</span><span class="p">,</span><span class="w"> </span><span class="n">unsigned</span><span class="w"> </span><span class="n">int</span><span class="w"> </span><span class="n">len</span><span class="p">,</span><span class="w">
         </span><span class="n">const</span><span class="w"> </span><span class="n">char</span><span class="w"> </span><span class="o">*</span><span class="o">*</span><span class="n">errstr</span><span class="p" data-group-id="7384089649-19">)</span><span class="p">;</span><span class="w">
     </span><span class="n">int</span><span class="w"> </span><span class="p" data-group-id="7384089649-20">(</span><span class="o">*</span><span class="n">log_stdout</span><span class="p" data-group-id="7384089649-20">)</span><span class="p" data-group-id="7384089649-21">(</span><span class="n">const</span><span class="w"> </span><span class="n">char</span><span class="w"> </span><span class="o">*</span><span class="n">buf</span><span class="p">,</span><span class="w"> </span><span class="n">unsigned</span><span class="w"> </span><span class="n">int</span><span class="w"> </span><span class="n">len</span><span class="p">,</span><span class="w">
         </span><span class="n">const</span><span class="w"> </span><span class="n">char</span><span class="w"> </span><span class="o">*</span><span class="o">*</span><span class="n">errstr</span><span class="p" data-group-id="7384089649-21">)</span><span class="p">;</span><span class="w">
     </span><span class="n">int</span><span class="w"> </span><span class="p" data-group-id="7384089649-22">(</span><span class="o">*</span><span class="n">log_stderr</span><span class="p" data-group-id="7384089649-22">)</span><span class="p" data-group-id="7384089649-23">(</span><span class="n">const</span><span class="w"> </span><span class="n">char</span><span class="w"> </span><span class="o">*</span><span class="n">buf</span><span class="p">,</span><span class="w"> </span><span class="n">unsigned</span><span class="w"> </span><span class="n">int</span><span class="w"> </span><span class="n">len</span><span class="p">,</span><span class="w">
         </span><span class="n">const</span><span class="w"> </span><span class="n">char</span><span class="w"> </span><span class="o">*</span><span class="o">*</span><span class="n">errstr</span><span class="p" data-group-id="7384089649-23">)</span><span class="p">;</span><span class="w">
     </span><span class="n">void</span><span class="w"> </span><span class="p" data-group-id="7384089649-24">(</span><span class="o">*</span><span class="n">register_hooks</span><span class="p" data-group-id="7384089649-24">)</span><span class="p" data-group-id="7384089649-25">(</span><span class="n">int</span><span class="w"> </span><span class="n">version</span><span class="p">,</span><span class="w">
        </span><span class="n">int</span><span class="w"> </span><span class="p" data-group-id="7384089649-26">(</span><span class="o">*</span><span class="n">register_hook</span><span class="p" data-group-id="7384089649-26">)</span><span class="p" data-group-id="7384089649-27">(</span><span class="n">struct</span><span class="w"> </span><span class="n">sudo_hook</span><span class="w"> </span><span class="o">*</span><span class="n">hook</span><span class="p" data-group-id="7384089649-27">)</span><span class="p" data-group-id="7384089649-25">)</span><span class="p">;</span><span class="w">
     </span><span class="n">void</span><span class="w"> </span><span class="p" data-group-id="7384089649-28">(</span><span class="o">*</span><span class="n">deregister_hooks</span><span class="p" data-group-id="7384089649-28">)</span><span class="p" data-group-id="7384089649-29">(</span><span class="n">int</span><span class="w"> </span><span class="n">version</span><span class="p">,</span><span class="w">
        </span><span class="n">int</span><span class="w"> </span><span class="p" data-group-id="7384089649-30">(</span><span class="o">*</span><span class="n">deregister_hook</span><span class="p" data-group-id="7384089649-30">)</span><span class="p" data-group-id="7384089649-31">(</span><span class="n">struct</span><span class="w"> </span><span class="n">sudo_hook</span><span class="w"> </span><span class="o">*</span><span class="n">hook</span><span class="p" data-group-id="7384089649-31">)</span><span class="p" data-group-id="7384089649-29">)</span><span class="p">;</span><span class="w">
     </span><span class="n">int</span><span class="w"> </span><span class="p" data-group-id="7384089649-32">(</span><span class="o">*</span><span class="n">change_winsize</span><span class="p" data-group-id="7384089649-32">)</span><span class="p" data-group-id="7384089649-33">(</span><span class="n">unsigned</span><span class="w"> </span><span class="n">int</span><span class="w"> </span><span class="n">lines</span><span class="p">,</span><span class="w"> </span><span class="n">unsigned</span><span class="w"> </span><span class="n">int</span><span class="w"> </span><span class="n">cols</span><span class="p">,</span><span class="w">
         </span><span class="n">const</span><span class="w"> </span><span class="n">char</span><span class="w"> </span><span class="o">*</span><span class="o">*</span><span class="n">errstr</span><span class="p" data-group-id="7384089649-33">)</span><span class="p">;</span><span class="w">
     </span><span class="n">int</span><span class="w"> </span><span class="p" data-group-id="7384089649-34">(</span><span class="o">*</span><span class="n">log_suspend</span><span class="p" data-group-id="7384089649-34">)</span><span class="p" data-group-id="7384089649-35">(</span><span class="n">int</span><span class="w"> </span><span class="n">signo</span><span class="p">,</span><span class="w"> </span><span class="n">const</span><span class="w"> </span><span class="n">char</span><span class="w"> </span><span class="o">*</span><span class="o">*</span><span class="n">errstr</span><span class="p" data-group-id="7384089649-35">)</span><span class="p">;</span><span class="w">
     </span><span class="n">struct</span><span class="w"> </span><span class="n">sudo_plugin_event</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p" data-group-id="7384089649-36">(</span><span class="o">*</span><span class="n">event_alloc</span><span class="p" data-group-id="7384089649-36">)</span><span class="p" data-group-id="7384089649-37">(</span><span class="n">void</span><span class="p" data-group-id="7384089649-37">)</span><span class="p">;</span><span class="w">
 </span><span class="p" data-group-id="7384089649-1">}</span><span class="p">;</span><span class="w">

 </span><span class="nc">When</span><span class="w"> </span><span class="n">an</span><span class="w"> </span><span class="nc">I</span><span class="o">/</span><span class="nc">O</span><span class="w"> </span><span class="n">plugin</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">loaded</span><span class="p">,</span><span class="w"> </span><span class="n">sudo</span><span class="w"> </span><span class="n">runs</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">command</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">pseudo</span><span class="o">-</span><span class="n">terminal</span><span class="o">.</span><span class="w">  </span><span class="nc">This</span><span class="w"> </span><span class="n">makes</span><span class="w"> </span><span class="n">it</span><span class="w"> </span><span class="n">possible</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">log</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">input</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">output</span><span class="w"> </span><span class="n">from</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">user</span><span class="sc">&#39;s session.  If any of the standard in‐
 put, standard output, or standard error do not correspond to a tty, sudo will open a pipe to capture the I/O for logging before passing it on.

 The log_ttyin() function receives the raw user input from the terminal device (this will include input even when echo is disabled, such as when a password is read).  The
 log_ttyout() function receives output from the pseudo-terminal that is suitable for replaying the user&#39;</span><span class="n">s</span><span class="w"> </span><span class="n">session</span><span class="w"> </span><span class="n">at</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">later</span><span class="w"> </span><span class="n">time</span><span class="o">.</span><span class="w">  </span><span class="nc">The</span><span class="w"> </span><span class="n">log_stdin</span><span class="p" data-group-id="7384089649-38">(</span><span class="p" data-group-id="7384089649-38">)</span><span class="p">,</span><span class="w"> </span><span class="n">log_stdout</span><span class="p" data-group-id="7384089649-39">(</span><span class="p" data-group-id="7384089649-39">)</span><span class="p">,</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">log_stderr</span><span class="p" data-group-id="7384089649-40">(</span><span class="p" data-group-id="7384089649-40">)</span><span class="w">
 </span><span class="n">functions</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">only</span><span class="w"> </span><span class="n">called</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">standard</span><span class="w"> </span><span class="n">input</span><span class="p">,</span><span class="w"> </span><span class="n">standard</span><span class="w"> </span><span class="n">output</span><span class="p">,</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">standard</span><span class="w"> </span><span class="n">error</span><span class="w"> </span><span class="n">respectively</span><span class="w"> </span><span class="n">correspond</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">something</span><span class="w"> </span><span class="n">other</span><span class="w"> </span><span class="n">than</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">tty</span><span class="o">.</span><span class="w">

 </span><span class="nc">Any</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">logging</span><span class="w"> </span><span class="n">functions</span><span class="w"> </span><span class="n">may</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">set</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nc">NULL</span><span class="w"> </span><span class="n">pointer</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">no</span><span class="w"> </span><span class="n">logging</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">performed</span><span class="o">.</span><span class="w">  </span><span class="nc">If</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">open</span><span class="w"> </span><span class="n">function</span><span class="w"> </span><span class="n">returns</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">no</span><span class="w"> </span><span class="nc">I</span><span class="o">/</span><span class="nc">O</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">sent</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">plugin</span><span class="o">.</span><span class="w">

 </span><span class="nc">If</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">logging</span><span class="w"> </span><span class="n">function</span><span class="w"> </span><span class="n">returns</span><span class="w"> </span><span class="n">an</span><span class="w"> </span><span class="n">error</span><span class="w"> </span><span class="p" data-group-id="7384089649-41">(</span><span class="o">-</span><span class="mi">1</span><span class="p" data-group-id="7384089649-41">)</span><span class="p">,</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">running</span><span class="w"> </span><span class="n">command</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">terminated</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">all</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">plugin</span><span class="sc">&#39;s logging functions will be disabled.  Other I/O logging plugins will
 still receive any remaining input or output that has not yet been processed.

 If an input logging function rejects the data by returning 0, the command will be terminated and the data will not be passed to the command, though it will still be sent to any
 other I/O logging plugins.  If an output logging function rejects the data by returning 0, the command will be terminated and the data will not be written to the terminal, though
 it will still be sent to any other I/O logging plugins.

 A struct audit_plugin has the following fields:

 type  The type field should always be set to SUDO_IO_PLUGIN.

 version
       The version field should be set to SUDO_API_VERSION.

       This allows sudo to determine the API version the plugin was built against.

 open
       int (*open)(unsigned int version, sudo_conv_t conversation,
           sudo_printf_t sudo_plugin_printf, char * const settings[],
           char * const user_info[], char * const command_info[],
           int argc, char * const argv[], char * const user_env[],
           char * const plugin_options[]);

       The open() function is run before the log_ttyin(), log_ttyout(), log_stdin(), log_stdout(), log_stderr(), log_suspend(), change_winsize(), or show_version() functions are
       called.  It is only called if the version is being requested or if the policy plugin&#39;</span><span class="n">s</span><span class="w"> </span><span class="n">check_policy</span><span class="p" data-group-id="7384089649-42">(</span><span class="p" data-group-id="7384089649-42">)</span><span class="w"> </span><span class="n">function</span><span class="w"> </span><span class="n">has</span><span class="w"> </span><span class="n">returned</span><span class="w"> </span><span class="n">successfully</span><span class="o">.</span><span class="w">  </span><span class="nc">It</span><span class="w"> </span><span class="n">returns</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">success</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">fail</span><span class="err">‐</span><span class="w">
       </span><span class="n">ure</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mi">1</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">general</span><span class="w"> </span><span class="n">error</span><span class="w"> </span><span class="n">occurred</span><span class="p">,</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="o">-</span><span class="mi">2</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">there</span><span class="w"> </span><span class="n">was</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">usage</span><span class="w"> </span><span class="n">error</span><span class="o">.</span><span class="w">  </span><span class="nc">In</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">latter</span><span class="w"> </span><span class="k">case</span><span class="p">,</span><span class="w"> </span><span class="n">sudo</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">print</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">usage</span><span class="w"> </span><span class="n">message</span><span class="w"> </span><span class="n">before</span><span class="w"> </span><span class="n">it</span><span class="w"> </span><span class="n">exits</span><span class="o">.</span><span class="w">  </span><span class="nc">If</span><span class="w"> </span><span class="n">an</span><span class="w"> </span><span class="n">error</span><span class="w"> </span><span class="n">occurs</span><span class="p">,</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">plugin</span><span class="w">
       </span><span class="n">may</span><span class="w"> </span><span class="n">optionally</span><span class="w"> </span><span class="n">call</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">conversation</span><span class="p" data-group-id="7384089649-43">(</span><span class="p" data-group-id="7384089649-43">)</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">sudo_plugin_printf</span><span class="p" data-group-id="7384089649-44">(</span><span class="p" data-group-id="7384089649-44">)</span><span class="w"> </span><span class="n">function</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="nc">SUDO_CONF_ERROR_MSG</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">present</span><span class="w"> </span><span class="n">additional</span><span class="w"> </span><span class="n">error</span><span class="w"> </span><span class="n">information</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">user</span><span class="o">.</span><span class="w">

       </span><span class="nc">The</span><span class="w"> </span><span class="n">function</span><span class="w"> </span><span class="n">arguments</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="ss">follows</span><span class="p">:</span><span class="w">

       </span><span class="n">version</span><span class="w">
             </span><span class="nc">The</span><span class="w"> </span><span class="n">version</span><span class="w"> </span><span class="n">passed</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">sudo</span><span class="w"> </span><span class="n">allows</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">plugin</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">determine</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">major</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">minor</span><span class="w"> </span><span class="n">version</span><span class="w"> </span><span class="n">number</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">plugin</span><span class="w"> </span><span class="nc">API</span><span class="w"> </span><span class="n">supported</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">sudo</span><span class="o">.</span><span class="w">

       </span><span class="n">conversation</span><span class="w">
             </span><span class="nc">A</span><span class="w"> </span><span class="n">pointer</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">conversation</span><span class="p" data-group-id="7384089649-45">(</span><span class="p" data-group-id="7384089649-45">)</span><span class="w"> </span><span class="n">function</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">may</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">used</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nc">Fa</span><span class="p" data-group-id="7384089649-46">(</span><span class="n">show_version</span><span class="p" data-group-id="7384089649-46">)</span><span class="w"> </span><span class="n">function</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">display</span><span class="w"> </span><span class="n">version</span><span class="w"> </span><span class="n">information</span><span class="w"> </span><span class="p" data-group-id="7384089649-47">(</span><span class="n">see</span><span class="w"> </span><span class="n">show_version</span><span class="p" data-group-id="7384089649-48">(</span><span class="p" data-group-id="7384089649-48">)</span><span class="w"> </span><span class="n">below</span><span class="p" data-group-id="7384089649-47">)</span><span class="o">.</span><span class="w">  </span><span class="nc">The</span><span class="w">
             </span><span class="n">conversation</span><span class="p" data-group-id="7384089649-49">(</span><span class="p" data-group-id="7384089649-49">)</span><span class="w"> </span><span class="n">function</span><span class="w"> </span><span class="n">may</span><span class="w"> </span><span class="n">also</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">used</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">display</span><span class="w"> </span><span class="n">additional</span><span class="w"> </span><span class="n">error</span><span class="w"> </span><span class="n">message</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">user</span><span class="o">.</span><span class="w">  </span><span class="nc">The</span><span class="w"> </span><span class="n">conversation</span><span class="p" data-group-id="7384089649-50">(</span><span class="p" data-group-id="7384089649-50">)</span><span class="w"> </span><span class="n">function</span><span class="w"> </span><span class="n">returns</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">success</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="o">-</span><span class="mi">1</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">failure</span><span class="o">.</span><span class="w">

       </span><span class="n">sudo_plugin_printf</span><span class="w">
             </span><span class="nc">A</span><span class="w"> </span><span class="n">pointer</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">printf</span><span class="p" data-group-id="7384089649-51">(</span><span class="p" data-group-id="7384089649-51">)</span><span class="o">-</span><span class="n">style</span><span class="w"> </span><span class="n">function</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">may</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">used</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">show_version</span><span class="p" data-group-id="7384089649-52">(</span><span class="p" data-group-id="7384089649-52">)</span><span class="w"> </span><span class="n">function</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">display</span><span class="w"> </span><span class="n">version</span><span class="w"> </span><span class="n">information</span><span class="w"> </span><span class="p" data-group-id="7384089649-53">(</span><span class="n">see</span><span class="w"> </span><span class="n">show_version</span><span class="w"> </span><span class="n">below</span><span class="p" data-group-id="7384089649-53">)</span><span class="o">.</span><span class="w">  </span><span class="nc">The</span><span class="w">
             </span><span class="n">sudo_plugin_printf</span><span class="p" data-group-id="7384089649-54">(</span><span class="p" data-group-id="7384089649-54">)</span><span class="w"> </span><span class="n">function</span><span class="w"> </span><span class="n">may</span><span class="w"> </span><span class="n">also</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">used</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">display</span><span class="w"> </span><span class="n">additional</span><span class="w"> </span><span class="n">error</span><span class="w"> </span><span class="n">message</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">user</span><span class="o">.</span><span class="w">  </span><span class="nc">The</span><span class="w"> </span><span class="n">sudo_plugin_printf</span><span class="p" data-group-id="7384089649-55">(</span><span class="p" data-group-id="7384089649-55">)</span><span class="w"> </span><span class="n">function</span><span class="w"> </span><span class="n">returns</span><span class="w"> </span><span class="n">number</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">characters</span><span class="w"> </span><span class="n">printed</span><span class="w">
             </span><span class="n">on</span><span class="w"> </span><span class="n">success</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="o">-</span><span class="mi">1</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">failure</span><span class="o">.</span><span class="w">

       </span><span class="n">settings</span><span class="w">
             </span><span class="nc">A</span><span class="w"> </span><span class="n">vector</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">user</span><span class="o">-</span><span class="n">supplied</span><span class="w"> </span><span class="n">sudo</span><span class="w"> </span><span class="n">settings</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">form</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="err">“</span><span class="n">name</span><span class="o">=</span><span class="n">value</span><span class="err">”</span><span class="w"> </span><span class="n">strings</span><span class="o">.</span><span class="w">  </span><span class="nc">The</span><span class="w"> </span><span class="n">vector</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">terminated</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="nc">NULL</span><span class="w"> </span><span class="n">pointer</span><span class="o">.</span><span class="w">  </span><span class="nc">These</span><span class="w"> </span><span class="n">settings</span><span class="w"> </span><span class="n">correspond</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">options</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">user</span><span class="w">
             </span><span class="n">specified</span><span class="w"> </span><span class="ow">when</span><span class="w"> </span><span class="n">running</span><span class="w"> </span><span class="n">sudo</span><span class="o">.</span><span class="w">  </span><span class="nc">As</span><span class="w"> </span><span class="n">such</span><span class="p">,</span><span class="w"> </span><span class="n">they</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">only</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">present</span><span class="w"> </span><span class="ow">when</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">corresponding</span><span class="w"> </span><span class="n">option</span><span class="w"> </span><span class="n">has</span><span class="w"> </span><span class="n">been</span><span class="w"> </span><span class="n">specified</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">command</span><span class="w"> </span><span class="n">line</span><span class="o">.</span><span class="w">

             </span><span class="nc">When</span><span class="w"> </span><span class="n">parsing</span><span class="w"> </span><span class="n">settings</span><span class="p">,</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">plugin</span><span class="w"> </span><span class="n">should</span><span class="w"> </span><span class="n">split</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">first</span><span class="w"> </span><span class="n">equal</span><span class="w"> </span><span class="n">sign</span><span class="w"> </span><span class="p" data-group-id="7384089649-56">(</span><span class="err">‘</span><span class="o">=</span><span class="err">’</span><span class="p" data-group-id="7384089649-56">)</span><span class="w"> </span><span class="n">since</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="n">field</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">never</span><span class="w"> </span><span class="n">include</span><span class="w"> </span><span class="n">one</span><span class="w"> </span><span class="n">itself</span><span class="w"> </span><span class="n">but</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">value</span><span class="w"> </span><span class="n">might</span><span class="o">.</span><span class="w">

             </span><span class="nc">See</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nc">Policy</span><span class="w"> </span><span class="n">plugin</span><span class="w"> </span><span class="nc">API</span><span class="w"> </span><span class="n">section</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">list</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">all</span><span class="w"> </span><span class="n">possible</span><span class="w"> </span><span class="n">settings</span><span class="o">.</span><span class="w">

       </span><span class="n">user_info</span><span class="w">
             </span><span class="nc">A</span><span class="w"> </span><span class="n">vector</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">information</span><span class="w"> </span><span class="n">about</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">user</span><span class="w"> </span><span class="n">running</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">command</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">form</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="err">“</span><span class="n">name</span><span class="o">=</span><span class="n">value</span><span class="err">”</span><span class="w"> </span><span class="n">strings</span><span class="o">.</span><span class="w">  </span><span class="nc">The</span><span class="w"> </span><span class="n">vector</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">terminated</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="nc">NULL</span><span class="w"> </span><span class="n">pointer</span><span class="o">.</span><span class="w">

             </span><span class="nc">When</span><span class="w"> </span><span class="n">parsing</span><span class="w"> </span><span class="n">user_info</span><span class="p">,</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">plugin</span><span class="w"> </span><span class="n">should</span><span class="w"> </span><span class="n">split</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">first</span><span class="w"> </span><span class="n">equal</span><span class="w"> </span><span class="n">sign</span><span class="w"> </span><span class="p" data-group-id="7384089649-57">(</span><span class="err">‘</span><span class="o">=</span><span class="err">’</span><span class="p" data-group-id="7384089649-57">)</span><span class="w"> </span><span class="n">since</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="n">field</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">never</span><span class="w"> </span><span class="n">include</span><span class="w"> </span><span class="n">one</span><span class="w"> </span><span class="n">itself</span><span class="w"> </span><span class="n">but</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">value</span><span class="w"> </span><span class="n">might</span><span class="o">.</span><span class="w">

             </span><span class="nc">See</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nc">Policy</span><span class="w"> </span><span class="n">plugin</span><span class="w"> </span><span class="nc">API</span><span class="w"> </span><span class="n">section</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">list</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">all</span><span class="w"> </span><span class="n">possible</span><span class="w"> </span><span class="n">strings</span><span class="o">.</span><span class="w">

       </span><span class="n">command_info</span><span class="w">
             </span><span class="nc">A</span><span class="w"> </span><span class="n">vector</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">information</span><span class="w"> </span><span class="n">describing</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">command</span><span class="w"> </span><span class="n">being</span><span class="w"> </span><span class="n">run</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">form</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="err">“</span><span class="n">name</span><span class="o">=</span><span class="n">value</span><span class="err">”</span><span class="w"> </span><span class="n">strings</span><span class="o">.</span><span class="w">  </span><span class="nc">The</span><span class="w"> </span><span class="n">vector</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">terminated</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="nc">NULL</span><span class="w"> </span><span class="n">pointer</span><span class="o">.</span><span class="w">

             </span><span class="nc">When</span><span class="w"> </span><span class="n">parsing</span><span class="w"> </span><span class="n">command_info</span><span class="p">,</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">plugin</span><span class="w"> </span><span class="n">should</span><span class="w"> </span><span class="n">split</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">first</span><span class="w"> </span><span class="n">equal</span><span class="w"> </span><span class="n">sign</span><span class="w"> </span><span class="p" data-group-id="7384089649-58">(</span><span class="err">‘</span><span class="o">=</span><span class="err">’</span><span class="p" data-group-id="7384089649-58">)</span><span class="w"> </span><span class="n">since</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="n">field</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">never</span><span class="w"> </span><span class="n">include</span><span class="w"> </span><span class="n">one</span><span class="w"> </span><span class="n">itself</span><span class="w"> </span><span class="n">but</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">value</span><span class="w"> </span><span class="n">might</span><span class="o">.</span><span class="w">

             </span><span class="nc">See</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nc">Policy</span><span class="w"> </span><span class="n">plugin</span><span class="w"> </span><span class="nc">API</span><span class="w"> </span><span class="n">section</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">list</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">all</span><span class="w"> </span><span class="n">possible</span><span class="w"> </span><span class="n">strings</span><span class="o">.</span><span class="w">

       </span><span class="n">argc</span><span class="w">  </span><span class="nc">The</span><span class="w"> </span><span class="n">number</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">elements</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">argv</span><span class="p">,</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">counting</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">final</span><span class="w"> </span><span class="nc">NULL</span><span class="w"> </span><span class="n">pointer</span><span class="o">.</span><span class="w">  </span><span class="nc">It</span><span class="w"> </span><span class="n">can</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">zero</span><span class="p">,</span><span class="w"> </span><span class="n">such</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="ow">when</span><span class="w"> </span><span class="n">sudo</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">called</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="o">-</span><span class="nc">V</span><span class="w"> </span><span class="n">option</span><span class="o">.</span><span class="w">

       </span><span class="n">argv</span><span class="w">  </span><span class="nc">If</span><span class="w"> </span><span class="n">non</span><span class="o">-</span><span class="nc">NULL</span><span class="p">,</span><span class="w"> </span><span class="n">an</span><span class="w"> </span><span class="n">argument</span><span class="w"> </span><span class="n">vector</span><span class="w"> </span><span class="n">describing</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">command</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">user</span><span class="w"> </span><span class="n">wishes</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">run</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">same</span><span class="w"> </span><span class="n">form</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="n">what</span><span class="w"> </span><span class="n">would</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">passed</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">execve</span><span class="p" data-group-id="7384089649-59">(</span><span class="mi">2</span><span class="p" data-group-id="7384089649-59">)</span><span class="w"> </span><span class="n">system</span><span class="w"> </span><span class="n">call</span><span class="o">.</span><span class="w">

       </span><span class="n">user_env</span><span class="w">
             </span><span class="nc">The</span><span class="w"> </span><span class="n">user</span><span class="sc">&#39;s environment in the form of a NULL-terminated vector of “name=value” strings.

             When parsing user_env, the plugin should split on the first equal sign (‘=’) since the name field will never include one itself but the value might.

       plugin_options
             Any (non-comment) strings immediately after the plugin path are treated as arguments to the plugin.  These arguments are split on a white space boundary and are passed
             to the plugin in the form of a NULL-terminated array of strings.  If no arguments were specified, plugin_options will be the NULL pointer.

             The plugin_options parameter is only available starting with API version 1.2.  A plugin must check the API version specified by the sudo front-end before using
             plugin_options.  Failure to do so may result in a crash.

       errstr
             If the open() function returns a value other than 1, the plugin may store a message describing the failure or error in errstr.  The sudo front-end will then pass this
             value to any registered audit plugins.  The string stored in errstr must remain valid until the plugin&#39;</span><span class="n">s</span><span class="w"> </span><span class="n">close</span><span class="p" data-group-id="7384089649-60">(</span><span class="p" data-group-id="7384089649-60">)</span><span class="w"> </span><span class="n">function</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">called</span><span class="o">.</span><span class="w">

             </span><span class="nc">The</span><span class="w"> </span><span class="n">errstr</span><span class="w"> </span><span class="n">parameter</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">only</span><span class="w"> </span><span class="n">available</span><span class="w"> </span><span class="n">starting</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="nc">API</span><span class="w"> </span><span class="n">version</span><span class="w"> </span><span class="mf">1.15</span><span class="o">.</span><span class="w">  </span><span class="nc">A</span><span class="w"> </span><span class="n">plugin</span><span class="w"> </span><span class="n">must</span><span class="w"> </span><span class="n">check</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nc">API</span><span class="w"> </span><span class="n">version</span><span class="w"> </span><span class="n">specified</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">sudo</span><span class="w"> </span><span class="n">front</span><span class="o">-</span><span class="k">end</span><span class="w"> </span><span class="n">before</span><span class="w"> </span><span class="n">using</span><span class="w"> </span><span class="n">errstr</span><span class="o">.</span><span class="w">  </span><span class="nc">Fail</span><span class="err">‐</span><span class="w">
             </span><span class="n">ure</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="k" data-group-id="7384089649-61">do</span><span class="w"> </span><span class="n">so</span><span class="w"> </span><span class="n">may</span><span class="w"> </span><span class="n">result</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">crash</span><span class="o">.</span><span class="w">

 </span><span class="n">close</span><span class="w">
       </span><span class="n">void</span><span class="w"> </span><span class="p" data-group-id="7384089649-62">(</span><span class="o">*</span><span class="n">close</span><span class="p" data-group-id="7384089649-62">)</span><span class="p" data-group-id="7384089649-63">(</span><span class="n">int</span><span class="w"> </span><span class="n">exit_status</span><span class="p">,</span><span class="w"> </span><span class="n">int</span><span class="w"> </span><span class="n">error</span><span class="p" data-group-id="7384089649-63">)</span><span class="p">;</span><span class="w">

       </span><span class="nc">The</span><span class="w"> </span><span class="n">close</span><span class="p" data-group-id="7384089649-64">(</span><span class="p" data-group-id="7384089649-64">)</span><span class="w"> </span><span class="n">function</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">called</span><span class="w"> </span><span class="ow">when</span><span class="w"> </span><span class="n">sudo</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">finished</span><span class="p">,</span><span class="w"> </span><span class="n">shortly</span><span class="w"> </span><span class="n">before</span><span class="w"> </span><span class="n">it</span><span class="w"> </span><span class="n">exits</span><span class="o">.</span><span class="w">

       </span><span class="nc">The</span><span class="w"> </span><span class="n">function</span><span class="w"> </span><span class="n">arguments</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="ss">follows</span><span class="p">:</span><span class="w">

       </span><span class="n">exit_status</span><span class="w">
             </span><span class="nc">The</span><span class="w"> </span><span class="n">command</span><span class="sc">&#39;s exit status, as returned by the wait(2) system call, or zero if no command was run.  The value of exit_status is undefined if error is non-zero.

       error
             If the command could not be executed, this is set to the value of errno set by the execve(2) system call.  If the command was successfully executed, the value of error
             is zero.

 show_version
       int (*show_version)(int verbose);

       The show_version() function is called by sudo when the user specifies the -V option.  The plugin may display its version information to the user via the conversation() or
       sudo_plugin_printf() function using SUDO_CONV_INFO_MSG.  If the user requests detailed version information, the verbose flag will be non-zero.

       Returns 1 on success, 0 on failure, -1 if a general error occurred, or -2 if there was a usage error, although the return value is currently ignored.

 log_ttyin
       int (*log_ttyin)(const char *buf, unsigned int len,
           const char **errstr);

       The log_ttyin() function is called whenever data can be read from the user but before it is passed to the running command.  This allows the plugin to reject data if it
       chooses to (for instance if the input contains banned content).  Returns 1 if the data should be passed to the command, 0 if the data is rejected (which will terminate the
       running command), or -1 if an error occurred.

       The function arguments are as follows:

       buf   The buffer containing user input.

       len   The length of buf in bytes.

       errstr
             If the log_ttyin() function returns a value other than 1, the plugin may store a message describing the failure or error in errstr.  The sudo front-end will then pass
             this value to any registered audit plugins.  The string stored in errstr must remain valid until the plugin&#39;</span><span class="n">s</span><span class="w"> </span><span class="n">close</span><span class="p" data-group-id="7384089649-65">(</span><span class="p" data-group-id="7384089649-65">)</span><span class="w"> </span><span class="n">function</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">called</span><span class="o">.</span><span class="w">

             </span><span class="nc">The</span><span class="w"> </span><span class="n">errstr</span><span class="w"> </span><span class="n">parameter</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">only</span><span class="w"> </span><span class="n">available</span><span class="w"> </span><span class="n">starting</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="nc">API</span><span class="w"> </span><span class="n">version</span><span class="w"> </span><span class="mf">1.15</span><span class="o">.</span><span class="w">  </span><span class="nc">A</span><span class="w"> </span><span class="n">plugin</span><span class="w"> </span><span class="n">must</span><span class="w"> </span><span class="n">check</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nc">API</span><span class="w"> </span><span class="n">version</span><span class="w"> </span><span class="n">specified</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">sudo</span><span class="w"> </span><span class="n">front</span><span class="o">-</span><span class="k" data-group-id="7384089649-61">end</span><span class="w"> </span><span class="n">before</span><span class="w"> </span><span class="n">using</span><span class="w"> </span><span class="n">errstr</span><span class="o">.</span><span class="w">  </span><span class="nc">Fail</span><span class="err">‐</span><span class="w">
             </span><span class="n">ure</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="k" data-group-id="7384089649-66">do</span><span class="w"> </span><span class="n">so</span><span class="w"> </span><span class="n">may</span><span class="w"> </span><span class="n">result</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">crash</span><span class="o">.</span><span class="w">

 </span><span class="n">log_ttyout</span><span class="w">
       </span><span class="n">int</span><span class="w"> </span><span class="p" data-group-id="7384089649-67">(</span><span class="o">*</span><span class="n">log_ttyout</span><span class="p" data-group-id="7384089649-67">)</span><span class="p" data-group-id="7384089649-68">(</span><span class="n">const</span><span class="w"> </span><span class="n">char</span><span class="w"> </span><span class="o">*</span><span class="n">buf</span><span class="p">,</span><span class="w"> </span><span class="n">unsigned</span><span class="w"> </span><span class="n">int</span><span class="w"> </span><span class="n">len</span><span class="p">,</span><span class="w">
           </span><span class="n">const</span><span class="w"> </span><span class="n">char</span><span class="w"> </span><span class="o">*</span><span class="o">*</span><span class="n">errstr</span><span class="p" data-group-id="7384089649-68">)</span><span class="p">;</span><span class="w">

       </span><span class="nc">The</span><span class="w"> </span><span class="n">log_ttyout</span><span class="p" data-group-id="7384089649-69">(</span><span class="p" data-group-id="7384089649-69">)</span><span class="w"> </span><span class="n">function</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">called</span><span class="w"> </span><span class="n">whenever</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="n">can</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">read</span><span class="w"> </span><span class="n">from</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">command</span><span class="w"> </span><span class="n">but</span><span class="w"> </span><span class="n">before</span><span class="w"> </span><span class="n">it</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">written</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">user</span><span class="sc">&#39;s terminal.  This allows the plugin to reject data if it
       chooses to (for instance if the output contains banned content).  Returns 1 if the data should be passed to the user, 0 if the data is rejected (which will terminate the run‐
       ning command), or -1 if an error occurred.

       The function arguments are as follows:

       buf   The buffer containing command output.

       len   The length of buf in bytes.

       errstr
             If the log_ttyout() function returns a value other than 1, the plugin may store a message describing the failure or error in errstr.  The sudo front-end will then pass
             this value to any registered audit plugins.  The string stored in errstr must remain valid until the plugin&#39;</span><span class="n">s</span><span class="w"> </span><span class="n">close</span><span class="p" data-group-id="7384089649-70">(</span><span class="p" data-group-id="7384089649-70">)</span><span class="w"> </span><span class="n">function</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">called</span><span class="o">.</span><span class="w">

             </span><span class="nc">The</span><span class="w"> </span><span class="n">errstr</span><span class="w"> </span><span class="n">parameter</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">only</span><span class="w"> </span><span class="n">available</span><span class="w"> </span><span class="n">starting</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="nc">API</span><span class="w"> </span><span class="n">version</span><span class="w"> </span><span class="mf">1.15</span><span class="o">.</span><span class="w">  </span><span class="nc">A</span><span class="w"> </span><span class="n">plugin</span><span class="w"> </span><span class="n">must</span><span class="w"> </span><span class="n">check</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nc">API</span><span class="w"> </span><span class="n">version</span><span class="w"> </span><span class="n">specified</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">sudo</span><span class="w"> </span><span class="n">front</span><span class="o">-</span><span class="k" data-group-id="7384089649-66">end</span><span class="w"> </span><span class="n">before</span><span class="w"> </span><span class="n">using</span><span class="w"> </span><span class="n">errstr</span><span class="o">.</span><span class="w">  </span><span class="nc">Fail</span><span class="err">‐</span><span class="w">
             </span><span class="n">ure</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="k" data-group-id="7384089649-71">do</span><span class="w"> </span><span class="n">so</span><span class="w"> </span><span class="n">may</span><span class="w"> </span><span class="n">result</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">crash</span><span class="o">.</span><span class="w">

 </span><span class="n">log_stdin</span><span class="w">
       </span><span class="n">int</span><span class="w"> </span><span class="p" data-group-id="7384089649-72">(</span><span class="o">*</span><span class="n">log_stdin</span><span class="p" data-group-id="7384089649-72">)</span><span class="p" data-group-id="7384089649-73">(</span><span class="n">const</span><span class="w"> </span><span class="n">char</span><span class="w"> </span><span class="o">*</span><span class="n">buf</span><span class="p">,</span><span class="w"> </span><span class="n">unsigned</span><span class="w"> </span><span class="n">int</span><span class="w"> </span><span class="n">len</span><span class="p">,</span><span class="w">
           </span><span class="n">const</span><span class="w"> </span><span class="n">char</span><span class="w"> </span><span class="o">*</span><span class="o">*</span><span class="n">errstr</span><span class="p" data-group-id="7384089649-73">)</span><span class="p">;</span><span class="w">

       </span><span class="nc">The</span><span class="w"> </span><span class="n">log_stdin</span><span class="p" data-group-id="7384089649-74">(</span><span class="p" data-group-id="7384089649-74">)</span><span class="w"> </span><span class="n">function</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">only</span><span class="w"> </span><span class="n">used</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">standard</span><span class="w"> </span><span class="n">input</span><span class="w"> </span><span class="n">does</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">correspond</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">tty</span><span class="w"> </span><span class="n">device</span><span class="o">.</span><span class="w">  </span><span class="nc">It</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">called</span><span class="w"> </span><span class="n">whenever</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="n">can</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">read</span><span class="w"> </span><span class="n">from</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">standard</span><span class="w"> </span><span class="n">input</span><span class="w"> </span><span class="n">but</span><span class="w"> </span><span class="n">before</span><span class="w"> </span><span class="n">it</span><span class="w">
       </span><span class="n">is</span><span class="w"> </span><span class="n">passed</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">running</span><span class="w"> </span><span class="n">command</span><span class="o">.</span><span class="w">  </span><span class="nc">This</span><span class="w"> </span><span class="n">allows</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">plugin</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">reject</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">it</span><span class="w"> </span><span class="n">chooses</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="p" data-group-id="7384089649-75">(</span><span class="k">for</span><span class="w"> </span><span class="n">instance</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">input</span><span class="w"> </span><span class="n">contains</span><span class="w"> </span><span class="n">banned</span><span class="w"> </span><span class="n">content</span><span class="p" data-group-id="7384089649-75">)</span><span class="o">.</span><span class="w">  </span><span class="nc">Returns</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="n">should</span><span class="w">
       </span><span class="n">be</span><span class="w"> </span><span class="n">passed</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">command</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">rejected</span><span class="w"> </span><span class="p" data-group-id="7384089649-76">(</span><span class="n">which</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">terminate</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">running</span><span class="w"> </span><span class="n">command</span><span class="p" data-group-id="7384089649-76">)</span><span class="p">,</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="o">-</span><span class="mi">1</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">an</span><span class="w"> </span><span class="n">error</span><span class="w"> </span><span class="n">occurred</span><span class="o">.</span><span class="w">

       </span><span class="nc">The</span><span class="w"> </span><span class="n">function</span><span class="w"> </span><span class="n">arguments</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="ss">follows</span><span class="p">:</span><span class="w">

       </span><span class="n">buf</span><span class="w">   </span><span class="nc">The</span><span class="w"> </span><span class="n">buffer</span><span class="w"> </span><span class="n">containing</span><span class="w"> </span><span class="n">user</span><span class="w"> </span><span class="n">input</span><span class="o">.</span><span class="w">

       </span><span class="n">len</span><span class="w">   </span><span class="nc">The</span><span class="w"> </span><span class="n">length</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">buf</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">bytes</span><span class="o">.</span><span class="w">

       </span><span class="n">errstr</span><span class="w">
             </span><span class="nc">If</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">log_stdin</span><span class="p" data-group-id="7384089649-77">(</span><span class="p" data-group-id="7384089649-77">)</span><span class="w"> </span><span class="n">function</span><span class="w"> </span><span class="n">returns</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">value</span><span class="w"> </span><span class="n">other</span><span class="w"> </span><span class="n">than</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">plugin</span><span class="w"> </span><span class="n">may</span><span class="w"> </span><span class="n">store</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">message</span><span class="w"> </span><span class="n">describing</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">failure</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">error</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">errstr</span><span class="o">.</span><span class="w">  </span><span class="nc">The</span><span class="w"> </span><span class="n">sudo</span><span class="w"> </span><span class="n">front</span><span class="o">-</span><span class="k" data-group-id="7384089649-71">end</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">then</span><span class="w"> </span><span class="n">pass</span><span class="w">
             </span><span class="n">this</span><span class="w"> </span><span class="n">value</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">any</span><span class="w"> </span><span class="n">registered</span><span class="w"> </span><span class="n">audit</span><span class="w"> </span><span class="n">plugins</span><span class="o">.</span><span class="w">  </span><span class="nc">The</span><span class="w"> </span><span class="n">string</span><span class="w"> </span><span class="n">stored</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">errstr</span><span class="w"> </span><span class="n">must</span><span class="w"> </span><span class="n">remain</span><span class="w"> </span><span class="n">valid</span><span class="w"> </span><span class="n">until</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">plugin</span><span class="sc">&#39;s close() function is called.

             The errstr parameter is only available starting with API version 1.15.  A plugin must check the API version specified by the sudo front-end before using errstr.  Fail‐
             ure to do so may result in a crash.

 log_stdout
       int (*log_stdout)(const char *buf, unsigned int len,
           const char **errstr);

       The log_stdout() function is only used if the standard output does not correspond to a tty device.  It is called whenever data can be read from the command but before it is
       written to the standard output.  This allows the plugin to reject data if it chooses to (for instance if the output contains banned content).  Returns 1 if the data should be
       passed to the user, 0 if the data is rejected (which will terminate the running command), or -1 if an error occurred.

       The function arguments are as follows:

       buf   The buffer containing command output.

       len   The length of buf in bytes.

       errstr
             If the log_stdout() function returns a value other than 1, the plugin may store a message describing the failure or error in errstr.  The sudo front-end will then pass
             this value to any registered audit plugins.  The string stored in errstr must remain valid until the plugin&#39;</span><span class="n">s</span><span class="w"> </span><span class="n">close</span><span class="p" data-group-id="7384089649-78">(</span><span class="p" data-group-id="7384089649-78">)</span><span class="w"> </span><span class="n">function</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">called</span><span class="o">.</span><span class="w">

             </span><span class="nc">The</span><span class="w"> </span><span class="n">errstr</span><span class="w"> </span><span class="n">parameter</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">only</span><span class="w"> </span><span class="n">available</span><span class="w"> </span><span class="n">starting</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="nc">API</span><span class="w"> </span><span class="n">version</span><span class="w"> </span><span class="mf">1.15</span><span class="o">.</span><span class="w">  </span><span class="nc">A</span><span class="w"> </span><span class="n">plugin</span><span class="w"> </span><span class="n">must</span><span class="w"> </span><span class="n">check</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nc">API</span><span class="w"> </span><span class="n">version</span><span class="w"> </span><span class="n">specified</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">sudo</span><span class="w"> </span><span class="n">front</span><span class="o">-</span><span class="k">end</span><span class="w"> </span><span class="n">before</span><span class="w"> </span><span class="n">using</span><span class="w"> </span><span class="n">errstr</span><span class="o">.</span><span class="w">  </span><span class="nc">Fail</span><span class="err">‐</span><span class="w">
             </span><span class="n">ure</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="k" data-group-id="7384089649-79">do</span><span class="w"> </span><span class="n">so</span><span class="w"> </span><span class="n">may</span><span class="w"> </span><span class="n">result</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">crash</span><span class="o">.</span><span class="w">

 </span><span class="n">log_stderr</span><span class="w">
       </span><span class="n">int</span><span class="w"> </span><span class="p" data-group-id="7384089649-80">(</span><span class="o">*</span><span class="n">log_stderr</span><span class="p" data-group-id="7384089649-80">)</span><span class="p" data-group-id="7384089649-81">(</span><span class="n">const</span><span class="w"> </span><span class="n">char</span><span class="w"> </span><span class="o">*</span><span class="n">buf</span><span class="p">,</span><span class="w"> </span><span class="n">unsigned</span><span class="w"> </span><span class="n">int</span><span class="w"> </span><span class="n">len</span><span class="p">,</span><span class="w">
           </span><span class="n">const</span><span class="w"> </span><span class="n">char</span><span class="w"> </span><span class="o">*</span><span class="o">*</span><span class="n">errstr</span><span class="p" data-group-id="7384089649-81">)</span><span class="p">;</span><span class="w">

       </span><span class="nc">The</span><span class="w"> </span><span class="n">log_stderr</span><span class="p" data-group-id="7384089649-82">(</span><span class="p" data-group-id="7384089649-82">)</span><span class="w"> </span><span class="n">function</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">only</span><span class="w"> </span><span class="n">used</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">standard</span><span class="w"> </span><span class="n">error</span><span class="w"> </span><span class="n">does</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">correspond</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">tty</span><span class="w"> </span><span class="n">device</span><span class="o">.</span><span class="w">  </span><span class="nc">It</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">called</span><span class="w"> </span><span class="n">whenever</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="n">can</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">read</span><span class="w"> </span><span class="n">from</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">command</span><span class="w"> </span><span class="n">but</span><span class="w"> </span><span class="n">before</span><span class="w"> </span><span class="n">it</span><span class="w"> </span><span class="n">is</span><span class="w">
       </span><span class="n">written</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">standard</span><span class="w"> </span><span class="n">error</span><span class="o">.</span><span class="w">  </span><span class="nc">This</span><span class="w"> </span><span class="n">allows</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">plugin</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">reject</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">it</span><span class="w"> </span><span class="n">chooses</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="p" data-group-id="7384089649-83">(</span><span class="k">for</span><span class="w"> </span><span class="n">instance</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">output</span><span class="w"> </span><span class="n">contains</span><span class="w"> </span><span class="n">banned</span><span class="w"> </span><span class="n">content</span><span class="p" data-group-id="7384089649-83">)</span><span class="o">.</span><span class="w">  </span><span class="nc">Returns</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="n">should</span><span class="w"> </span><span class="n">be</span><span class="w">
       </span><span class="n">passed</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">user</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">rejected</span><span class="w"> </span><span class="p" data-group-id="7384089649-84">(</span><span class="n">which</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">terminate</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">running</span><span class="w"> </span><span class="n">command</span><span class="p" data-group-id="7384089649-84">)</span><span class="p">,</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="o">-</span><span class="mi">1</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">an</span><span class="w"> </span><span class="n">error</span><span class="w"> </span><span class="n">occurred</span><span class="o">.</span><span class="w">

       </span><span class="nc">The</span><span class="w"> </span><span class="n">function</span><span class="w"> </span><span class="n">arguments</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="ss">follows</span><span class="p">:</span><span class="w">

       </span><span class="n">buf</span><span class="w">   </span><span class="nc">The</span><span class="w"> </span><span class="n">buffer</span><span class="w"> </span><span class="n">containing</span><span class="w"> </span><span class="n">command</span><span class="w"> </span><span class="n">output</span><span class="o">.</span><span class="w">

       </span><span class="n">len</span><span class="w">   </span><span class="nc">The</span><span class="w"> </span><span class="n">length</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">buf</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">bytes</span><span class="o">.</span><span class="w">

       </span><span class="n">errstr</span><span class="w">
             </span><span class="nc">If</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">log_stderr</span><span class="p" data-group-id="7384089649-85">(</span><span class="p" data-group-id="7384089649-85">)</span><span class="w"> </span><span class="n">function</span><span class="w"> </span><span class="n">returns</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">value</span><span class="w"> </span><span class="n">other</span><span class="w"> </span><span class="n">than</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">plugin</span><span class="w"> </span><span class="n">may</span><span class="w"> </span><span class="n">store</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">message</span><span class="w"> </span><span class="n">describing</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">failure</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">error</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">errstr</span><span class="o">.</span><span class="w">  </span><span class="nc">The</span><span class="w"> </span><span class="n">sudo</span><span class="w"> </span><span class="n">front</span><span class="o">-</span><span class="k" data-group-id="7384089649-79">end</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">then</span><span class="w"> </span><span class="n">pass</span><span class="w">
             </span><span class="n">this</span><span class="w"> </span><span class="n">value</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">any</span><span class="w"> </span><span class="n">registered</span><span class="w"> </span><span class="n">audit</span><span class="w"> </span><span class="n">plugins</span><span class="o">.</span><span class="w">  </span><span class="nc">The</span><span class="w"> </span><span class="n">string</span><span class="w"> </span><span class="n">stored</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">errstr</span><span class="w"> </span><span class="n">must</span><span class="w"> </span><span class="n">remain</span><span class="w"> </span><span class="n">valid</span><span class="w"> </span><span class="n">until</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">plugin</span><span class="sc">&#39;s close() function is called.

             The errstr parameter is only available starting with API version 1.15.  A plugin must check the API version specified by the sudo front-end before using errstr.  Fail‐
             ure to do so may result in a crash.

 register_hooks
       See the Policy plugin API section for a description of register_hooks().

 deregister_hooks
       See the Policy plugin API section for a description of deregister_hooks().

 change_winsize
       int (*change_winsize)(unsigned int lines, unsigned int cols,
           const char **errstr);

       The change_winsize() function is called whenever the window size of the terminal changes from the initial values specified in the user_info list.  Returns -1 if an error oc‐
       curred, in which case no further calls to change_winsize() will be made,

       The function arguments are as follows:

       lines
             The number of lines (rows) in the re-sized terminal.

       cols  The number of columns in the re-sized terminal.

       errstr
             If the change_winsize() function returns a value other than 1, the plugin may store a message describing the failure or error in errstr.  The sudo front-end will then
             pass this value to any registered audit plugins.  The string stored in errstr must remain valid until the plugin&#39;</span><span class="n">s</span><span class="w"> </span><span class="n">close</span><span class="p" data-group-id="7384089649-86">(</span><span class="p" data-group-id="7384089649-86">)</span><span class="w"> </span><span class="n">function</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">called</span><span class="o">.</span><span class="w">

             </span><span class="nc">The</span><span class="w"> </span><span class="n">errstr</span><span class="w"> </span><span class="n">parameter</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">only</span><span class="w"> </span><span class="n">available</span><span class="w"> </span><span class="n">starting</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="nc">API</span><span class="w"> </span><span class="n">version</span><span class="w"> </span><span class="mf">1.15</span><span class="o">.</span><span class="w">  </span><span class="nc">A</span><span class="w"> </span><span class="n">plugin</span><span class="w"> </span><span class="n">must</span><span class="w"> </span><span class="n">check</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nc">API</span><span class="w"> </span><span class="n">version</span><span class="w"> </span><span class="n">specified</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">sudo</span><span class="w"> </span><span class="n">front</span><span class="o">-</span><span class="k">end</span><span class="w"> </span><span class="n">before</span><span class="w"> </span><span class="n">using</span><span class="w"> </span><span class="n">errstr</span><span class="o">.</span><span class="w">  </span><span class="nc">Fail</span><span class="err">‐</span><span class="w">
             </span><span class="n">ure</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="k" data-group-id="7384089649-87">do</span><span class="w"> </span><span class="n">so</span><span class="w"> </span><span class="n">may</span><span class="w"> </span><span class="n">result</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">crash</span><span class="o">.</span><span class="w">

 </span><span class="n">log_suspend</span><span class="w">
       </span><span class="n">int</span><span class="w"> </span><span class="p" data-group-id="7384089649-88">(</span><span class="o">*</span><span class="n">log_suspend</span><span class="p" data-group-id="7384089649-88">)</span><span class="p" data-group-id="7384089649-89">(</span><span class="n">int</span><span class="w"> </span><span class="n">signo</span><span class="p">,</span><span class="w"> </span><span class="n">const</span><span class="w"> </span><span class="n">char</span><span class="w"> </span><span class="o">*</span><span class="o">*</span><span class="n">errstr</span><span class="p" data-group-id="7384089649-89">)</span><span class="p">;</span><span class="w">

       </span><span class="nc">The</span><span class="w"> </span><span class="n">log_suspend</span><span class="p" data-group-id="7384089649-90">(</span><span class="p" data-group-id="7384089649-90">)</span><span class="w"> </span><span class="n">function</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">called</span><span class="w"> </span><span class="n">whenever</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">command</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">suspended</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">resumed</span><span class="o">.</span><span class="w">  </span><span class="nc">Logging</span><span class="w"> </span><span class="n">this</span><span class="w"> </span><span class="n">information</span><span class="w"> </span><span class="n">makes</span><span class="w"> </span><span class="n">it</span><span class="w"> </span><span class="n">possible</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">skip</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">period</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">time</span><span class="w"> </span><span class="ow">when</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">command</span><span class="w"> </span><span class="n">was</span><span class="w">
       </span><span class="n">suspended</span><span class="w"> </span><span class="n">during</span><span class="w"> </span><span class="n">playback</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">session</span><span class="o">.</span><span class="w">  </span><span class="nc">Returns</span><span class="w"> </span><span class="o">-</span><span class="mi">1</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">an</span><span class="w"> </span><span class="n">error</span><span class="w"> </span><span class="n">occurred</span><span class="p">,</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">which</span><span class="w"> </span><span class="k">case</span><span class="w"> </span><span class="n">no</span><span class="w"> </span><span class="n">further</span><span class="w"> </span><span class="n">calls</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">log_suspend</span><span class="p" data-group-id="7384089649-91">(</span><span class="p" data-group-id="7384089649-91">)</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">made</span><span class="p">,</span><span class="w">

       </span><span class="nc">The</span><span class="w"> </span><span class="n">function</span><span class="w"> </span><span class="n">arguments</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="ss">follows</span><span class="p">:</span><span class="w">

       </span><span class="n">signo</span><span class="w">
             </span><span class="nc">The</span><span class="w"> </span><span class="n">signal</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">caused</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">command</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">suspended</span><span class="p">,</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="nc">SIGCONT</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">command</span><span class="w"> </span><span class="n">was</span><span class="w"> </span><span class="n">resumed</span><span class="o">.</span><span class="w">

       </span><span class="n">errstr</span><span class="w">
             </span><span class="nc">If</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">log_suspend</span><span class="p" data-group-id="7384089649-92">(</span><span class="p" data-group-id="7384089649-92">)</span><span class="w"> </span><span class="n">function</span><span class="w"> </span><span class="n">returns</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">value</span><span class="w"> </span><span class="n">other</span><span class="w"> </span><span class="n">than</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">plugin</span><span class="w"> </span><span class="n">may</span><span class="w"> </span><span class="n">store</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">message</span><span class="w"> </span><span class="n">describing</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">failure</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">error</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">errstr</span><span class="o">.</span><span class="w">  </span><span class="nc">The</span><span class="w"> </span><span class="n">sudo</span><span class="w"> </span><span class="n">front</span><span class="o">-</span><span class="k" data-group-id="7384089649-87">end</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">then</span><span class="w"> </span><span class="n">pass</span><span class="w">
             </span><span class="n">this</span><span class="w"> </span><span class="n">value</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">any</span><span class="w"> </span><span class="n">registered</span><span class="w"> </span><span class="n">audit</span><span class="w"> </span><span class="n">plugins</span><span class="o">.</span><span class="w">  </span><span class="nc">The</span><span class="w"> </span><span class="n">string</span><span class="w"> </span><span class="n">stored</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">errstr</span><span class="w"> </span><span class="n">must</span><span class="w"> </span><span class="n">remain</span><span class="w"> </span><span class="n">valid</span><span class="w"> </span><span class="n">until</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">plugin</span><span class="sc">&#39;s close() function is called.

             The errstr parameter is only available starting with API version 1.15.  A plugin must check the API version specified by the sudo front-end before using errstr.  Fail‐
             ure to do so may result in a crash.

       event_alloc
             struct sudo_plugin_event * (*event_alloc)(void);

             The event_alloc() function is used to allocate a struct sudo_plugin_event which provides access to the main sudo event loop.  Unlike the other fields, the event_alloc()
             pointer is filled in by the sudo front-end, not by the plugin.

             See the Event API section below for more information about events.

             The event_alloc() function is only available starting with API version 1.15.  If the sudo front-end doesn&#39;</span><span class="n">t</span><span class="w"> </span><span class="n">support</span><span class="w"> </span><span class="nc">API</span><span class="w"> </span><span class="n">version</span><span class="w"> </span><span class="mf">1.15</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">higher</span><span class="p">,</span><span class="w"> </span><span class="n">event_alloc</span><span class="p" data-group-id="7384089649-93">(</span><span class="p" data-group-id="7384089649-93">)</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="ow">not</span><span class="w">
             </span><span class="n">be</span><span class="w"> </span><span class="n">set</span><span class="o">.</span><span class="w">

       </span><span class="nc">I</span><span class="o">/</span><span class="nc">O</span><span class="w"> </span><span class="nc">Plugin</span><span class="w"> </span><span class="nc">Version</span><span class="w"> </span><span class="nc">Macros</span><span class="w">

       </span><span class="nc">Same</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nc">Policy</span><span class="w"> </span><span class="n">plugin</span><span class="w"> </span><span class="nc">API</span><span class="o">.</span></code></pre><p>   Audit plugin API</p><pre><code class="makeup elixir" translate="no"><span class="w"> </span><span class="o">/</span><span class="o">*</span><span class="w"> </span><span class="nc">Audit</span><span class="w"> </span><span class="n">plugin</span><span class="w"> </span><span class="n">close</span><span class="w"> </span><span class="n">function</span><span class="w"> </span><span class="n">status</span><span class="w"> </span><span class="n">types</span><span class="o">.</span><span class="w"> </span><span class="o">*</span><span class="o">/</span><span class="w">
 </span><span class="c1">#define SUDO_PLUGIN_NO_STATUS           0</span><span class="w">
 </span><span class="c1">#define SUDO_PLUGIN_WAIT_STATUS         1</span><span class="w">
 </span><span class="c1">#define SUDO_PLUGIN_EXEC_ERROR          2</span><span class="w">
 </span><span class="c1">#define SUDO_PLUGIN_SUDO_ERROR          3</span><span class="w">

 </span><span class="c1">#define SUDO_AUDIT_PLUGIN 3</span><span class="w">
 </span><span class="n">struct</span><span class="w"> </span><span class="n">audit_plugin</span><span class="w"> </span><span class="p" data-group-id="0487223484-1">{</span><span class="w">
     </span><span class="n">unsigned</span><span class="w"> </span><span class="n">int</span><span class="w"> </span><span class="n">type</span><span class="p">;</span><span class="w"> </span><span class="o">/</span><span class="o">*</span><span class="w"> </span><span class="n">always</span><span class="w"> </span><span class="nc">SUDO_AUDIT_PLUGIN</span><span class="w"> </span><span class="o">*</span><span class="o">/</span><span class="w">
     </span><span class="n">unsigned</span><span class="w"> </span><span class="n">int</span><span class="w"> </span><span class="n">version</span><span class="p">;</span><span class="w"> </span><span class="o">/</span><span class="o">*</span><span class="w"> </span><span class="n">always</span><span class="w"> </span><span class="nc">SUDO_API_VERSION</span><span class="w"> </span><span class="o">*</span><span class="o">/</span><span class="w">
     </span><span class="n">int</span><span class="w"> </span><span class="p" data-group-id="0487223484-2">(</span><span class="o">*</span><span class="n">open</span><span class="p" data-group-id="0487223484-2">)</span><span class="p" data-group-id="0487223484-3">(</span><span class="n">unsigned</span><span class="w"> </span><span class="n">int</span><span class="w"> </span><span class="n">version</span><span class="p">,</span><span class="w"> </span><span class="n">sudo_conv_t</span><span class="w"> </span><span class="n">conversation</span><span class="p">,</span><span class="w">
         </span><span class="n">sudo_printf_t</span><span class="w"> </span><span class="n">sudo_plugin_printf</span><span class="p">,</span><span class="w"> </span><span class="n">char</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">const</span><span class="w"> </span><span class="n">settings</span><span class="p" data-group-id="0487223484-4">[</span><span class="p" data-group-id="0487223484-4">]</span><span class="p">,</span><span class="w">
         </span><span class="n">char</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">const</span><span class="w"> </span><span class="n">user_info</span><span class="p" data-group-id="0487223484-5">[</span><span class="p" data-group-id="0487223484-5">]</span><span class="p">,</span><span class="w"> </span><span class="n">int</span><span class="w"> </span><span class="n">submit_optind</span><span class="p">,</span><span class="w">
         </span><span class="n">char</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">const</span><span class="w"> </span><span class="n">submit_argv</span><span class="p" data-group-id="0487223484-6">[</span><span class="p" data-group-id="0487223484-6">]</span><span class="p">,</span><span class="w"> </span><span class="n">char</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">const</span><span class="w"> </span><span class="n">submit_envp</span><span class="p" data-group-id="0487223484-7">[</span><span class="p" data-group-id="0487223484-7">]</span><span class="p">,</span><span class="w">
         </span><span class="n">char</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">const</span><span class="w"> </span><span class="n">plugin_options</span><span class="p" data-group-id="0487223484-8">[</span><span class="p" data-group-id="0487223484-8">]</span><span class="p">,</span><span class="w"> </span><span class="n">const</span><span class="w"> </span><span class="n">char</span><span class="w"> </span><span class="o">*</span><span class="o">*</span><span class="n">errstr</span><span class="p" data-group-id="0487223484-3">)</span><span class="p">;</span><span class="w">
     </span><span class="n">void</span><span class="w"> </span><span class="p" data-group-id="0487223484-9">(</span><span class="o">*</span><span class="n">close</span><span class="p" data-group-id="0487223484-9">)</span><span class="p" data-group-id="0487223484-10">(</span><span class="n">int</span><span class="w"> </span><span class="n">status_type</span><span class="p">,</span><span class="w"> </span><span class="n">int</span><span class="w"> </span><span class="n">status</span><span class="p" data-group-id="0487223484-10">)</span><span class="p">;</span><span class="w">
     </span><span class="n">int</span><span class="w"> </span><span class="p" data-group-id="0487223484-11">(</span><span class="o">*</span><span class="n">accept</span><span class="p" data-group-id="0487223484-11">)</span><span class="p" data-group-id="0487223484-12">(</span><span class="n">const</span><span class="w"> </span><span class="n">char</span><span class="w"> </span><span class="o">*</span><span class="n">plugin_name</span><span class="p">,</span><span class="w">
         </span><span class="n">unsigned</span><span class="w"> </span><span class="n">int</span><span class="w"> </span><span class="n">plugin_type</span><span class="p">,</span><span class="w"> </span><span class="n">char</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">const</span><span class="w"> </span><span class="n">command_info</span><span class="p" data-group-id="0487223484-13">[</span><span class="p" data-group-id="0487223484-13">]</span><span class="p">,</span><span class="w">
         </span><span class="n">char</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">const</span><span class="w"> </span><span class="n">run_argv</span><span class="p" data-group-id="0487223484-14">[</span><span class="p" data-group-id="0487223484-14">]</span><span class="p">,</span><span class="w"> </span><span class="n">char</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">const</span><span class="w"> </span><span class="n">run_envp</span><span class="p" data-group-id="0487223484-15">[</span><span class="p" data-group-id="0487223484-15">]</span><span class="p">,</span><span class="w">
         </span><span class="n">const</span><span class="w"> </span><span class="n">char</span><span class="w"> </span><span class="o">*</span><span class="o">*</span><span class="n">errstr</span><span class="p" data-group-id="0487223484-12">)</span><span class="p">;</span><span class="w">
     </span><span class="n">int</span><span class="w"> </span><span class="p" data-group-id="0487223484-16">(</span><span class="o">*</span><span class="n">reject</span><span class="p" data-group-id="0487223484-16">)</span><span class="p" data-group-id="0487223484-17">(</span><span class="n">const</span><span class="w"> </span><span class="n">char</span><span class="w"> </span><span class="o">*</span><span class="n">plugin_name</span><span class="p">,</span><span class="w"> </span><span class="n">unsigned</span><span class="w"> </span><span class="n">int</span><span class="w"> </span><span class="n">plugin_type</span><span class="p">,</span><span class="w">
         </span><span class="n">const</span><span class="w"> </span><span class="n">char</span><span class="w"> </span><span class="o">*</span><span class="n">audit_msg</span><span class="p">,</span><span class="w"> </span><span class="n">char</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">const</span><span class="w"> </span><span class="n">command_info</span><span class="p" data-group-id="0487223484-18">[</span><span class="p" data-group-id="0487223484-18">]</span><span class="p">,</span><span class="w">
         </span><span class="n">const</span><span class="w"> </span><span class="n">char</span><span class="w"> </span><span class="o">*</span><span class="o">*</span><span class="n">errstr</span><span class="p" data-group-id="0487223484-17">)</span><span class="p">;</span><span class="w">
     </span><span class="n">int</span><span class="w"> </span><span class="p" data-group-id="0487223484-19">(</span><span class="o">*</span><span class="n">error</span><span class="p" data-group-id="0487223484-19">)</span><span class="p" data-group-id="0487223484-20">(</span><span class="n">const</span><span class="w"> </span><span class="n">char</span><span class="w"> </span><span class="o">*</span><span class="n">plugin_name</span><span class="p">,</span><span class="w"> </span><span class="n">unsigned</span><span class="w"> </span><span class="n">int</span><span class="w"> </span><span class="n">plugin_type</span><span class="p">,</span><span class="w">
         </span><span class="n">const</span><span class="w"> </span><span class="n">char</span><span class="w"> </span><span class="o">*</span><span class="n">audit_msg</span><span class="p">,</span><span class="w"> </span><span class="n">char</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">const</span><span class="w"> </span><span class="n">command_info</span><span class="p" data-group-id="0487223484-21">[</span><span class="p" data-group-id="0487223484-21">]</span><span class="p">,</span><span class="w">
         </span><span class="n">const</span><span class="w"> </span><span class="n">char</span><span class="w"> </span><span class="o">*</span><span class="o">*</span><span class="n">errstr</span><span class="p" data-group-id="0487223484-20">)</span><span class="p">;</span><span class="w">
     </span><span class="n">int</span><span class="w"> </span><span class="p" data-group-id="0487223484-22">(</span><span class="o">*</span><span class="n">show_version</span><span class="p" data-group-id="0487223484-22">)</span><span class="p" data-group-id="0487223484-23">(</span><span class="n">int</span><span class="w"> </span><span class="n">verbose</span><span class="p" data-group-id="0487223484-23">)</span><span class="p">;</span><span class="w">
     </span><span class="n">void</span><span class="w"> </span><span class="p" data-group-id="0487223484-24">(</span><span class="o">*</span><span class="n">register_hooks</span><span class="p" data-group-id="0487223484-24">)</span><span class="p" data-group-id="0487223484-25">(</span><span class="n">int</span><span class="w"> </span><span class="n">version</span><span class="p">,</span><span class="w">
         </span><span class="n">int</span><span class="w"> </span><span class="p" data-group-id="0487223484-26">(</span><span class="o">*</span><span class="n">register_hook</span><span class="p" data-group-id="0487223484-26">)</span><span class="p" data-group-id="0487223484-27">(</span><span class="n">struct</span><span class="w"> </span><span class="n">sudo_hook</span><span class="w"> </span><span class="o">*</span><span class="n">hook</span><span class="p" data-group-id="0487223484-27">)</span><span class="p" data-group-id="0487223484-25">)</span><span class="p">;</span><span class="w">
     </span><span class="n">void</span><span class="w"> </span><span class="p" data-group-id="0487223484-28">(</span><span class="o">*</span><span class="n">deregister_hooks</span><span class="p" data-group-id="0487223484-28">)</span><span class="p" data-group-id="0487223484-29">(</span><span class="n">int</span><span class="w"> </span><span class="n">version</span><span class="p">,</span><span class="w">
         </span><span class="n">int</span><span class="w"> </span><span class="p" data-group-id="0487223484-30">(</span><span class="o">*</span><span class="n">deregister_hook</span><span class="p" data-group-id="0487223484-30">)</span><span class="p" data-group-id="0487223484-31">(</span><span class="n">struct</span><span class="w"> </span><span class="n">sudo_hook</span><span class="w"> </span><span class="o">*</span><span class="n">hook</span><span class="p" data-group-id="0487223484-31">)</span><span class="p" data-group-id="0487223484-29">)</span><span class="p">;</span><span class="w">
     </span><span class="n">struct</span><span class="w"> </span><span class="n">sudo_plugin_event</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p" data-group-id="0487223484-32">(</span><span class="o">*</span><span class="n">event_alloc</span><span class="p" data-group-id="0487223484-32">)</span><span class="p" data-group-id="0487223484-33">(</span><span class="n">void</span><span class="p" data-group-id="0487223484-33">)</span><span class="p">;</span><span class="w">
 </span><span class="p" data-group-id="0487223484-1">}</span><span class="w">

 </span><span class="nc">An</span><span class="w"> </span><span class="n">audit</span><span class="w"> </span><span class="n">plugin</span><span class="w"> </span><span class="n">can</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">used</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">log</span><span class="w"> </span><span class="n">successful</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">unsuccessful</span><span class="w"> </span><span class="n">attempts</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">run</span><span class="w"> </span><span class="n">sudo</span><span class="w"> </span><span class="n">independent</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">policy</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">any</span><span class="w"> </span><span class="nc">I</span><span class="o">/</span><span class="nc">O</span><span class="w"> </span><span class="n">plugins</span><span class="o">.</span><span class="w">  </span><span class="nc">Multiple</span><span class="w"> </span><span class="n">audit</span><span class="w"> </span><span class="n">plugins</span><span class="w"> </span><span class="n">may</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">specified</span><span class="w"> </span><span class="ow">in</span><span class="w">
 </span><span class="n">sudo</span><span class="o">.</span><span class="n">conf</span><span class="p" data-group-id="0487223484-34">(</span><span class="mi">5</span><span class="p" data-group-id="0487223484-34">)</span><span class="o">.</span><span class="w">

 </span><span class="nc">A</span><span class="w"> </span><span class="n">struct</span><span class="w"> </span><span class="n">audit_plugin</span><span class="w"> </span><span class="n">has</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">following</span><span class="w"> </span><span class="ss">fields</span><span class="p">:</span><span class="w">

 </span><span class="n">type</span><span class="w">  </span><span class="nc">The</span><span class="w"> </span><span class="n">type</span><span class="w"> </span><span class="n">field</span><span class="w"> </span><span class="n">should</span><span class="w"> </span><span class="n">always</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">set</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="nc">SUDO_AUDIT_PLUGIN</span><span class="o">.</span><span class="w">

 </span><span class="n">version</span><span class="w">
       </span><span class="nc">The</span><span class="w"> </span><span class="n">version</span><span class="w"> </span><span class="n">field</span><span class="w"> </span><span class="n">should</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">set</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="nc">SUDO_API_VERSION</span><span class="o">.</span><span class="w">

       </span><span class="nc">This</span><span class="w"> </span><span class="n">allows</span><span class="w"> </span><span class="n">sudo</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">determine</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nc">API</span><span class="w"> </span><span class="n">version</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">plugin</span><span class="w"> </span><span class="n">was</span><span class="w"> </span><span class="n">built</span><span class="w"> </span><span class="n">against</span><span class="o">.</span><span class="w">

 </span><span class="n">open</span><span class="w">
       </span><span class="n">int</span><span class="w"> </span><span class="p" data-group-id="0487223484-35">(</span><span class="o">*</span><span class="n">open</span><span class="p" data-group-id="0487223484-35">)</span><span class="p" data-group-id="0487223484-36">(</span><span class="n">unsigned</span><span class="w"> </span><span class="n">int</span><span class="w"> </span><span class="n">version</span><span class="p">,</span><span class="w"> </span><span class="n">sudo_conv_t</span><span class="w"> </span><span class="n">conversation</span><span class="p">,</span><span class="w">
           </span><span class="n">sudo_printf_t</span><span class="w"> </span><span class="n">sudo_plugin_printf</span><span class="p">,</span><span class="w"> </span><span class="n">char</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">const</span><span class="w"> </span><span class="n">settings</span><span class="p" data-group-id="0487223484-37">[</span><span class="p" data-group-id="0487223484-37">]</span><span class="p">,</span><span class="w">
           </span><span class="n">char</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">const</span><span class="w"> </span><span class="n">user_info</span><span class="p" data-group-id="0487223484-38">[</span><span class="p" data-group-id="0487223484-38">]</span><span class="p">,</span><span class="w"> </span><span class="n">int</span><span class="w"> </span><span class="n">submit_optind</span><span class="p">,</span><span class="w">
           </span><span class="n">char</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">const</span><span class="w"> </span><span class="n">submit_argv</span><span class="p" data-group-id="0487223484-39">[</span><span class="p" data-group-id="0487223484-39">]</span><span class="p">,</span><span class="w"> </span><span class="n">char</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">const</span><span class="w"> </span><span class="n">submit_envp</span><span class="p" data-group-id="0487223484-40">[</span><span class="p" data-group-id="0487223484-40">]</span><span class="p">,</span><span class="w">
           </span><span class="n">char</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">const</span><span class="w"> </span><span class="n">plugin_options</span><span class="p" data-group-id="0487223484-41">[</span><span class="p" data-group-id="0487223484-41">]</span><span class="p">,</span><span class="w"> </span><span class="n">const</span><span class="w"> </span><span class="n">char</span><span class="w"> </span><span class="o">*</span><span class="o">*</span><span class="n">errstr</span><span class="p" data-group-id="0487223484-36">)</span><span class="p">;</span><span class="w">

       </span><span class="nc">The</span><span class="w"> </span><span class="n">audit</span><span class="w"> </span><span class="n">open</span><span class="p" data-group-id="0487223484-42">(</span><span class="p" data-group-id="0487223484-42">)</span><span class="w"> </span><span class="n">function</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">run</span><span class="w"> </span><span class="n">before</span><span class="w"> </span><span class="n">any</span><span class="w"> </span><span class="n">other</span><span class="w"> </span><span class="n">sudo</span><span class="w"> </span><span class="n">plugin</span><span class="w"> </span><span class="nc">API</span><span class="w"> </span><span class="n">functions</span><span class="o">.</span><span class="w">  </span><span class="nc">This</span><span class="w"> </span><span class="n">makes</span><span class="w"> </span><span class="n">it</span><span class="w"> </span><span class="n">possible</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">audit</span><span class="w"> </span><span class="n">failures</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">other</span><span class="w"> </span><span class="n">plugins</span><span class="o">.</span><span class="w">  </span><span class="nc">It</span><span class="w"> </span><span class="n">returns</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">success</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="n">on</span><span class="w">
       </span><span class="n">failure</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mi">1</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">general</span><span class="w"> </span><span class="n">error</span><span class="w"> </span><span class="n">occurred</span><span class="p">,</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="o">-</span><span class="mi">2</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">there</span><span class="w"> </span><span class="n">was</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">usage</span><span class="w"> </span><span class="n">error</span><span class="o">.</span><span class="w">  </span><span class="nc">In</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">latter</span><span class="w"> </span><span class="k">case</span><span class="p">,</span><span class="w"> </span><span class="n">sudo</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">print</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">usage</span><span class="w"> </span><span class="n">message</span><span class="w"> </span><span class="n">before</span><span class="w"> </span><span class="n">it</span><span class="w"> </span><span class="n">exits</span><span class="o">.</span><span class="w">  </span><span class="nc">If</span><span class="w"> </span><span class="n">an</span><span class="w"> </span><span class="n">error</span><span class="w"> </span><span class="n">occurs</span><span class="p">,</span><span class="w"> </span><span class="n">the</span><span class="w">
       </span><span class="n">plugin</span><span class="w"> </span><span class="n">may</span><span class="w"> </span><span class="n">optionally</span><span class="w"> </span><span class="n">call</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">conversation</span><span class="p" data-group-id="0487223484-43">(</span><span class="p" data-group-id="0487223484-43">)</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">plugin_printf</span><span class="p" data-group-id="0487223484-44">(</span><span class="p" data-group-id="0487223484-44">)</span><span class="w"> </span><span class="n">function</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="nc">SUDO_CONF_ERROR_MSG</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">present</span><span class="w"> </span><span class="n">additional</span><span class="w"> </span><span class="n">error</span><span class="w"> </span><span class="n">information</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">user</span><span class="o">.</span><span class="w">

       </span><span class="nc">The</span><span class="w"> </span><span class="n">function</span><span class="w"> </span><span class="n">arguments</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="ss">follows</span><span class="p">:</span><span class="w">

       </span><span class="n">version</span><span class="w">
             </span><span class="nc">The</span><span class="w"> </span><span class="n">version</span><span class="w"> </span><span class="n">passed</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">sudo</span><span class="w"> </span><span class="n">allows</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">plugin</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">determine</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">major</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">minor</span><span class="w"> </span><span class="n">version</span><span class="w"> </span><span class="n">number</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">plugin</span><span class="w"> </span><span class="nc">API</span><span class="w"> </span><span class="n">supported</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">sudo</span><span class="o">.</span><span class="w">

       </span><span class="n">conversation</span><span class="w">
             </span><span class="nc">A</span><span class="w"> </span><span class="n">pointer</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">conversation</span><span class="p" data-group-id="0487223484-45">(</span><span class="p" data-group-id="0487223484-45">)</span><span class="w"> </span><span class="n">function</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">may</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">used</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">show_version</span><span class="p" data-group-id="0487223484-46">(</span><span class="p" data-group-id="0487223484-46">)</span><span class="w"> </span><span class="n">function</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">display</span><span class="w"> </span><span class="n">version</span><span class="w"> </span><span class="n">information</span><span class="w"> </span><span class="p" data-group-id="0487223484-47">(</span><span class="n">see</span><span class="w"> </span><span class="n">show_version</span><span class="p" data-group-id="0487223484-48">(</span><span class="p" data-group-id="0487223484-48">)</span><span class="w"> </span><span class="n">below</span><span class="p" data-group-id="0487223484-47">)</span><span class="o">.</span><span class="w">  </span><span class="nc">The</span><span class="w"> </span><span class="n">conversation</span><span class="p" data-group-id="0487223484-49">(</span><span class="p" data-group-id="0487223484-49">)</span><span class="w">
             </span><span class="n">function</span><span class="w"> </span><span class="n">may</span><span class="w"> </span><span class="n">also</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">used</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">display</span><span class="w"> </span><span class="n">additional</span><span class="w"> </span><span class="n">error</span><span class="w"> </span><span class="n">message</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">user</span><span class="o">.</span><span class="w">  </span><span class="nc">The</span><span class="w"> </span><span class="n">conversation</span><span class="p" data-group-id="0487223484-50">(</span><span class="p" data-group-id="0487223484-50">)</span><span class="w"> </span><span class="n">function</span><span class="w"> </span><span class="n">returns</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">success</span><span class="p">,</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="o">-</span><span class="mi">1</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">failure</span><span class="o">.</span><span class="w">

       </span><span class="n">plugin_printf</span><span class="w">
             </span><span class="nc">A</span><span class="w"> </span><span class="n">pointer</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">printf</span><span class="p" data-group-id="0487223484-51">(</span><span class="p" data-group-id="0487223484-51">)</span><span class="o">-</span><span class="n">style</span><span class="w"> </span><span class="n">function</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">may</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">used</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">show_version</span><span class="p" data-group-id="0487223484-52">(</span><span class="p" data-group-id="0487223484-52">)</span><span class="w"> </span><span class="n">function</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">display</span><span class="w"> </span><span class="n">version</span><span class="w"> </span><span class="n">information</span><span class="w"> </span><span class="p" data-group-id="0487223484-53">(</span><span class="n">see</span><span class="w"> </span><span class="n">show_version</span><span class="w"> </span><span class="n">below</span><span class="p" data-group-id="0487223484-53">)</span><span class="o">.</span><span class="w">  </span><span class="nc">The</span><span class="w"> </span><span class="n">plugin_printf</span><span class="p" data-group-id="0487223484-54">(</span><span class="p" data-group-id="0487223484-54">)</span><span class="w">
             </span><span class="n">function</span><span class="w"> </span><span class="n">may</span><span class="w"> </span><span class="n">also</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">used</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">display</span><span class="w"> </span><span class="n">additional</span><span class="w"> </span><span class="n">error</span><span class="w"> </span><span class="n">message</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">user</span><span class="o">.</span><span class="w">  </span><span class="nc">The</span><span class="w"> </span><span class="n">plugin_printf</span><span class="p" data-group-id="0487223484-55">(</span><span class="p" data-group-id="0487223484-55">)</span><span class="w"> </span><span class="n">function</span><span class="w"> </span><span class="n">returns</span><span class="w"> </span><span class="n">number</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">characters</span><span class="w"> </span><span class="n">printed</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">success</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="o">-</span><span class="mi">1</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">fail</span><span class="err">‐</span><span class="w">
             </span><span class="n">ure</span><span class="o">.</span><span class="w">

       </span><span class="n">settings</span><span class="w">
             </span><span class="nc">A</span><span class="w"> </span><span class="n">vector</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">user</span><span class="o">-</span><span class="n">supplied</span><span class="w"> </span><span class="n">sudo</span><span class="w"> </span><span class="n">settings</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">form</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="err">“</span><span class="n">name</span><span class="o">=</span><span class="n">value</span><span class="err">”</span><span class="w"> </span><span class="n">strings</span><span class="o">.</span><span class="w">  </span><span class="nc">The</span><span class="w"> </span><span class="n">vector</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">terminated</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="nc">NULL</span><span class="w"> </span><span class="n">pointer</span><span class="o">.</span><span class="w">  </span><span class="nc">These</span><span class="w"> </span><span class="n">settings</span><span class="w"> </span><span class="n">correspond</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">options</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">user</span><span class="w">
             </span><span class="n">specified</span><span class="w"> </span><span class="ow">when</span><span class="w"> </span><span class="n">running</span><span class="w"> </span><span class="n">sudo</span><span class="o">.</span><span class="w">  </span><span class="nc">As</span><span class="w"> </span><span class="n">such</span><span class="p">,</span><span class="w"> </span><span class="n">they</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">only</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">present</span><span class="w"> </span><span class="ow">when</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">corresponding</span><span class="w"> </span><span class="n">option</span><span class="w"> </span><span class="n">has</span><span class="w"> </span><span class="n">been</span><span class="w"> </span><span class="n">specified</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">command</span><span class="w"> </span><span class="n">line</span><span class="o">.</span><span class="w">

             </span><span class="nc">When</span><span class="w"> </span><span class="n">parsing</span><span class="w"> </span><span class="n">settings</span><span class="p">,</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">plugin</span><span class="w"> </span><span class="n">should</span><span class="w"> </span><span class="n">split</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">first</span><span class="w"> </span><span class="n">equal</span><span class="w"> </span><span class="n">sign</span><span class="w"> </span><span class="p" data-group-id="0487223484-56">(</span><span class="err">‘</span><span class="o">=</span><span class="err">’</span><span class="p" data-group-id="0487223484-56">)</span><span class="w"> </span><span class="n">since</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="n">field</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">never</span><span class="w"> </span><span class="n">include</span><span class="w"> </span><span class="n">one</span><span class="w"> </span><span class="n">itself</span><span class="w"> </span><span class="n">but</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">value</span><span class="w"> </span><span class="n">might</span><span class="o">.</span><span class="w">

             </span><span class="nc">See</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nc">Policy</span><span class="w"> </span><span class="n">plugin</span><span class="w"> </span><span class="nc">API</span><span class="w"> </span><span class="n">section</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">list</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">all</span><span class="w"> </span><span class="n">possible</span><span class="w"> </span><span class="n">settings</span><span class="o">.</span><span class="w">

       </span><span class="n">user_info</span><span class="w">
             </span><span class="nc">A</span><span class="w"> </span><span class="n">vector</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">information</span><span class="w"> </span><span class="n">about</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">user</span><span class="w"> </span><span class="n">running</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">command</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">form</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="err">“</span><span class="n">name</span><span class="o">=</span><span class="n">value</span><span class="err">”</span><span class="w"> </span><span class="n">strings</span><span class="o">.</span><span class="w">  </span><span class="nc">The</span><span class="w"> </span><span class="n">vector</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">terminated</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="nc">NULL</span><span class="w"> </span><span class="n">pointer</span><span class="o">.</span><span class="w">

             </span><span class="nc">When</span><span class="w"> </span><span class="n">parsing</span><span class="w"> </span><span class="n">user_info</span><span class="p">,</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">plugin</span><span class="w"> </span><span class="n">should</span><span class="w"> </span><span class="n">split</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">first</span><span class="w"> </span><span class="n">equal</span><span class="w"> </span><span class="n">sign</span><span class="w"> </span><span class="p" data-group-id="0487223484-57">(</span><span class="err">‘</span><span class="o">=</span><span class="err">’</span><span class="p" data-group-id="0487223484-57">)</span><span class="w"> </span><span class="n">since</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="n">field</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">never</span><span class="w"> </span><span class="n">include</span><span class="w"> </span><span class="n">one</span><span class="w"> </span><span class="n">itself</span><span class="w"> </span><span class="n">but</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">value</span><span class="w"> </span><span class="n">might</span><span class="o">.</span><span class="w">

             </span><span class="nc">See</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nc">Policy</span><span class="w"> </span><span class="n">plugin</span><span class="w"> </span><span class="nc">API</span><span class="w"> </span><span class="n">section</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">list</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">all</span><span class="w"> </span><span class="n">possible</span><span class="w"> </span><span class="n">strings</span><span class="o">.</span><span class="w">

       </span><span class="n">submit_optind</span><span class="w">
             </span><span class="nc">The</span><span class="w"> </span><span class="n">index</span><span class="w"> </span><span class="n">into</span><span class="w"> </span><span class="n">submit_argv</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">corresponds</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">first</span><span class="w"> </span><span class="n">entry</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">command</span><span class="w"> </span><span class="n">line</span><span class="w"> </span><span class="n">option</span><span class="o">.</span><span class="w">  </span><span class="nc">If</span><span class="w"> </span><span class="n">submit_argv</span><span class="w"> </span><span class="n">only</span><span class="w"> </span><span class="n">consists</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">options</span><span class="p">,</span><span class="w"> </span><span class="n">which</span><span class="w"> </span><span class="n">may</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="k">case</span><span class="w"> </span><span class="k">with</span><span class="w">
             </span><span class="n">the</span><span class="w"> </span><span class="o">-</span><span class="n">l</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="o">-</span><span class="n">v</span><span class="w"> </span><span class="n">options</span><span class="p">,</span><span class="w"> </span><span class="n">submit_argv</span><span class="p" data-group-id="0487223484-58">[</span><span class="n">submit_optind</span><span class="p" data-group-id="0487223484-58">]</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">evaluate</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nc">NULL</span><span class="w"> </span><span class="n">pointer</span><span class="o">.</span><span class="w">

       </span><span class="n">submit_argv</span><span class="w">
             </span><span class="nc">The</span><span class="w"> </span><span class="n">argument</span><span class="w"> </span><span class="n">vector</span><span class="w"> </span><span class="n">sudo</span><span class="w"> </span><span class="n">was</span><span class="w"> </span><span class="n">invoked</span><span class="w"> </span><span class="k">with</span><span class="p">,</span><span class="w"> </span><span class="n">including</span><span class="w"> </span><span class="n">all</span><span class="w"> </span><span class="n">command</span><span class="w"> </span><span class="n">line</span><span class="w"> </span><span class="n">options</span><span class="o">.</span><span class="w">  </span><span class="nc">The</span><span class="w"> </span><span class="n">submit_optind</span><span class="w"> </span><span class="n">argument</span><span class="w"> </span><span class="n">can</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">used</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">determine</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="k">end</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">command</span><span class="w"> </span><span class="n">line</span><span class="w"> </span><span class="n">options</span><span class="o">.</span><span class="w">

       </span><span class="n">submit_envp</span><span class="w">
             </span><span class="nc">The</span><span class="w"> </span><span class="n">invoking</span><span class="w"> </span><span class="n">user</span><span class="sc">&#39;s environment in the form of a NULL-terminated vector of “name=value” strings.

             When parsing submit_envp, the plugin should split on the first equal sign (‘=’) since the name field will never include one itself but the value might.

       plugin_options
             Any (non-comment) strings immediately after the plugin path are treated as arguments to the plugin.  These arguments are split on a white space boundary and are passed
             to the plugin in the form of a NULL-terminated array of strings.  If no arguments were specified, plugin_options will be the NULL pointer.

       errstr
             If the open() function returns a value other than 1, the plugin may store a message describing the failure or error in errstr.  The sudo front-end will then pass this
             value to any registered audit plugins.  The string stored in errstr must remain valid until the plugin&#39;</span><span class="n">s</span><span class="w"> </span><span class="n">close</span><span class="p" data-group-id="0487223484-59">(</span><span class="p" data-group-id="0487223484-59">)</span><span class="w"> </span><span class="n">function</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">called</span><span class="o">.</span><span class="w">

 </span><span class="n">close</span><span class="w">
       </span><span class="n">void</span><span class="w"> </span><span class="p" data-group-id="0487223484-60">(</span><span class="o">*</span><span class="n">close</span><span class="p" data-group-id="0487223484-60">)</span><span class="p" data-group-id="0487223484-61">(</span><span class="n">int</span><span class="w"> </span><span class="n">status_type</span><span class="p">,</span><span class="w"> </span><span class="n">int</span><span class="w"> </span><span class="n">status</span><span class="p" data-group-id="0487223484-61">)</span><span class="p">;</span><span class="w">

       </span><span class="nc">The</span><span class="w"> </span><span class="n">close</span><span class="p" data-group-id="0487223484-62">(</span><span class="p" data-group-id="0487223484-62">)</span><span class="w"> </span><span class="n">function</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">called</span><span class="w"> </span><span class="ow">when</span><span class="w"> </span><span class="n">sudo</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">finished</span><span class="p">,</span><span class="w"> </span><span class="n">shortly</span><span class="w"> </span><span class="n">before</span><span class="w"> </span><span class="n">it</span><span class="w"> </span><span class="n">exits</span><span class="o">.</span><span class="w">

       </span><span class="nc">The</span><span class="w"> </span><span class="n">function</span><span class="w"> </span><span class="n">arguments</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="ss">follows</span><span class="p">:</span><span class="w">

       </span><span class="n">status_type</span><span class="w">
             </span><span class="nc">The</span><span class="w"> </span><span class="n">type</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">status</span><span class="w"> </span><span class="n">being</span><span class="w"> </span><span class="n">passed</span><span class="o">.</span><span class="w">  </span><span class="nc">One</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="nc">SUDO_PLUGIN_NO_STATUS</span><span class="p">,</span><span class="w"> </span><span class="nc">SUDO_PLUGIN_WAIT_STATUS</span><span class="p">,</span><span class="w"> </span><span class="nc">SUDO_PLUGIN_EXEC_ERROR</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="nc">SUDO_PLUGIN_SUDO_ERROR</span><span class="o">.</span><span class="w">

       </span><span class="n">status</span><span class="w">
             </span><span class="nc">Depending</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">value</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">status_type</span><span class="p">,</span><span class="w"> </span><span class="n">this</span><span class="w"> </span><span class="n">value</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">either</span><span class="w"> </span><span class="n">ignored</span><span class="p">,</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">command</span><span class="sc">&#39;s exit status as returned by the wait(2) system call, the value of errno set by the
             execve(2) system call, or the value of errno resulting from an error in the sudo front-end.

 accept
       int (*accept)(const char *plugin_name, unsigned int plugin_type,
           char * const command_info[], char * const run_argv[],
           char * const run_envp[], const char **errstr);

       The accept() function is called when a command or action is accepted by a policy or approval plugin.  The function arguments are as follows:

       plugin_name
             The name of the plugin that accepted the command or “sudo” for the sudo front-end.

       plugin_type
             The type of plugin that accepted the command, currently either SUDO_POLICY_PLUGIN, SUDO_POLICY_APPROVAL, or SUDO_FRONT_END.  The accept() function is called multiple
             times--once for each policy or approval plugin that succeeds and once for the sudo front-end.  When called on behalf of the sudo front-end, command_info may include in‐
             formation from an I/O logging plugin as well.

             Typically, an audit plugin is interested in either the accept status from the sudo front-end or from the various policy and approval plugins, but not both.  It is pos‐
             sible for the policy plugin to accept a command that is later rejected by an approval plugin, in which case the audit plugin&#39;</span><span class="n">s</span><span class="w"> </span><span class="n">accept</span><span class="p" data-group-id="0487223484-63">(</span><span class="p" data-group-id="0487223484-63">)</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">reject</span><span class="p" data-group-id="0487223484-64">(</span><span class="p" data-group-id="0487223484-64">)</span><span class="w"> </span><span class="n">functions</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">both</span><span class="w">
             </span><span class="n">be</span><span class="w"> </span><span class="n">called</span><span class="o">.</span><span class="w">

       </span><span class="n">command_info</span><span class="w">
             </span><span class="nc">An</span><span class="w"> </span><span class="n">optional</span><span class="w"> </span><span class="n">vector</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">information</span><span class="w"> </span><span class="n">describing</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">command</span><span class="w"> </span><span class="n">being</span><span class="w"> </span><span class="n">run</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">form</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="err">“</span><span class="n">name</span><span class="o">=</span><span class="n">value</span><span class="err">”</span><span class="w"> </span><span class="n">strings</span><span class="o">.</span><span class="w">  </span><span class="nc">The</span><span class="w"> </span><span class="n">vector</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">terminated</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="nc">NULL</span><span class="w"> </span><span class="n">pointer</span><span class="o">.</span><span class="w">

             </span><span class="nc">When</span><span class="w"> </span><span class="n">parsing</span><span class="w"> </span><span class="n">command_info</span><span class="p">,</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">plugin</span><span class="w"> </span><span class="n">should</span><span class="w"> </span><span class="n">split</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">first</span><span class="w"> </span><span class="n">equal</span><span class="w"> </span><span class="n">sign</span><span class="w"> </span><span class="p" data-group-id="0487223484-65">(</span><span class="err">‘</span><span class="o">=</span><span class="err">’</span><span class="p" data-group-id="0487223484-65">)</span><span class="w"> </span><span class="n">since</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="n">field</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">never</span><span class="w"> </span><span class="n">include</span><span class="w"> </span><span class="n">one</span><span class="w"> </span><span class="n">itself</span><span class="w"> </span><span class="n">but</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">value</span><span class="w"> </span><span class="n">might</span><span class="o">.</span><span class="w">

             </span><span class="nc">See</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nc">Policy</span><span class="w"> </span><span class="n">plugin</span><span class="w"> </span><span class="nc">API</span><span class="w"> </span><span class="n">section</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">list</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">all</span><span class="w"> </span><span class="n">possible</span><span class="w"> </span><span class="n">strings</span><span class="o">.</span><span class="w">

       </span><span class="n">run_argv</span><span class="w">
             </span><span class="nc">A</span><span class="w"> </span><span class="nc">NULL</span><span class="o">-</span><span class="n">terminated</span><span class="w"> </span><span class="n">argument</span><span class="w"> </span><span class="n">vector</span><span class="w"> </span><span class="n">describing</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">command</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">run</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">same</span><span class="w"> </span><span class="n">form</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="n">what</span><span class="w"> </span><span class="n">would</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">passed</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">execve</span><span class="p" data-group-id="0487223484-66">(</span><span class="mi">2</span><span class="p" data-group-id="0487223484-66">)</span><span class="w"> </span><span class="n">system</span><span class="w"> </span><span class="n">call</span><span class="o">.</span><span class="w">

       </span><span class="n">run_envp</span><span class="w">
             </span><span class="nc">The</span><span class="w"> </span><span class="n">environment</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">command</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">run</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">form</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="nc">NULL</span><span class="o">-</span><span class="n">terminated</span><span class="w"> </span><span class="n">vector</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="err">“</span><span class="n">name</span><span class="o">=</span><span class="n">value</span><span class="err">”</span><span class="w"> </span><span class="n">strings</span><span class="o">.</span><span class="w">

             </span><span class="nc">When</span><span class="w"> </span><span class="n">parsing</span><span class="w"> </span><span class="n">run_envp</span><span class="p">,</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">plugin</span><span class="w"> </span><span class="n">should</span><span class="w"> </span><span class="n">split</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">first</span><span class="w"> </span><span class="n">equal</span><span class="w"> </span><span class="n">sign</span><span class="w"> </span><span class="p" data-group-id="0487223484-67">(</span><span class="err">‘</span><span class="o">=</span><span class="err">’</span><span class="p" data-group-id="0487223484-67">)</span><span class="w"> </span><span class="n">since</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="n">field</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">never</span><span class="w"> </span><span class="n">include</span><span class="w"> </span><span class="n">one</span><span class="w"> </span><span class="n">itself</span><span class="w"> </span><span class="n">but</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">value</span><span class="w"> </span><span class="n">might</span><span class="o">.</span><span class="w">

       </span><span class="n">errstr</span><span class="w">
             </span><span class="nc">If</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">accept</span><span class="p" data-group-id="0487223484-68">(</span><span class="p" data-group-id="0487223484-68">)</span><span class="w"> </span><span class="n">function</span><span class="w"> </span><span class="n">returns</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">value</span><span class="w"> </span><span class="n">other</span><span class="w"> </span><span class="n">than</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">plugin</span><span class="w"> </span><span class="n">may</span><span class="w"> </span><span class="n">store</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">message</span><span class="w"> </span><span class="n">describing</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">failure</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">error</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">errstr</span><span class="o">.</span><span class="w">  </span><span class="nc">The</span><span class="w"> </span><span class="n">sudo</span><span class="w"> </span><span class="n">front</span><span class="o">-</span><span class="k">end</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">then</span><span class="w"> </span><span class="n">pass</span><span class="w"> </span><span class="n">this</span><span class="w">
             </span><span class="n">value</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">any</span><span class="w"> </span><span class="n">registered</span><span class="w"> </span><span class="n">audit</span><span class="w"> </span><span class="n">plugins</span><span class="o">.</span><span class="w">  </span><span class="nc">The</span><span class="w"> </span><span class="n">string</span><span class="w"> </span><span class="n">stored</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">errstr</span><span class="w"> </span><span class="n">must</span><span class="w"> </span><span class="n">remain</span><span class="w"> </span><span class="n">valid</span><span class="w"> </span><span class="n">until</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">plugin</span><span class="sc">&#39;s close() function is called.

 reject
       int (*reject)(const char *plugin_name, unsigned int plugin_type,
           const char *audit_msg, char * const command_info[],
           const char **errstr);

       The reject() function is called when a command or action is rejected by a plugin.  The function arguments are as follows:

       plugin_name
             The name of the plugin that rejected the command.

       plugin_type
             The type of plugin that rejected the command, currently either SUDO_POLICY_PLUGIN, SUDO_APPROVAL_PLUGIN, or SUDO_IO_PLUGIN.

             Unlike the accept() function, the reject() function is not called on behalf of the sudo front-end.

       audit_msg
             An optional string describing the reason the command was rejected by the plugin.  If the plugin did not provide a reason, audit_msg will be the NULL pointer.

       command_info
             An optional vector of information describing the command being run in the form of “name=value” strings.  The vector is terminated by a NULL pointer.

             When parsing command_info, the plugin should split on the first equal sign (‘=’) since the name field will never include one itself but the value might.

             See the Policy plugin API section for a list of all possible strings.

       errstr
             If the reject() function returns a value other than 1, the plugin may store a message describing the failure or error in errstr.  The sudo front-end will then pass this
             value to any registered audit plugins.  The string stored in errstr must remain valid until the plugin&#39;</span><span class="n">s</span><span class="w"> </span><span class="n">close</span><span class="p" data-group-id="0487223484-69">(</span><span class="p" data-group-id="0487223484-69">)</span><span class="w"> </span><span class="n">function</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">called</span><span class="o">.</span><span class="w">

 </span><span class="n">error</span><span class="w">
       </span><span class="n">int</span><span class="w"> </span><span class="p" data-group-id="0487223484-70">(</span><span class="o">*</span><span class="n">error</span><span class="p" data-group-id="0487223484-70">)</span><span class="p" data-group-id="0487223484-71">(</span><span class="n">const</span><span class="w"> </span><span class="n">char</span><span class="w"> </span><span class="o">*</span><span class="n">plugin_name</span><span class="p">,</span><span class="w"> </span><span class="n">unsigned</span><span class="w"> </span><span class="n">int</span><span class="w"> </span><span class="n">plugin_type</span><span class="p">,</span><span class="w">
           </span><span class="n">const</span><span class="w"> </span><span class="n">char</span><span class="w"> </span><span class="o">*</span><span class="n">audit_msg</span><span class="p">,</span><span class="w"> </span><span class="n">char</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">const</span><span class="w"> </span><span class="n">command_info</span><span class="p" data-group-id="0487223484-72">[</span><span class="p" data-group-id="0487223484-72">]</span><span class="p">,</span><span class="w">
           </span><span class="n">const</span><span class="w"> </span><span class="n">char</span><span class="w"> </span><span class="o">*</span><span class="o">*</span><span class="n">errstr</span><span class="p" data-group-id="0487223484-71">)</span><span class="p">;</span><span class="w">

       </span><span class="nc">The</span><span class="w"> </span><span class="n">error</span><span class="p" data-group-id="0487223484-73">(</span><span class="p" data-group-id="0487223484-73">)</span><span class="w"> </span><span class="n">function</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">called</span><span class="w"> </span><span class="ow">when</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">plugin</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">sudo</span><span class="w"> </span><span class="n">front</span><span class="o">-</span><span class="k">end</span><span class="w"> </span><span class="n">returns</span><span class="w"> </span><span class="n">an</span><span class="w"> </span><span class="n">error</span><span class="o">.</span><span class="w">  </span><span class="nc">The</span><span class="w"> </span><span class="n">function</span><span class="w"> </span><span class="n">arguments</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="ss">follows</span><span class="p">:</span><span class="w">

       </span><span class="n">plugin_name</span><span class="w">
             </span><span class="nc">The</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">plugin</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">generated</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">error</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="err">“</span><span class="n">sudo</span><span class="err">”</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">sudo</span><span class="w"> </span><span class="n">front</span><span class="o">-</span><span class="k">end</span><span class="o">.</span><span class="w">

       </span><span class="n">plugin_type</span><span class="w">
             </span><span class="nc">The</span><span class="w"> </span><span class="n">type</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">plugin</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">generated</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">error</span><span class="p">,</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="nc">SUDO_FRONT_END</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">sudo</span><span class="w"> </span><span class="n">front</span><span class="o">-</span><span class="k">end</span><span class="o">.</span><span class="w">

       </span><span class="n">audit_msg</span><span class="w">
             </span><span class="nc">An</span><span class="w"> </span><span class="n">optional</span><span class="w"> </span><span class="n">string</span><span class="w"> </span><span class="n">describing</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">plugin</span><span class="w"> </span><span class="n">error</span><span class="o">.</span><span class="w">  </span><span class="nc">If</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">plugin</span><span class="w"> </span><span class="n">did</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">provide</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">description</span><span class="p">,</span><span class="w"> </span><span class="n">audit_msg</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nc">NULL</span><span class="w"> </span><span class="n">pointer</span><span class="o">.</span><span class="w">

       </span><span class="n">command_info</span><span class="w">
             </span><span class="nc">An</span><span class="w"> </span><span class="n">optional</span><span class="w"> </span><span class="n">vector</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">information</span><span class="w"> </span><span class="n">describing</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">command</span><span class="w"> </span><span class="n">being</span><span class="w"> </span><span class="n">run</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">form</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="err">“</span><span class="n">name</span><span class="o">=</span><span class="n">value</span><span class="err">”</span><span class="w"> </span><span class="n">strings</span><span class="o">.</span><span class="w">  </span><span class="nc">The</span><span class="w"> </span><span class="n">vector</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">terminated</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="nc">NULL</span><span class="w"> </span><span class="n">pointer</span><span class="o">.</span><span class="w">

             </span><span class="nc">When</span><span class="w"> </span><span class="n">parsing</span><span class="w"> </span><span class="n">command_info</span><span class="p">,</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">plugin</span><span class="w"> </span><span class="n">should</span><span class="w"> </span><span class="n">split</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">first</span><span class="w"> </span><span class="n">equal</span><span class="w"> </span><span class="n">sign</span><span class="w"> </span><span class="p" data-group-id="0487223484-74">(</span><span class="err">‘</span><span class="o">=</span><span class="err">’</span><span class="p" data-group-id="0487223484-74">)</span><span class="w"> </span><span class="n">since</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="n">field</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">never</span><span class="w"> </span><span class="n">include</span><span class="w"> </span><span class="n">one</span><span class="w"> </span><span class="n">itself</span><span class="w"> </span><span class="n">but</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">value</span><span class="w"> </span><span class="n">might</span><span class="o">.</span><span class="w">

             </span><span class="nc">See</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nc">Policy</span><span class="w"> </span><span class="n">plugin</span><span class="w"> </span><span class="nc">API</span><span class="w"> </span><span class="n">section</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">list</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">all</span><span class="w"> </span><span class="n">possible</span><span class="w"> </span><span class="n">strings</span><span class="o">.</span><span class="w">

       </span><span class="n">errstr</span><span class="w">
             </span><span class="nc">If</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">error</span><span class="p" data-group-id="0487223484-75">(</span><span class="p" data-group-id="0487223484-75">)</span><span class="w"> </span><span class="n">function</span><span class="w"> </span><span class="n">returns</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">value</span><span class="w"> </span><span class="n">other</span><span class="w"> </span><span class="n">than</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">plugin</span><span class="w"> </span><span class="n">may</span><span class="w"> </span><span class="n">store</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">message</span><span class="w"> </span><span class="n">describing</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">failure</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">error</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">errstr</span><span class="o">.</span><span class="w">  </span><span class="nc">The</span><span class="w"> </span><span class="n">sudo</span><span class="w"> </span><span class="n">front</span><span class="o">-</span><span class="k">end</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">then</span><span class="w"> </span><span class="n">pass</span><span class="w"> </span><span class="n">this</span><span class="w">
             </span><span class="n">value</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">any</span><span class="w"> </span><span class="n">registered</span><span class="w"> </span><span class="n">audit</span><span class="w"> </span><span class="n">plugins</span><span class="o">.</span><span class="w">  </span><span class="nc">The</span><span class="w"> </span><span class="n">string</span><span class="w"> </span><span class="n">stored</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">errstr</span><span class="w"> </span><span class="n">must</span><span class="w"> </span><span class="n">remain</span><span class="w"> </span><span class="n">valid</span><span class="w"> </span><span class="n">until</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">plugin</span><span class="sc">&#39;s close() function is called.

 show_version
       int (*show_version)(int verbose);

       The show_version() function is called by sudo when the user specifies the -V option.  The plugin may display its version information to the user via the conversation() or
       plugin_printf() function using SUDO_CONV_INFO_MSG.  If the user requests detailed version information, the verbose flag will be set.

       Returns 1 on success, 0 on failure, -1 if a general error occurred, or -2 if there was a usage error, although the return value is currently ignored.

 register_hooks
       See the Policy plugin API section for a description of register_hooks().

 deregister_hooks
       See the Policy plugin API section for a description of deregister_hooks().

 event_alloc
       struct sudo_plugin_event * (*event_alloc)(void);

       The event_alloc() function is used to allocate a struct sudo_plugin_event which provides access to the main sudo event loop.  Unlike the other fields, the event_alloc pointer
       is filled in by the sudo front-end, not by the plugin.

       See the Event API section below for more information about events.

       The event_alloc() function is only available starting with API version 1.17.  If the sudo front-end doesn&#39;</span><span class="n">t</span><span class="w"> </span><span class="n">support</span><span class="w"> </span><span class="nc">API</span><span class="w"> </span><span class="n">version</span><span class="w"> </span><span class="mf">1.17</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">higher</span><span class="p">,</span><span class="w"> </span><span class="n">event_alloc</span><span class="p" data-group-id="0487223484-76">(</span><span class="p" data-group-id="0487223484-76">)</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">set</span><span class="o">.</span></code></pre><p>   Approval plugin API</p><pre><code class="makeup elixir" translate="no"><span class="w"> </span><span class="n">struct</span><span class="w"> </span><span class="n">approval_plugin</span><span class="w"> </span><span class="p" data-group-id="2020683774-1">{</span><span class="w">
 </span><span class="c1">#define SUDO_APPROVAL_PLUGIN 4</span><span class="w">
     </span><span class="n">unsigned</span><span class="w"> </span><span class="n">int</span><span class="w"> </span><span class="n">type</span><span class="p">;</span><span class="w"> </span><span class="o">/</span><span class="o">*</span><span class="w"> </span><span class="n">always</span><span class="w"> </span><span class="nc">SUDO_APPROVAL_PLUGIN</span><span class="w"> </span><span class="o">*</span><span class="o">/</span><span class="w">
     </span><span class="n">unsigned</span><span class="w"> </span><span class="n">int</span><span class="w"> </span><span class="n">version</span><span class="p">;</span><span class="w"> </span><span class="o">/</span><span class="o">*</span><span class="w"> </span><span class="n">always</span><span class="w"> </span><span class="nc">SUDO_API_VERSION</span><span class="w"> </span><span class="o">*</span><span class="o">/</span><span class="w">
     </span><span class="n">int</span><span class="w"> </span><span class="p" data-group-id="2020683774-2">(</span><span class="o">*</span><span class="n">open</span><span class="p" data-group-id="2020683774-2">)</span><span class="p" data-group-id="2020683774-3">(</span><span class="n">unsigned</span><span class="w"> </span><span class="n">int</span><span class="w"> </span><span class="n">version</span><span class="p">,</span><span class="w"> </span><span class="n">sudo_conv_t</span><span class="w"> </span><span class="n">conversation</span><span class="p">,</span><span class="w">
         </span><span class="n">sudo_printf_t</span><span class="w"> </span><span class="n">sudo_plugin_printf</span><span class="p">,</span><span class="w"> </span><span class="n">char</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">const</span><span class="w"> </span><span class="n">settings</span><span class="p" data-group-id="2020683774-4">[</span><span class="p" data-group-id="2020683774-4">]</span><span class="p">,</span><span class="w">
         </span><span class="n">char</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">const</span><span class="w"> </span><span class="n">user_info</span><span class="p" data-group-id="2020683774-5">[</span><span class="p" data-group-id="2020683774-5">]</span><span class="p">,</span><span class="w"> </span><span class="n">int</span><span class="w"> </span><span class="n">submit_optind</span><span class="p">,</span><span class="w">
         </span><span class="n">char</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">const</span><span class="w"> </span><span class="n">submit_argv</span><span class="p" data-group-id="2020683774-6">[</span><span class="p" data-group-id="2020683774-6">]</span><span class="p">,</span><span class="w"> </span><span class="n">char</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">const</span><span class="w"> </span><span class="n">submit_envp</span><span class="p" data-group-id="2020683774-7">[</span><span class="p" data-group-id="2020683774-7">]</span><span class="p">,</span><span class="w">
         </span><span class="n">char</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">const</span><span class="w"> </span><span class="n">plugin_options</span><span class="p" data-group-id="2020683774-8">[</span><span class="p" data-group-id="2020683774-8">]</span><span class="p">,</span><span class="w"> </span><span class="n">const</span><span class="w"> </span><span class="n">char</span><span class="w"> </span><span class="o">*</span><span class="o">*</span><span class="n">errstr</span><span class="p" data-group-id="2020683774-3">)</span><span class="p">;</span><span class="w">
     </span><span class="n">void</span><span class="w"> </span><span class="p" data-group-id="2020683774-9">(</span><span class="o">*</span><span class="n">close</span><span class="p" data-group-id="2020683774-9">)</span><span class="p" data-group-id="2020683774-10">(</span><span class="n">void</span><span class="p" data-group-id="2020683774-10">)</span><span class="p">;</span><span class="w">
     </span><span class="n">int</span><span class="w"> </span><span class="p" data-group-id="2020683774-11">(</span><span class="o">*</span><span class="n">check</span><span class="p" data-group-id="2020683774-11">)</span><span class="p" data-group-id="2020683774-12">(</span><span class="n">char</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">const</span><span class="w"> </span><span class="n">command_info</span><span class="p" data-group-id="2020683774-13">[</span><span class="p" data-group-id="2020683774-13">]</span><span class="p">,</span><span class="w"> </span><span class="n">char</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">const</span><span class="w"> </span><span class="n">run_argv</span><span class="p" data-group-id="2020683774-14">[</span><span class="p" data-group-id="2020683774-14">]</span><span class="p">,</span><span class="w">
         </span><span class="n">char</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">const</span><span class="w"> </span><span class="n">run_envp</span><span class="p" data-group-id="2020683774-15">[</span><span class="p" data-group-id="2020683774-15">]</span><span class="p">,</span><span class="w"> </span><span class="n">const</span><span class="w"> </span><span class="n">char</span><span class="w"> </span><span class="o">*</span><span class="o">*</span><span class="n">errstr</span><span class="p" data-group-id="2020683774-12">)</span><span class="p">;</span><span class="w">
     </span><span class="n">int</span><span class="w"> </span><span class="p" data-group-id="2020683774-16">(</span><span class="o">*</span><span class="n">show_version</span><span class="p" data-group-id="2020683774-16">)</span><span class="p" data-group-id="2020683774-17">(</span><span class="n">int</span><span class="w"> </span><span class="n">verbose</span><span class="p" data-group-id="2020683774-17">)</span><span class="p">;</span><span class="w">
 </span><span class="p" data-group-id="2020683774-1">}</span><span class="p">;</span><span class="w">

 </span><span class="nc">An</span><span class="w"> </span><span class="n">approval</span><span class="w"> </span><span class="n">plugin</span><span class="w"> </span><span class="n">can</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">used</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">apply</span><span class="w"> </span><span class="n">extra</span><span class="w"> </span><span class="n">constraints</span><span class="w"> </span><span class="k">after</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">command</span><span class="w"> </span><span class="n">has</span><span class="w"> </span><span class="n">been</span><span class="w"> </span><span class="n">accepted</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">policy</span><span class="w"> </span><span class="n">plugin</span><span class="o">.</span><span class="w">  </span><span class="nc">Unlike</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">other</span><span class="w"> </span><span class="n">plugin</span><span class="w"> </span><span class="n">types</span><span class="p">,</span><span class="w"> </span><span class="n">it</span><span class="w"> </span><span class="n">does</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">remain</span><span class="w"> </span><span class="n">open</span><span class="w"> </span><span class="n">until</span><span class="w"> </span><span class="n">the</span><span class="w">
 </span><span class="n">command</span><span class="w"> </span><span class="n">completes</span><span class="o">.</span><span class="w">  </span><span class="nc">The</span><span class="w"> </span><span class="n">plugin</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">opened</span><span class="w"> </span><span class="n">before</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">call</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">check</span><span class="p" data-group-id="2020683774-18">(</span><span class="p" data-group-id="2020683774-18">)</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">show_version</span><span class="p" data-group-id="2020683774-19">(</span><span class="p" data-group-id="2020683774-19">)</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">closed</span><span class="w"> </span><span class="n">shortly</span><span class="w"> </span><span class="n">thereafter</span><span class="w"> </span><span class="p" data-group-id="2020683774-20">(</span><span class="n">audit</span><span class="w"> </span><span class="n">plugin</span><span class="w"> </span><span class="n">functions</span><span class="w"> </span><span class="n">must</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">called</span><span class="w"> </span><span class="n">before</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">plugin</span><span class="w"> </span><span class="n">is</span><span class="w">
 </span><span class="n">closed</span><span class="p" data-group-id="2020683774-20">)</span><span class="o">.</span><span class="w">  </span><span class="nc">Multiple</span><span class="w"> </span><span class="n">approval</span><span class="w"> </span><span class="n">plugins</span><span class="w"> </span><span class="n">may</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">specified</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">sudo</span><span class="o">.</span><span class="n">conf</span><span class="p" data-group-id="2020683774-21">(</span><span class="mi">5</span><span class="p" data-group-id="2020683774-21">)</span><span class="o">.</span><span class="w">

 </span><span class="nc">A</span><span class="w"> </span><span class="n">struct</span><span class="w"> </span><span class="n">approval_plugin</span><span class="w"> </span><span class="n">has</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">following</span><span class="w"> </span><span class="ss">fields</span><span class="p">:</span><span class="w">

 </span><span class="n">type</span><span class="w">  </span><span class="nc">The</span><span class="w"> </span><span class="n">type</span><span class="w"> </span><span class="n">field</span><span class="w"> </span><span class="n">should</span><span class="w"> </span><span class="n">always</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">set</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="nc">SUDO_APPROVAL_PLUGIN</span><span class="o">.</span><span class="w">

 </span><span class="n">version</span><span class="w">
       </span><span class="nc">The</span><span class="w"> </span><span class="n">version</span><span class="w"> </span><span class="n">field</span><span class="w"> </span><span class="n">should</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">set</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="nc">SUDO_API_VERSION</span><span class="o">.</span><span class="w">

       </span><span class="nc">This</span><span class="w"> </span><span class="n">allows</span><span class="w"> </span><span class="n">sudo</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">determine</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nc">API</span><span class="w"> </span><span class="n">version</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">plugin</span><span class="w"> </span><span class="n">was</span><span class="w"> </span><span class="n">built</span><span class="w"> </span><span class="n">against</span><span class="o">.</span><span class="w">

 </span><span class="n">open</span><span class="w">
       </span><span class="n">int</span><span class="w"> </span><span class="p" data-group-id="2020683774-22">(</span><span class="o">*</span><span class="n">open</span><span class="p" data-group-id="2020683774-22">)</span><span class="p" data-group-id="2020683774-23">(</span><span class="n">unsigned</span><span class="w"> </span><span class="n">int</span><span class="w"> </span><span class="n">version</span><span class="p">,</span><span class="w"> </span><span class="n">sudo_conv_t</span><span class="w"> </span><span class="n">conversation</span><span class="p">,</span><span class="w">
           </span><span class="n">sudo_printf_t</span><span class="w"> </span><span class="n">sudo_plugin_printf</span><span class="p">,</span><span class="w"> </span><span class="n">char</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">const</span><span class="w"> </span><span class="n">settings</span><span class="p" data-group-id="2020683774-24">[</span><span class="p" data-group-id="2020683774-24">]</span><span class="p">,</span><span class="w">
           </span><span class="n">char</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">const</span><span class="w"> </span><span class="n">user_info</span><span class="p" data-group-id="2020683774-25">[</span><span class="p" data-group-id="2020683774-25">]</span><span class="p">,</span><span class="w"> </span><span class="n">int</span><span class="w"> </span><span class="n">submit_optind</span><span class="p">,</span><span class="w">
           </span><span class="n">char</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">const</span><span class="w"> </span><span class="n">submit_argv</span><span class="p" data-group-id="2020683774-26">[</span><span class="p" data-group-id="2020683774-26">]</span><span class="p">,</span><span class="w"> </span><span class="n">char</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">const</span><span class="w"> </span><span class="n">submit_envp</span><span class="p" data-group-id="2020683774-27">[</span><span class="p" data-group-id="2020683774-27">]</span><span class="p">,</span><span class="w">
           </span><span class="n">char</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">const</span><span class="w"> </span><span class="n">plugin_options</span><span class="p" data-group-id="2020683774-28">[</span><span class="p" data-group-id="2020683774-28">]</span><span class="p">,</span><span class="w"> </span><span class="n">const</span><span class="w"> </span><span class="n">char</span><span class="w"> </span><span class="o">*</span><span class="o">*</span><span class="n">errstr</span><span class="p" data-group-id="2020683774-23">)</span><span class="p">;</span><span class="w">

       </span><span class="nc">The</span><span class="w"> </span><span class="n">approval</span><span class="w"> </span><span class="n">open</span><span class="p" data-group-id="2020683774-29">(</span><span class="p" data-group-id="2020683774-29">)</span><span class="w"> </span><span class="n">function</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">run</span><span class="w"> </span><span class="n">immediately</span><span class="w"> </span><span class="n">before</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">call</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">plugin</span><span class="sc">&#39;s check() or show_version() functions.  It is only called if the version is being requested or if
       the policy plugin&#39;</span><span class="n">s</span><span class="w"> </span><span class="n">check_policy</span><span class="p" data-group-id="2020683774-30">(</span><span class="p" data-group-id="2020683774-30">)</span><span class="w"> </span><span class="n">function</span><span class="w"> </span><span class="n">has</span><span class="w"> </span><span class="n">returned</span><span class="w"> </span><span class="n">successfully</span><span class="o">.</span><span class="w">  </span><span class="nc">It</span><span class="w"> </span><span class="n">returns</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">success</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">failure</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mi">1</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">general</span><span class="w"> </span><span class="n">error</span><span class="w"> </span><span class="n">occurred</span><span class="p">,</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="o">-</span><span class="mi">2</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">there</span><span class="w"> </span><span class="n">was</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">usage</span><span class="w"> </span><span class="n">er</span><span class="err">‐</span><span class="w">
       </span><span class="n">ror</span><span class="o">.</span><span class="w">  </span><span class="nc">In</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">latter</span><span class="w"> </span><span class="k">case</span><span class="p">,</span><span class="w"> </span><span class="n">sudo</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">print</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">usage</span><span class="w"> </span><span class="n">message</span><span class="w"> </span><span class="n">before</span><span class="w"> </span><span class="n">it</span><span class="w"> </span><span class="n">exits</span><span class="o">.</span><span class="w">  </span><span class="nc">If</span><span class="w"> </span><span class="n">an</span><span class="w"> </span><span class="n">error</span><span class="w"> </span><span class="n">occurs</span><span class="p">,</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">plugin</span><span class="w"> </span><span class="n">may</span><span class="w"> </span><span class="n">optionally</span><span class="w"> </span><span class="n">call</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">conversation</span><span class="p" data-group-id="2020683774-31">(</span><span class="p" data-group-id="2020683774-31">)</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">plugin_printf</span><span class="p" data-group-id="2020683774-32">(</span><span class="p" data-group-id="2020683774-32">)</span><span class="w"> </span><span class="n">function</span><span class="w">
       </span><span class="k">with</span><span class="w"> </span><span class="nc">SUDO_CONF_ERROR_MSG</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">present</span><span class="w"> </span><span class="n">additional</span><span class="w"> </span><span class="n">error</span><span class="w"> </span><span class="n">information</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">user</span><span class="o">.</span><span class="w">

       </span><span class="nc">The</span><span class="w"> </span><span class="n">function</span><span class="w"> </span><span class="n">arguments</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="ss">follows</span><span class="p">:</span><span class="w">

       </span><span class="n">version</span><span class="w">
             </span><span class="nc">The</span><span class="w"> </span><span class="n">version</span><span class="w"> </span><span class="n">passed</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">sudo</span><span class="w"> </span><span class="n">allows</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">plugin</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">determine</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">major</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">minor</span><span class="w"> </span><span class="n">version</span><span class="w"> </span><span class="n">number</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">plugin</span><span class="w"> </span><span class="nc">API</span><span class="w"> </span><span class="n">supported</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">sudo</span><span class="o">.</span><span class="w">

       </span><span class="n">conversation</span><span class="w">
             </span><span class="nc">A</span><span class="w"> </span><span class="n">pointer</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">conversation</span><span class="p" data-group-id="2020683774-33">(</span><span class="p" data-group-id="2020683774-33">)</span><span class="w"> </span><span class="n">function</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">can</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">used</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">plugin</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">interact</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">user</span><span class="w"> </span><span class="p" data-group-id="2020683774-34">(</span><span class="n">see</span><span class="w"> </span><span class="nc">Conversation</span><span class="w"> </span><span class="nc">API</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">details</span><span class="p" data-group-id="2020683774-34">)</span><span class="o">.</span><span class="w">  </span><span class="nc">Returns</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">success</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="o">-</span><span class="mi">1</span><span class="w"> </span><span class="n">on</span><span class="w">
             </span><span class="n">failure</span><span class="o">.</span><span class="w">

       </span><span class="n">plugin_printf</span><span class="w">
             </span><span class="nc">A</span><span class="w"> </span><span class="n">pointer</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">printf</span><span class="p" data-group-id="2020683774-35">(</span><span class="p" data-group-id="2020683774-35">)</span><span class="o">-</span><span class="n">style</span><span class="w"> </span><span class="n">function</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">may</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">used</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">display</span><span class="w"> </span><span class="n">informational</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">error</span><span class="w"> </span><span class="n">messages</span><span class="w"> </span><span class="p" data-group-id="2020683774-36">(</span><span class="n">see</span><span class="w"> </span><span class="nc">Conversation</span><span class="w"> </span><span class="nc">API</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">details</span><span class="p" data-group-id="2020683774-36">)</span><span class="o">.</span><span class="w">  </span><span class="nc">Returns</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">number</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">characters</span><span class="w">
             </span><span class="n">printed</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">success</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="o">-</span><span class="mi">1</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">failure</span><span class="o">.</span><span class="w">

       </span><span class="n">settings</span><span class="w">
             </span><span class="nc">A</span><span class="w"> </span><span class="n">vector</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">user</span><span class="o">-</span><span class="n">supplied</span><span class="w"> </span><span class="n">sudo</span><span class="w"> </span><span class="n">settings</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">form</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="err">“</span><span class="n">name</span><span class="o">=</span><span class="n">value</span><span class="err">”</span><span class="w"> </span><span class="n">strings</span><span class="o">.</span><span class="w">  </span><span class="nc">The</span><span class="w"> </span><span class="n">vector</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">terminated</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="nc">NULL</span><span class="w"> </span><span class="n">pointer</span><span class="o">.</span><span class="w">  </span><span class="nc">These</span><span class="w"> </span><span class="n">settings</span><span class="w"> </span><span class="n">correspond</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">options</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">user</span><span class="w">
             </span><span class="n">specified</span><span class="w"> </span><span class="ow">when</span><span class="w"> </span><span class="n">running</span><span class="w"> </span><span class="n">sudo</span><span class="o">.</span><span class="w">  </span><span class="nc">As</span><span class="w"> </span><span class="n">such</span><span class="p">,</span><span class="w"> </span><span class="n">they</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">only</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">present</span><span class="w"> </span><span class="ow">when</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">corresponding</span><span class="w"> </span><span class="n">option</span><span class="w"> </span><span class="n">has</span><span class="w"> </span><span class="n">been</span><span class="w"> </span><span class="n">specified</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">command</span><span class="w"> </span><span class="n">line</span><span class="o">.</span><span class="w">

             </span><span class="nc">When</span><span class="w"> </span><span class="n">parsing</span><span class="w"> </span><span class="n">settings</span><span class="p">,</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">plugin</span><span class="w"> </span><span class="n">should</span><span class="w"> </span><span class="n">split</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">first</span><span class="w"> </span><span class="n">equal</span><span class="w"> </span><span class="n">sign</span><span class="w"> </span><span class="p" data-group-id="2020683774-37">(</span><span class="err">‘</span><span class="o">=</span><span class="err">’</span><span class="p" data-group-id="2020683774-37">)</span><span class="w"> </span><span class="n">since</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="n">field</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">never</span><span class="w"> </span><span class="n">include</span><span class="w"> </span><span class="n">one</span><span class="w"> </span><span class="n">itself</span><span class="w"> </span><span class="n">but</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">value</span><span class="w"> </span><span class="n">might</span><span class="o">.</span><span class="w">

             </span><span class="nc">See</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nc">Policy</span><span class="w"> </span><span class="n">plugin</span><span class="w"> </span><span class="nc">API</span><span class="w"> </span><span class="n">section</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">list</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">all</span><span class="w"> </span><span class="n">possible</span><span class="w"> </span><span class="n">settings</span><span class="o">.</span><span class="w">

       </span><span class="n">user_info</span><span class="w">
             </span><span class="nc">A</span><span class="w"> </span><span class="n">vector</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">information</span><span class="w"> </span><span class="n">about</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">user</span><span class="w"> </span><span class="n">running</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">command</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">form</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="err">“</span><span class="n">name</span><span class="o">=</span><span class="n">value</span><span class="err">”</span><span class="w"> </span><span class="n">strings</span><span class="o">.</span><span class="w">  </span><span class="nc">The</span><span class="w"> </span><span class="n">vector</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">terminated</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="nc">NULL</span><span class="w"> </span><span class="n">pointer</span><span class="o">.</span><span class="w">

             </span><span class="nc">When</span><span class="w"> </span><span class="n">parsing</span><span class="w"> </span><span class="n">user_info</span><span class="p">,</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">plugin</span><span class="w"> </span><span class="n">should</span><span class="w"> </span><span class="n">split</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">first</span><span class="w"> </span><span class="n">equal</span><span class="w"> </span><span class="n">sign</span><span class="w"> </span><span class="p" data-group-id="2020683774-38">(</span><span class="err">‘</span><span class="o">=</span><span class="err">’</span><span class="p" data-group-id="2020683774-38">)</span><span class="w"> </span><span class="n">since</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="n">field</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">never</span><span class="w"> </span><span class="n">include</span><span class="w"> </span><span class="n">one</span><span class="w"> </span><span class="n">itself</span><span class="w"> </span><span class="n">but</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">value</span><span class="w"> </span><span class="n">might</span><span class="o">.</span><span class="w">

             </span><span class="nc">See</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nc">Policy</span><span class="w"> </span><span class="n">plugin</span><span class="w"> </span><span class="nc">API</span><span class="w"> </span><span class="n">section</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">list</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">all</span><span class="w"> </span><span class="n">possible</span><span class="w"> </span><span class="n">strings</span><span class="o">.</span><span class="w">

       </span><span class="n">submit_optind</span><span class="w">
             </span><span class="nc">The</span><span class="w"> </span><span class="n">index</span><span class="w"> </span><span class="n">into</span><span class="w"> </span><span class="n">submit_argv</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">corresponds</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">first</span><span class="w"> </span><span class="n">entry</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">command</span><span class="w"> </span><span class="n">line</span><span class="w"> </span><span class="n">option</span><span class="o">.</span><span class="w">  </span><span class="nc">If</span><span class="w"> </span><span class="n">submit_argv</span><span class="w"> </span><span class="n">only</span><span class="w"> </span><span class="n">consists</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">options</span><span class="p">,</span><span class="w"> </span><span class="n">which</span><span class="w"> </span><span class="n">may</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="k">case</span><span class="w"> </span><span class="k">with</span><span class="w">
             </span><span class="n">the</span><span class="w"> </span><span class="o">-</span><span class="n">l</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="o">-</span><span class="n">v</span><span class="w"> </span><span class="n">options</span><span class="p">,</span><span class="w"> </span><span class="n">submit_argv</span><span class="p" data-group-id="2020683774-39">[</span><span class="n">submit_optind</span><span class="p" data-group-id="2020683774-39">]</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">evaluate</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nc">NULL</span><span class="w"> </span><span class="n">pointer</span><span class="o">.</span><span class="w">

       </span><span class="n">submit_argv</span><span class="w">
             </span><span class="nc">The</span><span class="w"> </span><span class="n">argument</span><span class="w"> </span><span class="n">vector</span><span class="w"> </span><span class="n">sudo</span><span class="w"> </span><span class="n">was</span><span class="w"> </span><span class="n">invoked</span><span class="w"> </span><span class="k">with</span><span class="p">,</span><span class="w"> </span><span class="n">including</span><span class="w"> </span><span class="n">all</span><span class="w"> </span><span class="n">command</span><span class="w"> </span><span class="n">line</span><span class="w"> </span><span class="n">options</span><span class="o">.</span><span class="w">  </span><span class="nc">The</span><span class="w"> </span><span class="n">submit_optind</span><span class="w"> </span><span class="n">argument</span><span class="w"> </span><span class="n">can</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">used</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">determine</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="k">end</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">command</span><span class="w"> </span><span class="n">line</span><span class="w"> </span><span class="n">options</span><span class="o">.</span><span class="w">

       </span><span class="n">submit_envp</span><span class="w">
             </span><span class="nc">The</span><span class="w"> </span><span class="n">invoking</span><span class="w"> </span><span class="n">user</span><span class="sc">&#39;s environment in the form of a NULL-terminated vector of “name=value” strings.

             When parsing submit_envp, the plugin should split on the first equal sign (‘=’) since the name field will never include one itself but the value might.

       plugin_options
             Any (non-comment) strings immediately after the plugin path are treated as arguments to the plugin.  These arguments are split on a white space boundary and are passed
             to the plugin in the form of a NULL-terminated array of strings.  If no arguments were specified, plugin_options will be the NULL pointer.

       errstr
             If the open() function returns a value other than 1, the plugin may store a message describing the failure or error in errstr.  The sudo front-end will then pass this
             value to any registered audit plugins.  The string stored in errstr must remain valid until the plugin&#39;</span><span class="n">s</span><span class="w"> </span><span class="n">close</span><span class="p" data-group-id="2020683774-40">(</span><span class="p" data-group-id="2020683774-40">)</span><span class="w"> </span><span class="n">function</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">called</span><span class="o">.</span><span class="w">

 </span><span class="n">close</span><span class="w">
       </span><span class="n">void</span><span class="w"> </span><span class="p" data-group-id="2020683774-41">(</span><span class="o">*</span><span class="n">close</span><span class="p" data-group-id="2020683774-41">)</span><span class="p" data-group-id="2020683774-42">(</span><span class="n">void</span><span class="p" data-group-id="2020683774-42">)</span><span class="p">;</span><span class="w">

       </span><span class="nc">The</span><span class="w"> </span><span class="n">close</span><span class="p" data-group-id="2020683774-43">(</span><span class="p" data-group-id="2020683774-43">)</span><span class="w"> </span><span class="n">function</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">called</span><span class="w"> </span><span class="k">after</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">approval</span><span class="w"> </span><span class="n">plugin</span><span class="sc">&#39;s check() or show_version() functions have been called.  It takes no arguments.  The close() function is typically
       used to perform plugin-specific cleanup, such as the freeing of memory objects allocated by the plugin.  If the plugin does not need to perform any cleanup, close() may be
       set to the NULL pointer.

 check
       int (*check)(char * const command_info[], char * const run_argv[],
           char * const run_envp[], const char **errstr);

       The approval check() function is run after the policy plugin check_policy() function and before any I/O logging plugins.  If multiple approval plugins are loaded, they must
       all succeed for the command to be allowed.  It returns 1 on success, 0 on failure, -1 if a general error occurred, or -2 if there was a usage error.  In the latter case, sudo
       will print a usage message before it exits.  If an error occurs, the plugin may optionally call the conversation() or plugin_printf() function with SUDO_CONF_ERROR_MSG to
       present additional error information to the user.

       The function arguments are as follows:

       command_info
             A vector of information describing the command being run in the form of “name=value” strings.  The vector is terminated by a NULL pointer.

             When parsing command_info, the plugin should split on the first equal sign (‘=’) since the name field will never include one itself but the value might.

             See the Policy plugin API section for a list of all possible strings.

       run_argv
             A NULL-terminated argument vector describing a command that will be run in the same form as what would be passed to the execve(2) system call.

       run_envp
             The environment the command will be run with in the form of a NULL-terminated vector of “name=value” strings.

             When parsing run_envp, the plugin should split on the first equal sign (‘=’) since the name field will never include one itself but the value might.

       errstr
             If the open() function returns a value other than 1, the plugin may store a message describing the failure or error in errstr.  The sudo front-end will then pass this
             value to any registered audit plugins.  The string stored in errstr must remain valid until the plugin&#39;</span><span class="n">s</span><span class="w"> </span><span class="n">close</span><span class="p" data-group-id="2020683774-44">(</span><span class="p" data-group-id="2020683774-44">)</span><span class="w"> </span><span class="n">function</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">called</span><span class="o">.</span><span class="w">

 </span><span class="n">show_version</span><span class="w">
       </span><span class="n">int</span><span class="w"> </span><span class="p" data-group-id="2020683774-45">(</span><span class="o">*</span><span class="n">show_version</span><span class="p" data-group-id="2020683774-45">)</span><span class="p" data-group-id="2020683774-46">(</span><span class="n">int</span><span class="w"> </span><span class="n">verbose</span><span class="p" data-group-id="2020683774-46">)</span><span class="p">;</span><span class="w">

       </span><span class="nc">The</span><span class="w"> </span><span class="n">show_version</span><span class="p" data-group-id="2020683774-47">(</span><span class="p" data-group-id="2020683774-47">)</span><span class="w"> </span><span class="n">function</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">called</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">sudo</span><span class="w"> </span><span class="ow">when</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">user</span><span class="w"> </span><span class="n">specifies</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="o">-</span><span class="nc">V</span><span class="w"> </span><span class="n">option</span><span class="o">.</span><span class="w">  </span><span class="nc">The</span><span class="w"> </span><span class="n">plugin</span><span class="w"> </span><span class="n">may</span><span class="w"> </span><span class="n">display</span><span class="w"> </span><span class="n">its</span><span class="w"> </span><span class="n">version</span><span class="w"> </span><span class="n">information</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">user</span><span class="w"> </span><span class="n">via</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">conversation</span><span class="p" data-group-id="2020683774-48">(</span><span class="p" data-group-id="2020683774-48">)</span><span class="w"> </span><span class="ow">or</span><span class="w">
       </span><span class="n">plugin_printf</span><span class="p" data-group-id="2020683774-49">(</span><span class="p" data-group-id="2020683774-49">)</span><span class="w"> </span><span class="n">function</span><span class="w"> </span><span class="n">using</span><span class="w"> </span><span class="nc">SUDO_CONV_INFO_MSG</span><span class="o">.</span><span class="w">  </span><span class="nc">If</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">user</span><span class="w"> </span><span class="n">requests</span><span class="w"> </span><span class="n">detailed</span><span class="w"> </span><span class="n">version</span><span class="w"> </span><span class="n">information</span><span class="p">,</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">verbose</span><span class="w"> </span><span class="n">flag</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">set</span><span class="o">.</span><span class="w">

       </span><span class="nc">Returns</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">success</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">failure</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mi">1</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">general</span><span class="w"> </span><span class="n">error</span><span class="w"> </span><span class="n">occurred</span><span class="p">,</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="o">-</span><span class="mi">2</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">there</span><span class="w"> </span><span class="n">was</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">usage</span><span class="w"> </span><span class="n">error</span><span class="p">,</span><span class="w"> </span><span class="n">although</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">return</span><span class="w"> </span><span class="n">value</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">currently</span><span class="w"> </span><span class="n">ignored</span><span class="o">.</span></code></pre><p>   Signal handlers</p><pre><code class="makeup elixir" translate="no"><span class="w"> </span><span class="nc">The</span><span class="w"> </span><span class="n">sudo</span><span class="w"> </span><span class="n">front</span><span class="o">-</span><span class="k">end</span><span class="w"> </span><span class="n">installs</span><span class="w"> </span><span class="n">default</span><span class="w"> </span><span class="n">signal</span><span class="w"> </span><span class="n">handlers</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">trap</span><span class="w"> </span><span class="n">common</span><span class="w"> </span><span class="n">signals</span><span class="w"> </span><span class="n">while</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">plugin</span><span class="w"> </span><span class="n">functions</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">run</span><span class="o">.</span><span class="w">  </span><span class="nc">The</span><span class="w"> </span><span class="n">following</span><span class="w"> </span><span class="n">signals</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">trapped</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">default</span><span class="w"> </span><span class="n">before</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">command</span><span class="w"> </span><span class="n">is</span><span class="w">
 </span><span class="ss">executed</span><span class="p">:</span><span class="w">

 </span><span class="err">•</span><span class="w">  </span><span class="nc">SIGALRM</span><span class="w">
 </span><span class="err">•</span><span class="w">  </span><span class="nc">SIGHUP</span><span class="w">
 </span><span class="err">•</span><span class="w">  </span><span class="nc">SIGINT</span><span class="w">
 </span><span class="err">•</span><span class="w">  </span><span class="nc">SIGPIPE</span><span class="w">
 </span><span class="err">•</span><span class="w">  </span><span class="nc">SIGQUIT</span><span class="w">
 </span><span class="err">•</span><span class="w">  </span><span class="nc">SIGTERM</span><span class="w">
 </span><span class="err">•</span><span class="w">  </span><span class="nc">SIGTSTP</span><span class="w">
 </span><span class="err">•</span><span class="w">  </span><span class="nc">SIGUSR1</span><span class="w">
 </span><span class="err">•</span><span class="w">  </span><span class="nc">SIGUSR2</span><span class="w">

 </span><span class="nc">If</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">fatal</span><span class="w"> </span><span class="n">signal</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">received</span><span class="w"> </span><span class="n">before</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">command</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">executed</span><span class="p">,</span><span class="w"> </span><span class="n">sudo</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">call</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">plugin</span><span class="err">&#39;</span><span class="n">s</span><span class="w"> </span><span class="n">close</span><span class="p" data-group-id="5140202611-1">(</span><span class="p" data-group-id="5140202611-1">)</span><span class="w"> </span><span class="n">function</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">an</span><span class="w"> </span><span class="n">exit</span><span class="w"> </span><span class="n">status</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="mi">128</span><span class="w"> </span><span class="n">plus</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">value</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">signal</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">was</span><span class="w"> </span><span class="n">re</span><span class="err">‐</span><span class="w">
 </span><span class="n">ceived</span><span class="o">.</span><span class="w">  </span><span class="nc">This</span><span class="w"> </span><span class="n">allows</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">consistent</span><span class="w"> </span><span class="n">logging</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">commands</span><span class="w"> </span><span class="n">killed</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">signal</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">plugins</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">log</span><span class="w"> </span><span class="n">such</span><span class="w"> </span><span class="n">information</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">their</span><span class="w"> </span><span class="n">close</span><span class="p" data-group-id="5140202611-2">(</span><span class="p" data-group-id="5140202611-2">)</span><span class="w"> </span><span class="n">function</span><span class="o">.</span><span class="w">  </span><span class="nc">An</span><span class="w"> </span><span class="n">exception</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">this</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="nc">SIGPIPE</span><span class="p">,</span><span class="w"> </span><span class="n">which</span><span class="w">
 </span><span class="n">is</span><span class="w"> </span><span class="n">ignored</span><span class="w"> </span><span class="n">until</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">command</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">executed</span><span class="o">.</span><span class="w">

 </span><span class="nc">A</span><span class="w"> </span><span class="n">plugin</span><span class="w"> </span><span class="n">may</span><span class="w"> </span><span class="n">temporarily</span><span class="w"> </span><span class="n">install</span><span class="w"> </span><span class="n">its</span><span class="w"> </span><span class="n">own</span><span class="w"> </span><span class="n">signal</span><span class="w"> </span><span class="n">handlers</span><span class="w"> </span><span class="n">but</span><span class="w"> </span><span class="n">must</span><span class="w"> </span><span class="n">restore</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">original</span><span class="w"> </span><span class="n">handler</span><span class="w"> </span><span class="n">before</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">plugin</span><span class="w"> </span><span class="n">function</span><span class="w"> </span><span class="n">returns</span><span class="o">.</span></code></pre><p>   Hook function API</p><pre><code class="makeup elixir" translate="no"><span class="w"> </span><span class="nc">Beginning</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">plugin</span><span class="w"> </span><span class="nc">API</span><span class="w"> </span><span class="n">version</span><span class="w"> </span><span class="mf">1.2</span><span class="p">,</span><span class="w"> </span><span class="n">it</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">possible</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">install</span><span class="w"> </span><span class="n">hooks</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">certain</span><span class="w"> </span><span class="n">functions</span><span class="w"> </span><span class="n">called</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">sudo</span><span class="w"> </span><span class="n">front</span><span class="o">-</span><span class="k">end</span><span class="o">.</span><span class="w">

 </span><span class="nc">Currently</span><span class="p">,</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">only</span><span class="w"> </span><span class="n">supported</span><span class="w"> </span><span class="n">hooks</span><span class="w"> </span><span class="n">relate</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">handling</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">environment</span><span class="w"> </span><span class="n">variables</span><span class="o">.</span><span class="w">  </span><span class="nc">Hooks</span><span class="w"> </span><span class="n">can</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">used</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">intercept</span><span class="w"> </span><span class="n">attempts</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">get</span><span class="p">,</span><span class="w"> </span><span class="n">set</span><span class="p">,</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">remove</span><span class="w"> </span><span class="n">environment</span><span class="w"> </span><span class="n">variables</span><span class="w"> </span><span class="n">so</span><span class="w"> </span><span class="n">that</span><span class="w">
 </span><span class="n">these</span><span class="w"> </span><span class="n">changes</span><span class="w"> </span><span class="n">can</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">reflected</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">version</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">environment</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">used</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">execute</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">command</span><span class="o">.</span><span class="w">  </span><span class="nc">A</span><span class="w"> </span><span class="n">future</span><span class="w"> </span><span class="n">version</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nc">API</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">support</span><span class="w"> </span><span class="n">hooking</span><span class="w"> </span><span class="n">internal</span><span class="w"> </span><span class="n">sudo</span><span class="w"> </span><span class="n">front</span><span class="o">-</span><span class="k">end</span><span class="w"> </span><span class="n">func</span><span class="err">‐</span><span class="w">
 </span><span class="n">tions</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="n">well</span><span class="o">.</span><span class="w">

 </span><span class="nc">Hook</span><span class="w"> </span><span class="n">structure</span><span class="w">

 </span><span class="nc">Hooks</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">sudo</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">described</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">following</span><span class="w"> </span><span class="ss">structure</span><span class="p">:</span><span class="w">

 </span><span class="n">typedef</span><span class="w"> </span><span class="n">int</span><span class="w"> </span><span class="p" data-group-id="2022908500-1">(</span><span class="o">*</span><span class="n">sudo_hook_fn_t</span><span class="p" data-group-id="2022908500-1">)</span><span class="p" data-group-id="2022908500-2">(</span><span class="p" data-group-id="2022908500-2">)</span><span class="p">;</span><span class="w">

 </span><span class="n">struct</span><span class="w"> </span><span class="n">sudo_hook</span><span class="w"> </span><span class="p" data-group-id="2022908500-3">{</span><span class="w">
     </span><span class="n">unsigned</span><span class="w"> </span><span class="n">int</span><span class="w"> </span><span class="n">hook_version</span><span class="p">;</span><span class="w">
     </span><span class="n">unsigned</span><span class="w"> </span><span class="n">int</span><span class="w"> </span><span class="n">hook_type</span><span class="p">;</span><span class="w">
     </span><span class="n">sudo_hook_fn_t</span><span class="w"> </span><span class="n">hook_fn</span><span class="p">;</span><span class="w">
     </span><span class="n">void</span><span class="w"> </span><span class="o">*</span><span class="n">closure</span><span class="p">;</span><span class="w">
 </span><span class="p" data-group-id="2022908500-3">}</span><span class="p">;</span><span class="w">

 </span><span class="nc">A</span><span class="w"> </span><span class="n">struct</span><span class="w"> </span><span class="n">sudo_hook</span><span class="w"> </span><span class="n">has</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">following</span><span class="w"> </span><span class="ss">fields</span><span class="p">:</span><span class="w">

 </span><span class="n">hook_version</span><span class="w">
       </span><span class="nc">The</span><span class="w"> </span><span class="n">hook_version</span><span class="w"> </span><span class="n">field</span><span class="w"> </span><span class="n">should</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">set</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="nc">SUDO_HOOK_VERSION</span><span class="o">.</span><span class="w">

 </span><span class="n">hook_type</span><span class="w">
       </span><span class="nc">The</span><span class="w"> </span><span class="n">hook_type</span><span class="w"> </span><span class="n">field</span><span class="w"> </span><span class="n">may</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">one</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">following</span><span class="w"> </span><span class="n">supported</span><span class="w"> </span><span class="n">hook</span><span class="w"> </span><span class="ss">types</span><span class="p">:</span><span class="w">

       </span><span class="nc">SUDO_HOOK_SETENV</span><span class="w">
             </span><span class="nc">The</span><span class="w"> </span><span class="nc">C</span><span class="w"> </span><span class="n">library</span><span class="w"> </span><span class="n">setenv</span><span class="p" data-group-id="2022908500-4">(</span><span class="mi">3</span><span class="p" data-group-id="2022908500-4">)</span><span class="w"> </span><span class="n">function</span><span class="o">.</span><span class="w">  </span><span class="nc">Any</span><span class="w"> </span><span class="n">registered</span><span class="w"> </span><span class="n">hooks</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">run</span><span class="w"> </span><span class="n">before</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nc">C</span><span class="w"> </span><span class="n">library</span><span class="w"> </span><span class="n">implementation</span><span class="o">.</span><span class="w">  </span><span class="nc">The</span><span class="w"> </span><span class="n">hook_fn</span><span class="w"> </span><span class="n">field</span><span class="w"> </span><span class="n">should</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">function</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">matches</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">following</span><span class="w">
             </span><span class="ss">typedef</span><span class="p">:</span><span class="w">

             </span><span class="n">typedef</span><span class="w"> </span><span class="n">int</span><span class="w"> </span><span class="p" data-group-id="2022908500-5">(</span><span class="o">*</span><span class="n">sudo_hook_fn_setenv_t</span><span class="p" data-group-id="2022908500-5">)</span><span class="p" data-group-id="2022908500-6">(</span><span class="n">const</span><span class="w"> </span><span class="n">char</span><span class="w"> </span><span class="o">*</span><span class="n">name</span><span class="p">,</span><span class="w">
                </span><span class="n">const</span><span class="w"> </span><span class="n">char</span><span class="w"> </span><span class="o">*</span><span class="n">value</span><span class="p">,</span><span class="w"> </span><span class="n">int</span><span class="w"> </span><span class="n">overwrite</span><span class="p">,</span><span class="w"> </span><span class="n">void</span><span class="w"> </span><span class="o">*</span><span class="n">closure</span><span class="p" data-group-id="2022908500-6">)</span><span class="p">;</span><span class="w">

             </span><span class="nc">If</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">registered</span><span class="w"> </span><span class="n">hook</span><span class="w"> </span><span class="n">does</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">match</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">typedef</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">results</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">unspecified</span><span class="o">.</span><span class="w">

       </span><span class="nc">SUDO_HOOK_UNSETENV</span><span class="w">
             </span><span class="nc">The</span><span class="w"> </span><span class="nc">C</span><span class="w"> </span><span class="n">library</span><span class="w"> </span><span class="n">unsetenv</span><span class="p" data-group-id="2022908500-7">(</span><span class="mi">3</span><span class="p" data-group-id="2022908500-7">)</span><span class="w"> </span><span class="n">function</span><span class="o">.</span><span class="w">  </span><span class="nc">Any</span><span class="w"> </span><span class="n">registered</span><span class="w"> </span><span class="n">hooks</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">run</span><span class="w"> </span><span class="n">before</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nc">C</span><span class="w"> </span><span class="n">library</span><span class="w"> </span><span class="n">implementation</span><span class="o">.</span><span class="w">  </span><span class="nc">The</span><span class="w"> </span><span class="n">hook_fn</span><span class="w"> </span><span class="n">field</span><span class="w"> </span><span class="n">should</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">function</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">matches</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">follow</span><span class="err">‐</span><span class="w">
             </span><span class="n">ing</span><span class="w"> </span><span class="ss">typedef</span><span class="p">:</span><span class="w">

             </span><span class="n">typedef</span><span class="w"> </span><span class="n">int</span><span class="w"> </span><span class="p" data-group-id="2022908500-8">(</span><span class="o">*</span><span class="n">sudo_hook_fn_unsetenv_t</span><span class="p" data-group-id="2022908500-8">)</span><span class="p" data-group-id="2022908500-9">(</span><span class="n">const</span><span class="w"> </span><span class="n">char</span><span class="w"> </span><span class="o">*</span><span class="n">name</span><span class="p">,</span><span class="w">
                </span><span class="n">void</span><span class="w"> </span><span class="o">*</span><span class="n">closure</span><span class="p" data-group-id="2022908500-9">)</span><span class="p">;</span><span class="w">

       </span><span class="nc">SUDO_HOOK_GETENV</span><span class="w">
             </span><span class="nc">The</span><span class="w"> </span><span class="nc">C</span><span class="w"> </span><span class="n">library</span><span class="w"> </span><span class="n">getenv</span><span class="p" data-group-id="2022908500-10">(</span><span class="mi">3</span><span class="p" data-group-id="2022908500-10">)</span><span class="w"> </span><span class="n">function</span><span class="o">.</span><span class="w">  </span><span class="nc">Any</span><span class="w"> </span><span class="n">registered</span><span class="w"> </span><span class="n">hooks</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">run</span><span class="w"> </span><span class="n">before</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nc">C</span><span class="w"> </span><span class="n">library</span><span class="w"> </span><span class="n">implementation</span><span class="o">.</span><span class="w">  </span><span class="nc">The</span><span class="w"> </span><span class="n">hook_fn</span><span class="w"> </span><span class="n">field</span><span class="w"> </span><span class="n">should</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">function</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">matches</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">following</span><span class="w">
             </span><span class="ss">typedef</span><span class="p">:</span><span class="w">

             </span><span class="n">typedef</span><span class="w"> </span><span class="n">int</span><span class="w"> </span><span class="p" data-group-id="2022908500-11">(</span><span class="o">*</span><span class="n">sudo_hook_fn_getenv_t</span><span class="p" data-group-id="2022908500-11">)</span><span class="p" data-group-id="2022908500-12">(</span><span class="n">const</span><span class="w"> </span><span class="n">char</span><span class="w"> </span><span class="o">*</span><span class="n">name</span><span class="p">,</span><span class="w">
                </span><span class="n">char</span><span class="w"> </span><span class="o">*</span><span class="o">*</span><span class="n">value</span><span class="p">,</span><span class="w"> </span><span class="n">void</span><span class="w"> </span><span class="o">*</span><span class="n">closure</span><span class="p" data-group-id="2022908500-12">)</span><span class="p">;</span><span class="w">

             </span><span class="nc">If</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">registered</span><span class="w"> </span><span class="n">hook</span><span class="w"> </span><span class="n">does</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">match</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">typedef</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">results</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">unspecified</span><span class="o">.</span><span class="w">

       </span><span class="nc">SUDO_HOOK_PUTENV</span><span class="w">
             </span><span class="nc">The</span><span class="w"> </span><span class="nc">C</span><span class="w"> </span><span class="n">library</span><span class="w"> </span><span class="n">putenv</span><span class="p" data-group-id="2022908500-13">(</span><span class="mi">3</span><span class="p" data-group-id="2022908500-13">)</span><span class="w"> </span><span class="n">function</span><span class="o">.</span><span class="w">  </span><span class="nc">Any</span><span class="w"> </span><span class="n">registered</span><span class="w"> </span><span class="n">hooks</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">run</span><span class="w"> </span><span class="n">before</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nc">C</span><span class="w"> </span><span class="n">library</span><span class="w"> </span><span class="n">implementation</span><span class="o">.</span><span class="w">  </span><span class="nc">The</span><span class="w"> </span><span class="n">hook_fn</span><span class="w"> </span><span class="n">field</span><span class="w"> </span><span class="n">should</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">function</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">matches</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">following</span><span class="w">
             </span><span class="ss">typedef</span><span class="p">:</span><span class="w">

             </span><span class="n">typedef</span><span class="w"> </span><span class="n">int</span><span class="w"> </span><span class="p" data-group-id="2022908500-14">(</span><span class="o">*</span><span class="n">sudo_hook_fn_putenv_t</span><span class="p" data-group-id="2022908500-14">)</span><span class="p" data-group-id="2022908500-15">(</span><span class="n">char</span><span class="w"> </span><span class="o">*</span><span class="n">string</span><span class="p">,</span><span class="w">
                </span><span class="n">void</span><span class="w"> </span><span class="o">*</span><span class="n">closure</span><span class="p" data-group-id="2022908500-15">)</span><span class="p">;</span><span class="w">

             </span><span class="nc">If</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">registered</span><span class="w"> </span><span class="n">hook</span><span class="w"> </span><span class="n">does</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">match</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">typedef</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">results</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">unspecified</span><span class="o">.</span><span class="w">

 </span><span class="n">hook_fn</span><span class="w">
       </span><span class="n">sudo_hook_fn_t</span><span class="w"> </span><span class="n">hook_fn</span><span class="p">;</span><span class="w">

       </span><span class="nc">The</span><span class="w"> </span><span class="n">hook_fn</span><span class="w"> </span><span class="n">field</span><span class="w"> </span><span class="n">should</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">set</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">plugin</span><span class="sc">&#39;s hook implementation.  The actual function arguments will vary depending on the hook_type (see hook_type above).  In all cases,
       the closure field of struct sudo_hook is passed as the last function parameter.  This can be used to pass arbitrary data to the plugin&#39;</span><span class="n">s</span><span class="w"> </span><span class="n">hook</span><span class="w"> </span><span class="n">implementation</span><span class="o">.</span><span class="w">

       </span><span class="nc">The</span><span class="w"> </span><span class="n">function</span><span class="w"> </span><span class="n">return</span><span class="w"> </span><span class="n">value</span><span class="w"> </span><span class="n">may</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">one</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="ss">following</span><span class="p">:</span><span class="w">

       </span><span class="nc">SUDO_HOOK_RET_ERROR</span><span class="w">
             </span><span class="nc">The</span><span class="w"> </span><span class="n">hook</span><span class="w"> </span><span class="n">function</span><span class="w"> </span><span class="n">encountered</span><span class="w"> </span><span class="n">an</span><span class="w"> </span><span class="n">error</span><span class="o">.</span><span class="w">

       </span><span class="nc">SUDO_HOOK_RET_NEXT</span><span class="w">
             </span><span class="nc">The</span><span class="w"> </span><span class="n">hook</span><span class="w"> </span><span class="n">completed</span><span class="w"> </span><span class="n">without</span><span class="w"> </span><span class="n">error</span><span class="p">,</span><span class="w"> </span><span class="n">go</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">next</span><span class="w"> </span><span class="n">hook</span><span class="w"> </span><span class="p" data-group-id="2022908500-16">(</span><span class="n">including</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">system</span><span class="w"> </span><span class="n">implementation</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">applicable</span><span class="p" data-group-id="2022908500-16">)</span><span class="o">.</span><span class="w">  </span><span class="nc">For</span><span class="w"> </span><span class="n">example</span><span class="p">,</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">getenv</span><span class="p" data-group-id="2022908500-17">(</span><span class="mi">3</span><span class="p" data-group-id="2022908500-17">)</span><span class="w"> </span><span class="n">hook</span><span class="w"> </span><span class="n">might</span><span class="w"> </span><span class="n">return</span><span class="w">
             </span><span class="nc">SUDO_HOOK_RET_NEXT</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">specified</span><span class="w"> </span><span class="n">variable</span><span class="w"> </span><span class="n">was</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">found</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">private</span><span class="w"> </span><span class="n">copy</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">environment</span><span class="o">.</span><span class="w">

       </span><span class="nc">SUDO_HOOK_RET_STOP</span><span class="w">
             </span><span class="nc">The</span><span class="w"> </span><span class="n">hook</span><span class="w"> </span><span class="n">completed</span><span class="w"> </span><span class="n">without</span><span class="w"> </span><span class="n">error</span><span class="p">,</span><span class="w"> </span><span class="n">stop</span><span class="w"> </span><span class="n">processing</span><span class="w"> </span><span class="n">hooks</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">this</span><span class="w"> </span><span class="n">invocation</span><span class="o">.</span><span class="w">  </span><span class="nc">This</span><span class="w"> </span><span class="n">can</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">used</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">replace</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">system</span><span class="w"> </span><span class="n">implementation</span><span class="o">.</span><span class="w">  </span><span class="nc">For</span><span class="w"> </span><span class="n">example</span><span class="p">,</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">setenv</span><span class="w"> </span><span class="n">hook</span><span class="w"> </span><span class="n">that</span><span class="w">
             </span><span class="n">operates</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">private</span><span class="w"> </span><span class="n">copy</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">environment</span><span class="w"> </span><span class="n">but</span><span class="w"> </span><span class="n">leaves</span><span class="w"> </span><span class="n">environ</span><span class="w"> </span><span class="n">unchanged</span><span class="o">.</span><span class="w">

 </span><span class="nc">Care</span><span class="w"> </span><span class="n">must</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">taken</span><span class="w"> </span><span class="ow">when</span><span class="w"> </span><span class="n">hooking</span><span class="w"> </span><span class="nc">C</span><span class="w"> </span><span class="n">library</span><span class="w"> </span><span class="n">functions</span><span class="p">,</span><span class="w"> </span><span class="n">it</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">very</span><span class="w"> </span><span class="n">easy</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">create</span><span class="w"> </span><span class="n">an</span><span class="w"> </span><span class="n">infinite</span><span class="w"> </span><span class="n">loop</span><span class="o">.</span><span class="w">  </span><span class="nc">For</span><span class="w"> </span><span class="n">example</span><span class="p">,</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">getenv</span><span class="p" data-group-id="2022908500-18">(</span><span class="mi">3</span><span class="p" data-group-id="2022908500-18">)</span><span class="w"> </span><span class="n">hook</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">calls</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">snprintf</span><span class="p" data-group-id="2022908500-19">(</span><span class="mi">3</span><span class="p" data-group-id="2022908500-19">)</span><span class="w"> </span><span class="n">function</span><span class="w"> </span><span class="n">may</span><span class="w"> </span><span class="n">create</span><span class="w"> </span><span class="n">a</span><span class="w">
 </span><span class="n">loop</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">snprintf</span><span class="p" data-group-id="2022908500-20">(</span><span class="mi">3</span><span class="p" data-group-id="2022908500-20">)</span><span class="w"> </span><span class="n">implementation</span><span class="w"> </span><span class="n">calls</span><span class="w"> </span><span class="n">getenv</span><span class="p" data-group-id="2022908500-21">(</span><span class="mi">3</span><span class="p" data-group-id="2022908500-21">)</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">check</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">locale</span><span class="o">.</span><span class="w">  </span><span class="nc">To</span><span class="w"> </span><span class="n">prevent</span><span class="w"> </span><span class="n">this</span><span class="p">,</span><span class="w"> </span><span class="n">you</span><span class="w"> </span><span class="n">may</span><span class="w"> </span><span class="n">wish</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="kn">use</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">static</span><span class="w"> </span><span class="n">variable</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">hook</span><span class="w"> </span><span class="n">function</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">guard</span><span class="w"> </span><span class="n">against</span><span class="w"> </span><span class="n">nested</span><span class="w">
 </span><span class="n">calls</span><span class="o">.</span><span class="w">  </span><span class="nc">For</span><span class="w"> </span><span class="ss">example</span><span class="p">:</span><span class="w">

       </span><span class="n">static</span><span class="w"> </span><span class="n">int</span><span class="w"> </span><span class="n">in_progress</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="o">/</span><span class="o">*</span><span class="w"> </span><span class="n">avoid</span><span class="w"> </span><span class="n">recursion</span><span class="w"> </span><span class="o">*</span><span class="o">/</span><span class="w">
       </span><span class="k">if</span><span class="w"> </span><span class="p" data-group-id="2022908500-22">(</span><span class="n">in_progress</span><span class="p" data-group-id="2022908500-22">)</span><span class="w">
           </span><span class="n">return</span><span class="w"> </span><span class="nc">SUDO_HOOK_RET_NEXT</span><span class="p">;</span><span class="w">
       </span><span class="n">in_progress</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w">
       </span><span class="n">...</span><span class="w">
       </span><span class="n">in_progress</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w">
       </span><span class="n">return</span><span class="w"> </span><span class="nc">SUDO_HOOK_RET_STOP</span><span class="p">;</span><span class="w">

 </span><span class="nc">Hook</span><span class="w"> </span><span class="nc">API</span><span class="w"> </span><span class="nc">Version</span><span class="w"> </span><span class="nc">Macros</span><span class="w">

 </span><span class="o">/</span><span class="o">*</span><span class="w"> </span><span class="nc">Hook</span><span class="w"> </span><span class="nc">API</span><span class="w"> </span><span class="n">version</span><span class="w"> </span><span class="n">major</span><span class="o">/</span><span class="n">minor</span><span class="w"> </span><span class="o">*</span><span class="o">/</span><span class="w">
 </span><span class="c1">#define SUDO_HOOK_VERSION_MAJOR 1</span><span class="w">
 </span><span class="c1">#define SUDO_HOOK_VERSION_MINOR 0</span><span class="w">
 </span><span class="c1">#define SUDO_HOOK_VERSION SUDO_API_MKVERSION(SUDO_HOOK_VERSION_MAJOR,\</span><span class="w">
                                               </span><span class="nc">SUDO_HOOK_VERSION_MINOR</span><span class="p">)</span><span class="w">

 </span><span class="nc">For</span><span class="w"> </span><span class="n">getters</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">setters</span><span class="w"> </span><span class="n">see</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nc">Policy</span><span class="w"> </span><span class="n">plugin</span><span class="w"> </span><span class="nc">API</span><span class="o">.</span></code></pre><p>   Event API</p><pre><code class="makeup elixir" translate="no"><span class="w"> </span><span class="nc">When</span><span class="w"> </span><span class="n">sudo</span><span class="w"> </span><span class="n">runs</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">command</span><span class="p">,</span><span class="w"> </span><span class="n">it</span><span class="w"> </span><span class="n">uses</span><span class="w"> </span><span class="n">an</span><span class="w"> </span><span class="n">event</span><span class="w"> </span><span class="n">loop</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">service</span><span class="w"> </span><span class="n">signals</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="nc">I</span><span class="o">/</span><span class="nc">O</span><span class="o">.</span><span class="w">  </span><span class="nc">Events</span><span class="w"> </span><span class="n">may</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">triggered</span><span class="w"> </span><span class="n">based</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">time</span><span class="p">,</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">file</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">socket</span><span class="w"> </span><span class="n">descriptor</span><span class="w"> </span><span class="n">becoming</span><span class="w"> </span><span class="n">ready</span><span class="p">,</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">due</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">receipt</span><span class="w"> </span><span class="n">of</span><span class="w">
 </span><span class="n">a</span><span class="w"> </span><span class="n">signal</span><span class="o">.</span><span class="w">  </span><span class="nc">Starting</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="nc">API</span><span class="w"> </span><span class="n">version</span><span class="w"> </span><span class="mf">1.15</span><span class="p">,</span><span class="w"> </span><span class="n">it</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">possible</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">plugin</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">participate</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">this</span><span class="w"> </span><span class="n">event</span><span class="w"> </span><span class="n">loop</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">calling</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">event_alloc</span><span class="p" data-group-id="8870613205-1">(</span><span class="p" data-group-id="8870613205-1">)</span><span class="w"> </span><span class="n">function</span><span class="o">.</span><span class="w">

 </span><span class="nc">Event</span><span class="w"> </span><span class="n">structure</span><span class="w">

 </span><span class="nc">Events</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">described</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">following</span><span class="w"> </span><span class="ss">structure</span><span class="p">:</span><span class="w">

 </span><span class="n">typedef</span><span class="w"> </span><span class="n">void</span><span class="w"> </span><span class="p" data-group-id="8870613205-2">(</span><span class="o">*</span><span class="n">sudo_plugin_ev_callback_t</span><span class="p" data-group-id="8870613205-2">)</span><span class="p" data-group-id="8870613205-3">(</span><span class="n">int</span><span class="w"> </span><span class="n">fd</span><span class="p">,</span><span class="w"> </span><span class="n">int</span><span class="w"> </span><span class="n">what</span><span class="p">,</span><span class="w"> </span><span class="n">void</span><span class="w"> </span><span class="o">*</span><span class="n">closure</span><span class="p" data-group-id="8870613205-3">)</span><span class="p">;</span><span class="w">

 </span><span class="n">struct</span><span class="w"> </span><span class="n">sudo_plugin_event</span><span class="w"> </span><span class="p" data-group-id="8870613205-4">{</span><span class="w">
     </span><span class="n">int</span><span class="w"> </span><span class="p" data-group-id="8870613205-5">(</span><span class="o">*</span><span class="n">set</span><span class="p" data-group-id="8870613205-5">)</span><span class="p" data-group-id="8870613205-6">(</span><span class="n">struct</span><span class="w"> </span><span class="n">sudo_plugin_event</span><span class="w"> </span><span class="o">*</span><span class="n">pev</span><span class="p">,</span><span class="w"> </span><span class="n">int</span><span class="w"> </span><span class="n">fd</span><span class="p">,</span><span class="w"> </span><span class="n">int</span><span class="w"> </span><span class="n">events</span><span class="p">,</span><span class="w">
         </span><span class="n">sudo_plugin_ev_callback_t</span><span class="w"> </span><span class="n">callback</span><span class="p">,</span><span class="w"> </span><span class="n">void</span><span class="w"> </span><span class="o">*</span><span class="n">closure</span><span class="p" data-group-id="8870613205-6">)</span><span class="p">;</span><span class="w">
     </span><span class="n">int</span><span class="w"> </span><span class="p" data-group-id="8870613205-7">(</span><span class="o">*</span><span class="n">add</span><span class="p" data-group-id="8870613205-7">)</span><span class="p" data-group-id="8870613205-8">(</span><span class="n">struct</span><span class="w"> </span><span class="n">sudo_plugin_event</span><span class="w"> </span><span class="o">*</span><span class="n">pev</span><span class="p">,</span><span class="w"> </span><span class="n">struct</span><span class="w"> </span><span class="n">timespec</span><span class="w"> </span><span class="o">*</span><span class="n">timeout</span><span class="p" data-group-id="8870613205-8">)</span><span class="p">;</span><span class="w">
     </span><span class="n">int</span><span class="w"> </span><span class="p" data-group-id="8870613205-9">(</span><span class="o">*</span><span class="n">del</span><span class="p" data-group-id="8870613205-9">)</span><span class="p" data-group-id="8870613205-10">(</span><span class="n">struct</span><span class="w"> </span><span class="n">sudo_plugin_event</span><span class="w"> </span><span class="o">*</span><span class="n">pev</span><span class="p" data-group-id="8870613205-10">)</span><span class="p">;</span><span class="w">
     </span><span class="n">int</span><span class="w"> </span><span class="p" data-group-id="8870613205-11">(</span><span class="o">*</span><span class="n">pending</span><span class="p" data-group-id="8870613205-11">)</span><span class="p" data-group-id="8870613205-12">(</span><span class="n">struct</span><span class="w"> </span><span class="n">sudo_plugin_event</span><span class="w"> </span><span class="o">*</span><span class="n">pev</span><span class="p">,</span><span class="w"> </span><span class="n">int</span><span class="w"> </span><span class="n">events</span><span class="p">,</span><span class="w">
         </span><span class="n">struct</span><span class="w"> </span><span class="n">timespec</span><span class="w"> </span><span class="o">*</span><span class="n">ts</span><span class="p" data-group-id="8870613205-12">)</span><span class="p">;</span><span class="w">
     </span><span class="n">int</span><span class="w"> </span><span class="p" data-group-id="8870613205-13">(</span><span class="o">*</span><span class="n">fd</span><span class="p" data-group-id="8870613205-13">)</span><span class="p" data-group-id="8870613205-14">(</span><span class="n">struct</span><span class="w"> </span><span class="n">sudo_plugin_event</span><span class="w"> </span><span class="o">*</span><span class="n">pev</span><span class="p" data-group-id="8870613205-14">)</span><span class="p">;</span><span class="w">
     </span><span class="n">void</span><span class="w"> </span><span class="p" data-group-id="8870613205-15">(</span><span class="o">*</span><span class="n">setbase</span><span class="p" data-group-id="8870613205-15">)</span><span class="p" data-group-id="8870613205-16">(</span><span class="n">struct</span><span class="w"> </span><span class="n">sudo_plugin_event</span><span class="w"> </span><span class="o">*</span><span class="n">pev</span><span class="p">,</span><span class="w"> </span><span class="n">void</span><span class="w"> </span><span class="o">*</span><span class="n">base</span><span class="p" data-group-id="8870613205-16">)</span><span class="p">;</span><span class="w">
     </span><span class="n">void</span><span class="w"> </span><span class="p" data-group-id="8870613205-17">(</span><span class="o">*</span><span class="n">loopbreak</span><span class="p" data-group-id="8870613205-17">)</span><span class="p" data-group-id="8870613205-18">(</span><span class="n">struct</span><span class="w"> </span><span class="n">sudo_plugin_event</span><span class="w"> </span><span class="o">*</span><span class="n">pev</span><span class="p" data-group-id="8870613205-18">)</span><span class="p">;</span><span class="w">
     </span><span class="n">void</span><span class="w"> </span><span class="p" data-group-id="8870613205-19">(</span><span class="o">*</span><span class="n">free</span><span class="p" data-group-id="8870613205-19">)</span><span class="p" data-group-id="8870613205-20">(</span><span class="n">struct</span><span class="w"> </span><span class="n">sudo_plugin_event</span><span class="w"> </span><span class="o">*</span><span class="n">pev</span><span class="p" data-group-id="8870613205-20">)</span><span class="p">;</span><span class="w">
 </span><span class="p" data-group-id="8870613205-4">}</span><span class="p">;</span><span class="w">

 </span><span class="nc">A</span><span class="w"> </span><span class="n">struct</span><span class="w"> </span><span class="n">sudo_plugin_event</span><span class="w"> </span><span class="n">contains</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">following</span><span class="w"> </span><span class="n">function</span><span class="w"> </span><span class="ss">pointers</span><span class="p">:</span><span class="w">

 </span><span class="n">set</span><span class="w">
       </span><span class="n">int</span><span class="w"> </span><span class="p" data-group-id="8870613205-21">(</span><span class="o">*</span><span class="n">set</span><span class="p" data-group-id="8870613205-21">)</span><span class="p" data-group-id="8870613205-22">(</span><span class="n">struct</span><span class="w"> </span><span class="n">sudo_plugin_event</span><span class="w"> </span><span class="o">*</span><span class="n">pev</span><span class="p">,</span><span class="w"> </span><span class="n">int</span><span class="w"> </span><span class="n">fd</span><span class="p">,</span><span class="w"> </span><span class="n">int</span><span class="w"> </span><span class="n">events</span><span class="p">,</span><span class="w">
           </span><span class="n">sudo_plugin_ev_callback_t</span><span class="w"> </span><span class="n">callback</span><span class="p">,</span><span class="w"> </span><span class="n">void</span><span class="w"> </span><span class="o">*</span><span class="n">closure</span><span class="p" data-group-id="8870613205-22">)</span><span class="p">;</span><span class="w">

       </span><span class="nc">The</span><span class="w"> </span><span class="n">set</span><span class="p" data-group-id="8870613205-23">(</span><span class="p" data-group-id="8870613205-23">)</span><span class="w"> </span><span class="n">function</span><span class="w"> </span><span class="n">takes</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">following</span><span class="w"> </span><span class="ss">arguments</span><span class="p">:</span><span class="w">

       </span><span class="n">struct</span><span class="w"> </span><span class="n">sudo_plugin_event</span><span class="w"> </span><span class="o">*</span><span class="n">pev</span><span class="w">
             </span><span class="nc">A</span><span class="w"> </span><span class="n">pointer</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">struct</span><span class="w"> </span><span class="n">sudo_plugin_event</span><span class="w"> </span><span class="n">itself</span><span class="o">.</span><span class="w">

       </span><span class="n">fd</span><span class="w">    </span><span class="nc">The</span><span class="w"> </span><span class="n">file</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">socket</span><span class="w"> </span><span class="n">descriptor</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="nc">I</span><span class="o">/</span><span class="nc">O</span><span class="o">-</span><span class="n">based</span><span class="w"> </span><span class="n">events</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">signal</span><span class="w"> </span><span class="n">number</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">signal</span><span class="w"> </span><span class="n">events</span><span class="o">.</span><span class="w">  </span><span class="nc">For</span><span class="w"> </span><span class="n">time</span><span class="o">-</span><span class="n">based</span><span class="w"> </span><span class="n">events</span><span class="p">,</span><span class="w"> </span><span class="n">fd</span><span class="w"> </span><span class="n">must</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="o">-</span><span class="mi">1</span><span class="o">.</span><span class="w">

       </span><span class="n">events</span><span class="w">
             </span><span class="nc">The</span><span class="w"> </span><span class="n">following</span><span class="w"> </span><span class="n">values</span><span class="w"> </span><span class="n">determine</span><span class="w"> </span><span class="n">what</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">trigger</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">event</span><span class="w"> </span><span class="ss">callback</span><span class="p">:</span><span class="w">

             </span><span class="nc">SUDO_PLUGIN_EV_TIMEOUT</span><span class="w">
                   </span><span class="n">callback</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">run</span><span class="w"> </span><span class="k">after</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">specified</span><span class="w"> </span><span class="n">timeout</span><span class="w"> </span><span class="n">expires</span><span class="w">

             </span><span class="nc">SUDO_PLUGIN_EV_READ</span><span class="w">
                   </span><span class="n">callback</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">run</span><span class="w"> </span><span class="ow">when</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">file</span><span class="w"> </span><span class="n">descriptor</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">readable</span><span class="w">

             </span><span class="nc">SUDO_PLUGIN_EV_WRITE</span><span class="w">
                   </span><span class="n">callback</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">run</span><span class="w"> </span><span class="ow">when</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">file</span><span class="w"> </span><span class="n">descriptor</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">writable</span><span class="w">

             </span><span class="nc">SUDO_PLUGIN_EV_PERSIST</span><span class="w">
                   </span><span class="n">event</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">persistent</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">remains</span><span class="w"> </span><span class="n">enabled</span><span class="w"> </span><span class="n">until</span><span class="w"> </span><span class="n">explicitly</span><span class="w"> </span><span class="n">deleted</span><span class="w">

             </span><span class="nc">SUDO_PLUGIN_EV_SIGNAL</span><span class="w">
                   </span><span class="n">callback</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">run</span><span class="w"> </span><span class="ow">when</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">specified</span><span class="w"> </span><span class="n">signal</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">received</span><span class="w">

             </span><span class="nc">The</span><span class="w"> </span><span class="nc">SUDO_PLUGIN_EV_PERSIST</span><span class="w"> </span><span class="n">flag</span><span class="w"> </span><span class="n">may</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="nc">ORed</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">any</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">event</span><span class="w"> </span><span class="n">types</span><span class="o">.</span><span class="w">  </span><span class="nc">It</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">also</span><span class="w"> </span><span class="n">possible</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="nc">OR</span><span class="w"> </span><span class="nc">SUDO_PLUGIN_EV_READ</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="nc">SUDO_PLUGIN_EV_WRITE</span><span class="w"> </span><span class="n">together</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">run</span><span class="w"> </span><span class="n">the</span><span class="w">
             </span><span class="n">callback</span><span class="w"> </span><span class="ow">when</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">descriptor</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">ready</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">either</span><span class="w"> </span><span class="n">read</span><span class="w"> </span><span class="n">from</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">written</span><span class="w"> </span><span class="n">to</span><span class="o">.</span><span class="w">  </span><span class="nc">All</span><span class="w"> </span><span class="n">other</span><span class="w"> </span><span class="n">event</span><span class="w"> </span><span class="n">values</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">mutually</span><span class="w"> </span><span class="n">exclusive</span><span class="o">.</span><span class="w">

       </span><span class="n">sudo_plugin_ev_callback_t</span><span class="w"> </span><span class="n">callback</span><span class="w">
             </span><span class="n">typedef</span><span class="w"> </span><span class="n">void</span><span class="w"> </span><span class="p" data-group-id="8870613205-24">(</span><span class="o">*</span><span class="n">sudo_plugin_ev_callback_t</span><span class="p" data-group-id="8870613205-24">)</span><span class="p" data-group-id="8870613205-25">(</span><span class="n">int</span><span class="w"> </span><span class="n">fd</span><span class="p">,</span><span class="w"> </span><span class="n">int</span><span class="w"> </span><span class="n">what</span><span class="p">,</span><span class="w">
                 </span><span class="n">void</span><span class="w"> </span><span class="o">*</span><span class="n">closure</span><span class="p" data-group-id="8870613205-25">)</span><span class="p">;</span><span class="w">

             </span><span class="nc">The</span><span class="w"> </span><span class="n">function</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">call</span><span class="w"> </span><span class="ow">when</span><span class="w"> </span><span class="n">an</span><span class="w"> </span><span class="n">event</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">triggered</span><span class="o">.</span><span class="w">  </span><span class="nc">The</span><span class="w"> </span><span class="n">callback</span><span class="p" data-group-id="8870613205-26">(</span><span class="p" data-group-id="8870613205-26">)</span><span class="w"> </span><span class="n">function</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">run</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">following</span><span class="w"> </span><span class="ss">arguments</span><span class="p">:</span><span class="w">

             </span><span class="n">fd</span><span class="w">    </span><span class="nc">The</span><span class="w"> </span><span class="n">file</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">socket</span><span class="w"> </span><span class="n">descriptor</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="nc">I</span><span class="o">/</span><span class="nc">O</span><span class="o">-</span><span class="n">based</span><span class="w"> </span><span class="n">events</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">signal</span><span class="w"> </span><span class="n">number</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">signal</span><span class="w"> </span><span class="n">events</span><span class="o">.</span><span class="w">

             </span><span class="n">what</span><span class="w">  </span><span class="nc">The</span><span class="w"> </span><span class="n">event</span><span class="w"> </span><span class="n">type</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">triggered</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">callback</span><span class="o">.</span><span class="w">  </span><span class="nc">For</span><span class="w"> </span><span class="n">events</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">have</span><span class="w"> </span><span class="n">multiple</span><span class="w"> </span><span class="n">event</span><span class="w"> </span><span class="n">types</span><span class="w"> </span><span class="p" data-group-id="8870613205-27">(</span><span class="k">for</span><span class="w"> </span><span class="n">example</span><span class="w"> </span><span class="nc">SUDO_PLUGIN_EV_READ</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="nc">SUDO_PLUGIN_EV_WRITE</span><span class="p" data-group-id="8870613205-27">)</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">have</span><span class="w"> </span><span class="n">an</span><span class="w"> </span><span class="n">as</span><span class="err">‐</span><span class="w">
                   </span><span class="n">sociated</span><span class="w"> </span><span class="n">timeout</span><span class="p">,</span><span class="w"> </span><span class="n">what</span><span class="w"> </span><span class="n">can</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">used</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">determine</span><span class="w"> </span><span class="n">why</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">callback</span><span class="w"> </span><span class="n">was</span><span class="w"> </span><span class="n">run</span><span class="o">.</span><span class="w">

             </span><span class="n">closure</span><span class="w">
                   </span><span class="nc">The</span><span class="w"> </span><span class="n">generic</span><span class="w"> </span><span class="n">pointer</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">was</span><span class="w"> </span><span class="n">specified</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">set</span><span class="p" data-group-id="8870613205-28">(</span><span class="p" data-group-id="8870613205-28">)</span><span class="w"> </span><span class="n">function</span><span class="o">.</span><span class="w">

       </span><span class="n">closure</span><span class="w">
             </span><span class="nc">A</span><span class="w"> </span><span class="n">generic</span><span class="w"> </span><span class="n">pointer</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">passed</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">callback</span><span class="w"> </span><span class="n">function</span><span class="o">.</span><span class="w">

       </span><span class="nc">The</span><span class="w"> </span><span class="n">set</span><span class="p" data-group-id="8870613205-29">(</span><span class="p" data-group-id="8870613205-29">)</span><span class="w"> </span><span class="n">function</span><span class="w"> </span><span class="n">returns</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">success</span><span class="p">,</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="o">-</span><span class="mi">1</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">error</span><span class="w"> </span><span class="n">occurred</span><span class="o">.</span><span class="w">

 </span><span class="n">add</span><span class="w">
       </span><span class="n">int</span><span class="w"> </span><span class="p" data-group-id="8870613205-30">(</span><span class="o">*</span><span class="n">add</span><span class="p" data-group-id="8870613205-30">)</span><span class="p" data-group-id="8870613205-31">(</span><span class="n">struct</span><span class="w"> </span><span class="n">sudo_plugin_event</span><span class="w"> </span><span class="o">*</span><span class="n">pev</span><span class="p">,</span><span class="w"> </span><span class="n">struct</span><span class="w"> </span><span class="n">timespec</span><span class="w"> </span><span class="o">*</span><span class="n">timeout</span><span class="p" data-group-id="8870613205-31">)</span><span class="p">;</span><span class="w">

       </span><span class="nc">The</span><span class="w"> </span><span class="n">add</span><span class="p" data-group-id="8870613205-32">(</span><span class="p" data-group-id="8870613205-32">)</span><span class="w"> </span><span class="n">function</span><span class="w"> </span><span class="n">adds</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">event</span><span class="w"> </span><span class="n">pev</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">sudo</span><span class="sc">&#39;s event loop.  The event must have previously been initialized via the set() function.  If the timeout argument is not NULL, it
       should specify a (relative) timeout after which the event will be triggered if the main event criteria has not been met.  This is often used to implement an I/O timeout where
       the event will fire if a descriptor is not ready within a certain time period.  If the event is already present in the event loop, its timeout will be adjusted to match the
       new value, if any.

       The add() function returns 1 on success, and -1 if a error occurred.

 del
       int (*del)(struct sudo_plugin_event *pev);

       The del() function deletes the event pev from sudo&#39;</span><span class="n">s</span><span class="w"> </span><span class="n">event</span><span class="w"> </span><span class="n">loop</span><span class="o">.</span><span class="w">  </span><span class="nc">Deleted</span><span class="w"> </span><span class="n">events</span><span class="w"> </span><span class="n">can</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">added</span><span class="w"> </span><span class="n">back</span><span class="w"> </span><span class="n">via</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">add</span><span class="p" data-group-id="8870613205-33">(</span><span class="p" data-group-id="8870613205-33">)</span><span class="w"> </span><span class="n">function</span><span class="o">.</span><span class="w">

       </span><span class="nc">The</span><span class="w"> </span><span class="n">del</span><span class="p" data-group-id="8870613205-34">(</span><span class="p" data-group-id="8870613205-34">)</span><span class="w"> </span><span class="n">function</span><span class="w"> </span><span class="n">returns</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">success</span><span class="p">,</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="o">-</span><span class="mi">1</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">error</span><span class="w"> </span><span class="n">occurred</span><span class="o">.</span><span class="w">

 </span><span class="n">pending</span><span class="w">
       </span><span class="n">int</span><span class="w"> </span><span class="p" data-group-id="8870613205-35">(</span><span class="o">*</span><span class="n">pending</span><span class="p" data-group-id="8870613205-35">)</span><span class="p" data-group-id="8870613205-36">(</span><span class="n">struct</span><span class="w"> </span><span class="n">sudo_plugin_event</span><span class="w"> </span><span class="o">*</span><span class="n">pev</span><span class="p">,</span><span class="w"> </span><span class="n">int</span><span class="w"> </span><span class="n">events</span><span class="p">,</span><span class="w">
           </span><span class="n">struct</span><span class="w"> </span><span class="n">timespec</span><span class="w"> </span><span class="o">*</span><span class="n">ts</span><span class="p" data-group-id="8870613205-36">)</span><span class="p">;</span><span class="w">

       </span><span class="nc">The</span><span class="w"> </span><span class="n">pending</span><span class="p" data-group-id="8870613205-37">(</span><span class="p" data-group-id="8870613205-37">)</span><span class="w"> </span><span class="n">function</span><span class="w"> </span><span class="n">can</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">used</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">determine</span><span class="w"> </span><span class="n">whether</span><span class="w"> </span><span class="n">one</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">more</span><span class="w"> </span><span class="n">events</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">pending</span><span class="o">.</span><span class="w">  </span><span class="nc">The</span><span class="w"> </span><span class="n">events</span><span class="w"> </span><span class="n">argument</span><span class="w"> </span><span class="n">specifies</span><span class="w"> </span><span class="n">which</span><span class="w"> </span><span class="n">events</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">check</span><span class="w"> </span><span class="k">for</span><span class="o">.</span><span class="w">  </span><span class="nc">See</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">set</span><span class="p" data-group-id="8870613205-38">(</span><span class="p" data-group-id="8870613205-38">)</span><span class="w"> </span><span class="n">function</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">a</span><span class="w">
       </span><span class="n">list</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">valid</span><span class="w"> </span><span class="n">event</span><span class="w"> </span><span class="n">types</span><span class="o">.</span><span class="w">  </span><span class="nc">If</span><span class="w"> </span><span class="nc">SUDO_PLUGIN_EV_TIMEOUT</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">specified</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">events</span><span class="p">,</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">event</span><span class="w"> </span><span class="n">has</span><span class="w"> </span><span class="n">an</span><span class="w"> </span><span class="n">associated</span><span class="w"> </span><span class="n">timeout</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">ts</span><span class="w"> </span><span class="n">pointer</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">non</span><span class="o">-</span><span class="nc">NULL</span><span class="p">,</span><span class="w"> </span><span class="n">it</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">filled</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="k">with</span><span class="w">
       </span><span class="n">the</span><span class="w"> </span><span class="n">remaining</span><span class="w"> </span><span class="n">time</span><span class="o">.</span><span class="w">

 </span><span class="n">fd</span><span class="w">
       </span><span class="n">int</span><span class="w"> </span><span class="p" data-group-id="8870613205-39">(</span><span class="o">*</span><span class="n">fd</span><span class="p" data-group-id="8870613205-39">)</span><span class="p" data-group-id="8870613205-40">(</span><span class="n">struct</span><span class="w"> </span><span class="n">sudo_plugin_event</span><span class="w"> </span><span class="o">*</span><span class="n">pev</span><span class="p" data-group-id="8870613205-40">)</span><span class="p">;</span><span class="w">

       </span><span class="nc">The</span><span class="w"> </span><span class="n">fd</span><span class="p" data-group-id="8870613205-41">(</span><span class="p" data-group-id="8870613205-41">)</span><span class="w"> </span><span class="n">function</span><span class="w"> </span><span class="n">returns</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">descriptor</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">signal</span><span class="w"> </span><span class="n">number</span><span class="w"> </span><span class="n">associated</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">event</span><span class="w"> </span><span class="n">pev</span><span class="o">.</span><span class="w">

 </span><span class="n">setbase</span><span class="w">
       </span><span class="n">void</span><span class="w"> </span><span class="p" data-group-id="8870613205-42">(</span><span class="o">*</span><span class="n">setbase</span><span class="p" data-group-id="8870613205-42">)</span><span class="p" data-group-id="8870613205-43">(</span><span class="n">struct</span><span class="w"> </span><span class="n">sudo_plugin_event</span><span class="w"> </span><span class="o">*</span><span class="n">pev</span><span class="p">,</span><span class="w"> </span><span class="n">void</span><span class="w"> </span><span class="o">*</span><span class="n">base</span><span class="p" data-group-id="8870613205-43">)</span><span class="p">;</span><span class="w">

       </span><span class="nc">The</span><span class="w"> </span><span class="n">setbase</span><span class="p" data-group-id="8870613205-44">(</span><span class="p" data-group-id="8870613205-44">)</span><span class="w"> </span><span class="n">function</span><span class="w"> </span><span class="n">sets</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">underlying</span><span class="w"> </span><span class="n">event</span><span class="w"> </span><span class="n">base</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">pev</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">specified</span><span class="w"> </span><span class="n">value</span><span class="o">.</span><span class="w">  </span><span class="nc">This</span><span class="w"> </span><span class="n">can</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">used</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">move</span><span class="w"> </span><span class="n">an</span><span class="w"> </span><span class="n">event</span><span class="w"> </span><span class="n">created</span><span class="w"> </span><span class="n">via</span><span class="w"> </span><span class="n">event_alloc</span><span class="p" data-group-id="8870613205-45">(</span><span class="p" data-group-id="8870613205-45">)</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">new</span><span class="w"> </span><span class="n">event</span><span class="w"> </span><span class="n">loop</span><span class="w"> </span><span class="n">allo</span><span class="err">‐</span><span class="w">
       </span><span class="n">cated</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">sudo</span><span class="sc">&#39;s event subsystem.  If base is NULL, pev&#39;</span><span class="n">s</span><span class="w"> </span><span class="n">event</span><span class="w"> </span><span class="n">base</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">reset</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">default</span><span class="w"> </span><span class="n">value</span><span class="p">,</span><span class="w"> </span><span class="n">which</span><span class="w"> </span><span class="n">corresponds</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">sudo</span><span class="sc">&#39;s main event loop.  Using this function requires
       linking the plugin with the sudo_util library.  It is unlikely to be used outside of the sudoers plugin.

 loopbreak
       void (*loopbreak)(struct sudo_plugin_event *pev);

       The loopbreak() function causes sudo&#39;</span><span class="n">s</span><span class="w"> </span><span class="n">event</span><span class="w"> </span><span class="n">loop</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">exit</span><span class="w"> </span><span class="n">immediately</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">running</span><span class="w"> </span><span class="n">command</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">terminated</span><span class="o">.</span><span class="w">

 </span><span class="n">free</span><span class="w">
       </span><span class="n">void</span><span class="w"> </span><span class="p" data-group-id="8870613205-46">(</span><span class="o">*</span><span class="n">free</span><span class="p" data-group-id="8870613205-46">)</span><span class="p" data-group-id="8870613205-47">(</span><span class="n">struct</span><span class="w"> </span><span class="n">sudo_plugin_event</span><span class="w"> </span><span class="o">*</span><span class="n">pev</span><span class="p" data-group-id="8870613205-47">)</span><span class="p">;</span><span class="w">

       </span><span class="nc">The</span><span class="w"> </span><span class="n">free</span><span class="p" data-group-id="8870613205-48">(</span><span class="p" data-group-id="8870613205-48">)</span><span class="w"> </span><span class="n">function</span><span class="w"> </span><span class="n">deletes</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">event</span><span class="w"> </span><span class="n">pev</span><span class="w"> </span><span class="n">from</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">event</span><span class="w"> </span><span class="n">loop</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">frees</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">memory</span><span class="w"> </span><span class="n">associated</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">it</span><span class="o">.</span></code></pre><p>   Remote command execution</p><pre><code class="makeup elixir" translate="no"><span class="w"> </span><span class="nc">The</span><span class="w"> </span><span class="n">sudo</span><span class="w"> </span><span class="n">front</span><span class="o">-</span><span class="k">end</span><span class="w"> </span><span class="n">does</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">support</span><span class="w"> </span><span class="n">running</span><span class="w"> </span><span class="n">remote</span><span class="w"> </span><span class="n">commands</span><span class="o">.</span><span class="w">  </span><span class="nc">However</span><span class="p">,</span><span class="w"> </span><span class="n">starting</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">sudo</span><span class="w"> </span><span class="mf">1.8</span><span class="o">.</span><span class="mi">8</span><span class="p">,</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="o">-</span><span class="n">h</span><span class="w"> </span><span class="n">option</span><span class="w"> </span><span class="n">may</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">used</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">specify</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">remote</span><span class="w"> </span><span class="n">host</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">passed</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">policy</span><span class="w">
 </span><span class="n">plugin</span><span class="o">.</span><span class="w">  </span><span class="nc">A</span><span class="w"> </span><span class="n">plugin</span><span class="w"> </span><span class="n">may</span><span class="w"> </span><span class="n">also</span><span class="w"> </span><span class="n">accept</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">runas_user</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">form</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="err">“</span><span class="n">user</span><span class="na">@hostname</span><span class="err">”</span><span class="w"> </span><span class="n">which</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">work</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">older</span><span class="w"> </span><span class="n">versions</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">sudo</span><span class="o">.</span><span class="w">  </span><span class="nc">It</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">anticipated</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">remote</span><span class="w"> </span><span class="n">commands</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">supported</span><span class="w">
 </span><span class="n">by</span><span class="w"> </span><span class="n">executing</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="err">“</span><span class="n">helper</span><span class="err">”</span><span class="w"> </span><span class="n">program</span><span class="o">.</span><span class="w">  </span><span class="nc">The</span><span class="w"> </span><span class="n">policy</span><span class="w"> </span><span class="n">plugin</span><span class="w"> </span><span class="n">should</span><span class="w"> </span><span class="n">setup</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">execution</span><span class="w"> </span><span class="n">environment</span><span class="w"> </span><span class="n">such</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">sudo</span><span class="w"> </span><span class="n">front</span><span class="o">-</span><span class="k">end</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">run</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">helper</span><span class="w"> </span><span class="n">which</span><span class="p">,</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">turn</span><span class="p">,</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">connect</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">re</span><span class="err">‐</span><span class="w">
 </span><span class="n">mote</span><span class="w"> </span><span class="n">host</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">run</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">command</span><span class="o">.</span><span class="w">

 </span><span class="nc">For</span><span class="w"> </span><span class="n">example</span><span class="p">,</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">policy</span><span class="w"> </span><span class="n">plugin</span><span class="w"> </span><span class="n">could</span><span class="w"> </span><span class="n">utilize</span><span class="w"> </span><span class="n">ssh</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">perform</span><span class="w"> </span><span class="n">remote</span><span class="w"> </span><span class="n">command</span><span class="w"> </span><span class="n">execution</span><span class="o">.</span><span class="w">  </span><span class="nc">The</span><span class="w"> </span><span class="n">helper</span><span class="w"> </span><span class="n">program</span><span class="w"> </span><span class="n">would</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">responsible</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">running</span><span class="w"> </span><span class="n">ssh</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">proper</span><span class="w"> </span><span class="n">options</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="kn">use</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">pri</span><span class="err">‐</span><span class="w">
 </span><span class="n">vate</span><span class="w"> </span><span class="n">key</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">certificate</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">remote</span><span class="w"> </span><span class="n">host</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">accept</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">run</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">program</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">remote</span><span class="w"> </span><span class="n">host</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">would</span><span class="w"> </span><span class="n">setup</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">execution</span><span class="w"> </span><span class="n">environment</span><span class="w"> </span><span class="n">accordingly</span><span class="o">.</span><span class="w">

 </span><span class="nc">Remote</span><span class="w"> </span><span class="n">sudoedit</span><span class="w"> </span><span class="n">functionality</span><span class="w"> </span><span class="n">must</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">handled</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">policy</span><span class="w"> </span><span class="n">plugin</span><span class="p">,</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">sudo</span><span class="w"> </span><span class="n">itself</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">front</span><span class="o">-</span><span class="k">end</span><span class="w"> </span><span class="n">has</span><span class="w"> </span><span class="n">no</span><span class="w"> </span><span class="n">knowledge</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">remote</span><span class="w"> </span><span class="n">command</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">being</span><span class="w"> </span><span class="n">executed</span><span class="o">.</span><span class="w">  </span><span class="nc">This</span><span class="w"> </span><span class="n">may</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">ad</span><span class="err">‐</span><span class="w">
 </span><span class="n">dressed</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">future</span><span class="w"> </span><span class="n">revision</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">plugin</span><span class="w"> </span><span class="nc">API</span><span class="o">.</span></code></pre><p>   Conversation API</p><pre><code class="makeup elixir" translate="no"><span class="w"> </span><span class="nc">If</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">plugin</span><span class="w"> </span><span class="n">needs</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">interact</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">user</span><span class="p">,</span><span class="w"> </span><span class="n">it</span><span class="w"> </span><span class="n">may</span><span class="w"> </span><span class="k" data-group-id="7418233676-1">do</span><span class="w"> </span><span class="n">so</span><span class="w"> </span><span class="n">via</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">conversation</span><span class="p" data-group-id="7418233676-2">(</span><span class="p" data-group-id="7418233676-2">)</span><span class="w"> </span><span class="n">function</span><span class="o">.</span><span class="w">  </span><span class="nc">A</span><span class="w"> </span><span class="n">plugin</span><span class="w"> </span><span class="n">should</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">attempt</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">read</span><span class="w"> </span><span class="n">directly</span><span class="w"> </span><span class="n">from</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">standard</span><span class="w"> </span><span class="n">input</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">user</span><span class="sc">&#39;s
 terminal (neither of which are guaranteed to exist).  The caller must include a trailing newline in msg if one is to be printed.

 A printf()-style function is also available that can be used to display informational or error messages to the user, which is usually more convenient for simple messages where no
 use input is required.

 Conversation function structures

 The conversation function takes as arguments pointers to the following structures:

 struct sudo_conv_message {
 #define SUDO_CONV_PROMPT_ECHO_OFF  0x0001 /* do not echo user input */
 #define SUDO_CONV_PROMPT_ECHO_ON   0x0002 /* echo user input */
 #define SUDO_CONV_ERROR_MSG        0x0003 /* error message */
 #define SUDO_CONV_INFO_MSG         0x0004 /* informational message */
 #define SUDO_CONV_PROMPT_MASK      0x0005 /* mask user input */
 #define SUDO_CONV_PROMPT_ECHO_OK   0x1000 /* flag: allow echo if no tty */
 #define SUDO_CONV_PREFER_TTY       0x2000 /* flag: use tty if possible */
     int msg_type;
     int timeout;
     const char *msg;
 };

 #define SUDO_CONV_REPL_MAX      1023

 struct sudo_conv_reply {
     char *reply;
 };

 typedef int (*sudo_conv_callback_fn_t)(int signo, void *closure);
 struct sudo_conv_callback {
     unsigned int version;
     void *closure;
     sudo_conv_callback_fn_t on_suspend;
     sudo_conv_callback_fn_t on_resume;
 };

 Pointers to the conversation() and printf()-style functions are passed in to the plugin&#39;</span><span class="n">s</span><span class="w"> </span><span class="n">open</span><span class="p" data-group-id="7418233676-3">(</span><span class="p" data-group-id="7418233676-3">)</span><span class="w"> </span><span class="n">function</span><span class="w"> </span><span class="ow">when</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">plugin</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">initialized</span><span class="o">.</span><span class="w">  </span><span class="nc">The</span><span class="w"> </span><span class="n">following</span><span class="w"> </span><span class="n">type</span><span class="w"> </span><span class="n">definitions</span><span class="w"> </span><span class="n">can</span><span class="w"> </span><span class="n">be</span><span class="w">
 </span><span class="n">used</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">declaration</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">open</span><span class="p" data-group-id="7418233676-4">(</span><span class="p" data-group-id="7418233676-4">)</span><span class="w"> </span><span class="ss">function</span><span class="p">:</span><span class="w">

 </span><span class="n">typedef</span><span class="w"> </span><span class="n">int</span><span class="w"> </span><span class="p" data-group-id="7418233676-5">(</span><span class="o">*</span><span class="n">sudo_conv_t</span><span class="p" data-group-id="7418233676-5">)</span><span class="p" data-group-id="7418233676-6">(</span><span class="n">int</span><span class="w"> </span><span class="n">num_msgs</span><span class="p">,</span><span class="w">
     </span><span class="n">const</span><span class="w"> </span><span class="n">struct</span><span class="w"> </span><span class="n">sudo_conv_message</span><span class="w"> </span><span class="n">msgs</span><span class="p" data-group-id="7418233676-7">[</span><span class="p" data-group-id="7418233676-7">]</span><span class="p">,</span><span class="w">
     </span><span class="n">struct</span><span class="w"> </span><span class="n">sudo_conv_reply</span><span class="w"> </span><span class="n">replies</span><span class="p" data-group-id="7418233676-8">[</span><span class="p" data-group-id="7418233676-8">]</span><span class="p">,</span><span class="w"> </span><span class="n">struct</span><span class="w"> </span><span class="n">sudo_conv_callback</span><span class="w"> </span><span class="o">*</span><span class="n">callback</span><span class="p" data-group-id="7418233676-6">)</span><span class="p">;</span><span class="w">

 </span><span class="n">typedef</span><span class="w"> </span><span class="n">int</span><span class="w"> </span><span class="p" data-group-id="7418233676-9">(</span><span class="o">*</span><span class="n">sudo_printf_t</span><span class="p" data-group-id="7418233676-9">)</span><span class="p" data-group-id="7418233676-10">(</span><span class="n">int</span><span class="w"> </span><span class="n">msg_type</span><span class="p">,</span><span class="w"> </span><span class="n">const</span><span class="w"> </span><span class="n">char</span><span class="w"> </span><span class="o">*</span><span class="n">fmt</span><span class="p">,</span><span class="w"> </span><span class="n">...</span><span class="p" data-group-id="7418233676-10">)</span><span class="p">;</span><span class="w">

 </span><span class="nc">To</span><span class="w"> </span><span class="kn">use</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">conversation</span><span class="p" data-group-id="7418233676-11">(</span><span class="p" data-group-id="7418233676-11">)</span><span class="w"> </span><span class="n">function</span><span class="p">,</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">plugin</span><span class="w"> </span><span class="n">must</span><span class="w"> </span><span class="n">pass</span><span class="w"> </span><span class="n">an</span><span class="w"> </span><span class="n">array</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">struct</span><span class="w"> </span><span class="n">sudo_conv_message</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">struct</span><span class="w"> </span><span class="n">sudo_conv_reply</span><span class="o">.</span><span class="w">  </span><span class="nc">There</span><span class="w"> </span><span class="n">must</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">struct</span><span class="w"> </span><span class="n">sudo_conv_message</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">struct</span><span class="w">
 </span><span class="n">sudo_conv_reply</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">each</span><span class="w"> </span><span class="n">message</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">conversation</span><span class="p">,</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">is</span><span class="p">,</span><span class="w"> </span><span class="n">both</span><span class="w"> </span><span class="n">arrays</span><span class="w"> </span><span class="n">must</span><span class="w"> </span><span class="n">have</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">same</span><span class="w"> </span><span class="n">number</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">elements</span><span class="o">.</span><span class="w">  </span><span class="nc">Each</span><span class="w"> </span><span class="n">struct</span><span class="w"> </span><span class="n">sudo_conv_reply</span><span class="w"> </span><span class="n">must</span><span class="w"> </span><span class="n">have</span><span class="w"> </span><span class="n">its</span><span class="w"> </span><span class="n">reply</span><span class="w"> </span><span class="n">member</span><span class="w"> </span><span class="n">initial</span><span class="err">‐</span><span class="w">
 </span><span class="n">ized</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="nc">NULL</span><span class="o">.</span><span class="w">  </span><span class="nc">The</span><span class="w"> </span><span class="n">struct</span><span class="w"> </span><span class="n">sudo_conv_callback</span><span class="w"> </span><span class="n">pointer</span><span class="p">,</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="nc">NULL</span><span class="p">,</span><span class="w"> </span><span class="n">should</span><span class="w"> </span><span class="n">contain</span><span class="w"> </span><span class="n">function</span><span class="w"> </span><span class="n">pointers</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">called</span><span class="w"> </span><span class="ow">when</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">sudo</span><span class="w"> </span><span class="n">process</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">suspended</span><span class="w"> </span><span class="ow">and</span><span class="o">/</span><span class="ow">or</span><span class="w"> </span><span class="n">resumed</span><span class="w"> </span><span class="n">during</span><span class="w"> </span><span class="n">conversa</span><span class="err">‐</span><span class="w">
 </span><span class="n">tion</span><span class="w"> </span><span class="n">input</span><span class="o">.</span><span class="w">  </span><span class="nc">The</span><span class="w"> </span><span class="n">on_suspend</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">on_resume</span><span class="w"> </span><span class="n">functions</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">called</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">signal</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">caused</span><span class="w"> </span><span class="n">sudo</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">suspended</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">closure</span><span class="w"> </span><span class="n">pointer</span><span class="w"> </span><span class="n">from</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">struct</span><span class="w"> </span><span class="n">sudo_conv_callback</span><span class="o">.</span><span class="w">  </span><span class="nc">These</span><span class="w">
 </span><span class="n">functions</span><span class="w"> </span><span class="n">should</span><span class="w"> </span><span class="n">return</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">success</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="o">-</span><span class="mi">1</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">error</span><span class="o">.</span><span class="w">  </span><span class="nc">On</span><span class="w"> </span><span class="n">error</span><span class="p">,</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">conversation</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="k" data-group-id="7418233676-1">end</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">conversation</span><span class="w"> </span><span class="n">function</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">return</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">value</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="o">-</span><span class="mi">1</span><span class="o">.</span><span class="w">  </span><span class="nc">The</span><span class="w"> </span><span class="n">intended</span><span class="w"> </span><span class="kn">use</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">allow</span><span class="w">
 </span><span class="n">the</span><span class="w"> </span><span class="n">plugin</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">release</span><span class="w"> </span><span class="n">resources</span><span class="p">,</span><span class="w"> </span><span class="n">such</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="n">locks</span><span class="p">,</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">should</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">held</span><span class="w"> </span><span class="n">indefinitely</span><span class="w"> </span><span class="n">while</span><span class="w"> </span><span class="n">suspended</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">then</span><span class="w"> </span><span class="n">reacquire</span><span class="w"> </span><span class="n">them</span><span class="w"> </span><span class="ow">when</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">process</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">resumed</span><span class="o">.</span><span class="w">  </span><span class="nc">The</span><span class="w"> </span><span class="n">functions</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">ac</span><span class="err">‐</span><span class="w">
 </span><span class="n">tually</span><span class="w"> </span><span class="n">invoked</span><span class="w"> </span><span class="n">from</span><span class="w"> </span><span class="n">within</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">signal</span><span class="w"> </span><span class="n">handler</span><span class="o">.</span><span class="w">

 </span><span class="nc">The</span><span class="w"> </span><span class="n">msg_type</span><span class="w"> </span><span class="n">must</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">set</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">one</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">following</span><span class="w"> </span><span class="ss">values</span><span class="p">:</span><span class="w">

 </span><span class="nc">SUDO_CONV_PROMPT_ECHO_OFF</span><span class="w">
       </span><span class="nc">Prompt</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">user</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">input</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">echo</span><span class="w"> </span><span class="n">disabled</span><span class="p">;</span><span class="w"> </span><span class="n">this</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">generally</span><span class="w"> </span><span class="n">used</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">passwords</span><span class="o">.</span><span class="w">  </span><span class="nc">The</span><span class="w"> </span><span class="n">reply</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">stored</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">replies</span><span class="w"> </span><span class="n">array</span><span class="p">,</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">it</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">never</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="nc">NULL</span><span class="o">.</span><span class="w">

 </span><span class="nc">SUDO_CONV_PROMPT_ECHO_ON</span><span class="w">
       </span><span class="nc">Prompt</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">user</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">input</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">echo</span><span class="w"> </span><span class="n">enabled</span><span class="o">.</span><span class="w">  </span><span class="nc">The</span><span class="w"> </span><span class="n">reply</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">stored</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">replies</span><span class="w"> </span><span class="n">array</span><span class="p">,</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">it</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">never</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="nc">NULL</span><span class="o">.</span><span class="w">

 </span><span class="nc">SUDO_CONV_ERROR_MSG</span><span class="w">
       </span><span class="nc">Display</span><span class="w"> </span><span class="n">an</span><span class="w"> </span><span class="n">error</span><span class="w"> </span><span class="n">message</span><span class="o">.</span><span class="w">  </span><span class="nc">The</span><span class="w"> </span><span class="n">message</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">written</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">standard</span><span class="w"> </span><span class="n">error</span><span class="w"> </span><span class="k">unless</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nc">SUDO_CONV_PREFER_TTY</span><span class="w"> </span><span class="n">flag</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">set</span><span class="p">,</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">which</span><span class="w"> </span><span class="k">case</span><span class="w"> </span><span class="n">it</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">written</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">user</span><span class="sc">&#39;s terminal if
       possible.

 SUDO_CONV_INFO_MSG
       Display a message.  The message is written to the standard output unless the SUDO_CONV_PREFER_TTY flag is set, in which case it is written to the user&#39;</span><span class="n">s</span><span class="w"> </span><span class="n">terminal</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">possible</span><span class="o">.</span><span class="w">

 </span><span class="nc">SUDO_CONV_PROMPT_MASK</span><span class="w">
       </span><span class="nc">Prompt</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">user</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">input</span><span class="w"> </span><span class="n">but</span><span class="w"> </span><span class="n">echo</span><span class="w"> </span><span class="n">an</span><span class="w"> </span><span class="n">asterisk</span><span class="w"> </span><span class="n">character</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">each</span><span class="w"> </span><span class="n">character</span><span class="w"> </span><span class="n">read</span><span class="o">.</span><span class="w">  </span><span class="nc">The</span><span class="w"> </span><span class="n">reply</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">stored</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">replies</span><span class="w"> </span><span class="n">array</span><span class="p">,</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">it</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">never</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="nc">NULL</span><span class="o">.</span><span class="w">  </span><span class="nc">This</span><span class="w"> </span><span class="n">can</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">used</span><span class="w">
       </span><span class="n">to</span><span class="w"> </span><span class="n">provide</span><span class="w"> </span><span class="n">visual</span><span class="w"> </span><span class="n">feedback</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">user</span><span class="w"> </span><span class="n">while</span><span class="w"> </span><span class="n">reading</span><span class="w"> </span><span class="n">sensitive</span><span class="w"> </span><span class="n">information</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">should</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">displayed</span><span class="o">.</span><span class="w">

 </span><span class="nc">In</span><span class="w"> </span><span class="n">addition</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">above</span><span class="w"> </span><span class="n">values</span><span class="p">,</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">following</span><span class="w"> </span><span class="n">flag</span><span class="w"> </span><span class="n">bits</span><span class="w"> </span><span class="n">may</span><span class="w"> </span><span class="n">also</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="ss">set</span><span class="p">:</span><span class="w">

 </span><span class="nc">SUDO_CONV_PROMPT_ECHO_OK</span><span class="w">
       </span><span class="nc">Allow</span><span class="w"> </span><span class="n">input</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">read</span><span class="w"> </span><span class="ow">when</span><span class="w"> </span><span class="n">echo</span><span class="w"> </span><span class="n">cannot</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">disabled</span><span class="w"> </span><span class="ow">when</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">message</span><span class="w"> </span><span class="n">type</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="nc">SUDO_CONV_PROMPT_ECHO_OFF</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="nc">SUDO_CONV_PROMPT_MASK</span><span class="o">.</span><span class="w">  </span><span class="nc">By</span><span class="w"> </span><span class="n">default</span><span class="p">,</span><span class="w"> </span><span class="n">sudo</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">refuse</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">read</span><span class="w"> </span><span class="n">input</span><span class="w">
       </span><span class="k">if</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">echo</span><span class="w"> </span><span class="n">cannot</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">disabled</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">those</span><span class="w"> </span><span class="n">message</span><span class="w"> </span><span class="n">types</span><span class="o">.</span><span class="w">

 </span><span class="nc">SUDO_CONV_PREFER_TTY</span><span class="w">
       </span><span class="nc">When</span><span class="w"> </span><span class="n">displaying</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">message</span><span class="w"> </span><span class="n">via</span><span class="w"> </span><span class="nc">SUDO_CONV_ERROR_MSG</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="nc">SUDO_CONV_INFO_MSG</span><span class="p">,</span><span class="w"> </span><span class="k">try</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">write</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">message</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">user</span><span class="sc">&#39;s terminal.  If the terminal is unavailable, the standard error
       or standard output will be used, depending upon whether SUDO_CONV_ERROR_MSG or SUDO_CONV_INFO_MSG was used.  The user&#39;</span><span class="n">s</span><span class="w"> </span><span class="n">terminal</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">always</span><span class="w"> </span><span class="n">used</span><span class="w"> </span><span class="ow">when</span><span class="w"> </span><span class="n">possible</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">input</span><span class="p">,</span><span class="w"> </span><span class="n">this</span><span class="w">
       </span><span class="n">flag</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">only</span><span class="w"> </span><span class="n">used</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">output</span><span class="o">.</span><span class="w">

 </span><span class="nc">The</span><span class="w"> </span><span class="n">timeout</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">seconds</span><span class="w"> </span><span class="n">until</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">prompt</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">wait</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">no</span><span class="w"> </span><span class="n">more</span><span class="w"> </span><span class="n">input</span><span class="o">.</span><span class="w">  </span><span class="nc">A</span><span class="w"> </span><span class="n">zero</span><span class="w"> </span><span class="n">value</span><span class="w"> </span><span class="n">implies</span><span class="w"> </span><span class="n">an</span><span class="w"> </span><span class="n">infinite</span><span class="w"> </span><span class="n">timeout</span><span class="o">.</span><span class="w">

 </span><span class="nc">The</span><span class="w"> </span><span class="n">plugin</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">responsible</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">freeing</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">reply</span><span class="w"> </span><span class="n">buffer</span><span class="w"> </span><span class="n">located</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">each</span><span class="w"> </span><span class="n">struct</span><span class="w"> </span><span class="n">sudo_conv_reply</span><span class="p">,</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">it</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="nc">NULL</span><span class="o">.</span><span class="w">  </span><span class="nc">SUDO_CONV_REPL_MAX</span><span class="w"> </span><span class="n">represents</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">maximum</span><span class="w"> </span><span class="n">length</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">reply</span><span class="w">
 </span><span class="n">buffer</span><span class="w"> </span><span class="p" data-group-id="7418233676-12">(</span><span class="ow">not</span><span class="w"> </span><span class="n">including</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">trailing</span><span class="w"> </span><span class="nc">NUL</span><span class="w"> </span><span class="n">character</span><span class="p" data-group-id="7418233676-12">)</span><span class="o">.</span><span class="w">  </span><span class="nc">In</span><span class="w"> </span><span class="n">practical</span><span class="w"> </span><span class="n">terms</span><span class="p">,</span><span class="w"> </span><span class="n">this</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">longest</span><span class="w"> </span><span class="n">password</span><span class="w"> </span><span class="n">sudo</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">support</span><span class="o">.</span><span class="w">

 </span><span class="nc">The</span><span class="w"> </span><span class="n">printf</span><span class="p" data-group-id="7418233676-13">(</span><span class="p" data-group-id="7418233676-13">)</span><span class="o">-</span><span class="n">style</span><span class="w"> </span><span class="n">function</span><span class="w"> </span><span class="n">uses</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">same</span><span class="w"> </span><span class="n">underlying</span><span class="w"> </span><span class="n">mechanism</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">conversation</span><span class="p" data-group-id="7418233676-14">(</span><span class="p" data-group-id="7418233676-14">)</span><span class="w"> </span><span class="n">function</span><span class="w"> </span><span class="n">but</span><span class="w"> </span><span class="n">only</span><span class="w"> </span><span class="n">supports</span><span class="w"> </span><span class="nc">SUDO_CONV_INFO_MSG</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="nc">SUDO_CONV_ERROR_MSG</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">msg_type</span><span class="w"> </span><span class="n">parame</span><span class="err">‐</span><span class="w">
 </span><span class="n">ter</span><span class="o">.</span><span class="w">  </span><span class="nc">It</span><span class="w"> </span><span class="n">can</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">more</span><span class="w"> </span><span class="n">convenient</span><span class="w"> </span><span class="n">than</span><span class="w"> </span><span class="n">using</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">conversation</span><span class="p" data-group-id="7418233676-15">(</span><span class="p" data-group-id="7418233676-15">)</span><span class="w"> </span><span class="n">function</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">no</span><span class="w"> </span><span class="n">user</span><span class="w"> </span><span class="n">reply</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">needed</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">supports</span><span class="w"> </span><span class="n">standard</span><span class="w"> </span><span class="n">printf</span><span class="p" data-group-id="7418233676-16">(</span><span class="p" data-group-id="7418233676-16">)</span><span class="w"> </span><span class="n">escape</span><span class="w"> </span><span class="n">sequences</span><span class="o">.</span><span class="w">

 </span><span class="nc">See</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">sample</span><span class="w"> </span><span class="n">plugin</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">an</span><span class="w"> </span><span class="n">example</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">conversation</span><span class="p" data-group-id="7418233676-17">(</span><span class="p" data-group-id="7418233676-17">)</span><span class="w"> </span><span class="n">function</span><span class="w"> </span><span class="n">usage</span><span class="o">.</span></code></pre><p>   Plugin invocation order</p><pre><code class="makeup elixir" translate="no"><span class="w"> </span><span class="nc">As</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">sudo</span><span class="w"> </span><span class="mf">1.9</span><span class="o">.</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">plugin</span><span class="w"> </span><span class="n">open</span><span class="p" data-group-id="2950786860-1">(</span><span class="p" data-group-id="2950786860-1">)</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">close</span><span class="p" data-group-id="2950786860-2">(</span><span class="p" data-group-id="2950786860-2">)</span><span class="w"> </span><span class="n">functions</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">called</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">following</span><span class="w"> </span><span class="ss">order</span><span class="p">:</span><span class="w">

 </span><span class="mi">1</span><span class="o">.</span><span class="w">   </span><span class="n">audit</span><span class="w"> </span><span class="n">open</span><span class="w">

 </span><span class="mi">2</span><span class="o">.</span><span class="w">   </span><span class="n">policy</span><span class="w"> </span><span class="n">open</span><span class="w">

 </span><span class="mi">3</span><span class="o">.</span><span class="w">   </span><span class="n">approval</span><span class="w"> </span><span class="n">open</span><span class="w">

 </span><span class="mi">4</span><span class="o">.</span><span class="w">   </span><span class="n">approval</span><span class="w"> </span><span class="n">close</span><span class="w">

 </span><span class="mi">5</span><span class="o">.</span><span class="w">   </span><span class="nc">I</span><span class="o">/</span><span class="nc">O</span><span class="w"> </span><span class="n">log</span><span class="w"> </span><span class="n">open</span><span class="w">

 </span><span class="mi">6</span><span class="o">.</span><span class="w">   </span><span class="n">command</span><span class="w"> </span><span class="n">runs</span><span class="w">

 </span><span class="mi">7</span><span class="o">.</span><span class="w">   </span><span class="n">command</span><span class="w"> </span><span class="n">exits</span><span class="w">

 </span><span class="mi">8</span><span class="o">.</span><span class="w">   </span><span class="nc">I</span><span class="o">/</span><span class="nc">O</span><span class="w"> </span><span class="n">log</span><span class="w"> </span><span class="n">close</span><span class="w">

 </span><span class="mi">9</span><span class="o">.</span><span class="w">   </span><span class="n">policy</span><span class="w"> </span><span class="n">close</span><span class="w">

 </span><span class="mi">10</span><span class="o">.</span><span class="w">  </span><span class="n">audit</span><span class="w"> </span><span class="n">close</span><span class="w">

 </span><span class="mi">11</span><span class="o">.</span><span class="w">  </span><span class="n">sudo</span><span class="w"> </span><span class="n">exits</span><span class="w">

 </span><span class="nc">Prior</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">sudo</span><span class="w"> </span><span class="mf">1.9</span><span class="o">.</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nc">I</span><span class="o">/</span><span class="nc">O</span><span class="w"> </span><span class="n">log</span><span class="w"> </span><span class="n">close</span><span class="p" data-group-id="2950786860-3">(</span><span class="p" data-group-id="2950786860-3">)</span><span class="w"> </span><span class="n">function</span><span class="w"> </span><span class="n">was</span><span class="w"> </span><span class="n">called</span><span class="w"> </span><span class="k">after</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">policy</span><span class="w"> </span><span class="n">close</span><span class="p" data-group-id="2950786860-4">(</span><span class="p" data-group-id="2950786860-4">)</span><span class="w"> </span><span class="n">function</span><span class="o">.</span></code></pre><p>   Sudoers group plugin API</p><pre><code class="makeup elixir" translate="no"><span class="w"> </span><span class="nc">The</span><span class="w"> </span><span class="n">sudoers</span><span class="w"> </span><span class="n">plugin</span><span class="w"> </span><span class="n">supports</span><span class="w"> </span><span class="n">its</span><span class="w"> </span><span class="n">own</span><span class="w"> </span><span class="n">plugin</span><span class="w"> </span><span class="n">interface</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">allow</span><span class="w"> </span><span class="n">non</span><span class="o">-</span><span class="nc">Unix</span><span class="w"> </span><span class="n">group</span><span class="w"> </span><span class="n">lookups</span><span class="o">.</span><span class="w">  </span><span class="nc">This</span><span class="w"> </span><span class="n">can</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">used</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">query</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">group</span><span class="w"> </span><span class="n">source</span><span class="w"> </span><span class="n">other</span><span class="w"> </span><span class="n">than</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">standard</span><span class="w"> </span><span class="nc">Unix</span><span class="w"> </span><span class="n">group</span><span class="w"> </span><span class="n">database</span><span class="o">.</span><span class="w">  </span><span class="nc">Two</span><span class="w">
 </span><span class="n">sample</span><span class="w"> </span><span class="n">group</span><span class="w"> </span><span class="n">plugins</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">bundled</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">sudo</span><span class="p">,</span><span class="w"> </span><span class="n">group_file</span><span class="p">,</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">system_group</span><span class="p">,</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">detailed</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">sudoers</span><span class="p" data-group-id="8026972552-1">(</span><span class="mi">5</span><span class="p" data-group-id="8026972552-1">)</span><span class="o">.</span><span class="w">  </span><span class="nc">Third</span><span class="w"> </span><span class="n">party</span><span class="w"> </span><span class="n">group</span><span class="w"> </span><span class="n">plugins</span><span class="w"> </span><span class="n">include</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="nc">QAS</span><span class="w"> </span><span class="nc">AD</span><span class="w"> </span><span class="n">plugin</span><span class="w"> </span><span class="n">available</span><span class="w"> </span><span class="n">from</span><span class="w"> </span><span class="nc">Quest</span><span class="w"> </span><span class="nc">Soft</span><span class="err">‐</span><span class="w">
 </span><span class="n">ware</span><span class="o">.</span><span class="w">

 </span><span class="nc">A</span><span class="w"> </span><span class="n">group</span><span class="w"> </span><span class="n">plugin</span><span class="w"> </span><span class="n">must</span><span class="w"> </span><span class="n">declare</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">populate</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">struct</span><span class="w"> </span><span class="n">sudoers_group_plugin</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">global</span><span class="w"> </span><span class="n">scope</span><span class="o">.</span><span class="w">  </span><span class="nc">This</span><span class="w"> </span><span class="n">structure</span><span class="w"> </span><span class="n">contains</span><span class="w"> </span><span class="n">pointers</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">functions</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">implement</span><span class="w"> </span><span class="n">plugin</span><span class="w"> </span><span class="n">initialization</span><span class="p">,</span><span class="w">
 </span><span class="n">cleanup</span><span class="p">,</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">group</span><span class="w"> </span><span class="n">lookup</span><span class="o">.</span><span class="w">

 </span><span class="n">struct</span><span class="w"> </span><span class="n">sudoers_group_plugin</span><span class="w"> </span><span class="p" data-group-id="8026972552-2">{</span><span class="w">
     </span><span class="n">unsigned</span><span class="w"> </span><span class="n">int</span><span class="w"> </span><span class="n">version</span><span class="p">;</span><span class="w">
     </span><span class="n">int</span><span class="w"> </span><span class="p" data-group-id="8026972552-3">(</span><span class="o">*</span><span class="n">init</span><span class="p" data-group-id="8026972552-3">)</span><span class="p" data-group-id="8026972552-4">(</span><span class="n">int</span><span class="w"> </span><span class="n">version</span><span class="p">,</span><span class="w"> </span><span class="n">sudo_printf_t</span><span class="w"> </span><span class="n">sudo_plugin_printf</span><span class="p">,</span><span class="w">
         </span><span class="n">char</span><span class="w"> </span><span class="o">*</span><span class="n">const</span><span class="w"> </span><span class="n">argv</span><span class="p" data-group-id="8026972552-5">[</span><span class="p" data-group-id="8026972552-5">]</span><span class="p" data-group-id="8026972552-4">)</span><span class="p">;</span><span class="w">
     </span><span class="n">void</span><span class="w"> </span><span class="p" data-group-id="8026972552-6">(</span><span class="o">*</span><span class="n">cleanup</span><span class="p" data-group-id="8026972552-6">)</span><span class="p" data-group-id="8026972552-7">(</span><span class="n">void</span><span class="p" data-group-id="8026972552-7">)</span><span class="p">;</span><span class="w">
     </span><span class="n">int</span><span class="w"> </span><span class="p" data-group-id="8026972552-8">(</span><span class="o">*</span><span class="n">query</span><span class="p" data-group-id="8026972552-8">)</span><span class="p" data-group-id="8026972552-9">(</span><span class="n">const</span><span class="w"> </span><span class="n">char</span><span class="w"> </span><span class="o">*</span><span class="n">user</span><span class="p">,</span><span class="w"> </span><span class="n">const</span><span class="w"> </span><span class="n">char</span><span class="w"> </span><span class="o">*</span><span class="n">group</span><span class="p">,</span><span class="w">
         </span><span class="n">const</span><span class="w"> </span><span class="n">struct</span><span class="w"> </span><span class="n">passwd</span><span class="w"> </span><span class="o">*</span><span class="n">pwd</span><span class="p" data-group-id="8026972552-9">)</span><span class="p">;</span><span class="w">
 </span><span class="p" data-group-id="8026972552-2">}</span><span class="p">;</span><span class="w">

 </span><span class="nc">A</span><span class="w"> </span><span class="n">struct</span><span class="w"> </span><span class="n">sudoers_group_plugin</span><span class="w"> </span><span class="n">has</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">following</span><span class="w"> </span><span class="ss">fields</span><span class="p">:</span><span class="w">

 </span><span class="n">version</span><span class="w">
       </span><span class="nc">The</span><span class="w"> </span><span class="n">version</span><span class="w"> </span><span class="n">field</span><span class="w"> </span><span class="n">should</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">set</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="nc">GROUP_API_VERSION</span><span class="o">.</span><span class="w">

       </span><span class="nc">This</span><span class="w"> </span><span class="n">allows</span><span class="w"> </span><span class="n">sudoers</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">determine</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nc">API</span><span class="w"> </span><span class="n">version</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">group</span><span class="w"> </span><span class="n">plugin</span><span class="w"> </span><span class="n">was</span><span class="w"> </span><span class="n">built</span><span class="w"> </span><span class="n">against</span><span class="o">.</span><span class="w">

 </span><span class="n">init</span><span class="w">
       </span><span class="n">int</span><span class="w"> </span><span class="p" data-group-id="8026972552-10">(</span><span class="o">*</span><span class="n">init</span><span class="p" data-group-id="8026972552-10">)</span><span class="p" data-group-id="8026972552-11">(</span><span class="n">int</span><span class="w"> </span><span class="n">version</span><span class="p">,</span><span class="w"> </span><span class="n">sudo_printf_t</span><span class="w"> </span><span class="n">sudo_plugin_printf</span><span class="p">,</span><span class="w">
           </span><span class="n">char</span><span class="w"> </span><span class="o">*</span><span class="n">const</span><span class="w"> </span><span class="n">argv</span><span class="p" data-group-id="8026972552-12">[</span><span class="p" data-group-id="8026972552-12">]</span><span class="p" data-group-id="8026972552-11">)</span><span class="p">;</span><span class="w">

       </span><span class="nc">The</span><span class="w"> </span><span class="n">init</span><span class="p" data-group-id="8026972552-13">(</span><span class="p" data-group-id="8026972552-13">)</span><span class="w"> </span><span class="n">function</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">called</span><span class="w"> </span><span class="k">after</span><span class="w"> </span><span class="n">sudoers</span><span class="w"> </span><span class="n">has</span><span class="w"> </span><span class="n">been</span><span class="w"> </span><span class="n">parsed</span><span class="w"> </span><span class="n">but</span><span class="w"> </span><span class="n">before</span><span class="w"> </span><span class="n">any</span><span class="w"> </span><span class="n">policy</span><span class="w"> </span><span class="n">checks</span><span class="o">.</span><span class="w">  </span><span class="nc">It</span><span class="w"> </span><span class="n">returns</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">success</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">failure</span><span class="w"> </span><span class="p" data-group-id="8026972552-14">(</span><span class="ow">or</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">plugin</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">configured</span><span class="p" data-group-id="8026972552-14">)</span><span class="p">,</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="o">-</span><span class="mi">1</span><span class="w">
       </span><span class="k">if</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">error</span><span class="w"> </span><span class="n">occurred</span><span class="o">.</span><span class="w">  </span><span class="nc">If</span><span class="w"> </span><span class="n">an</span><span class="w"> </span><span class="n">error</span><span class="w"> </span><span class="n">occurs</span><span class="p">,</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">plugin</span><span class="w"> </span><span class="n">may</span><span class="w"> </span><span class="n">call</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">plugin_printf</span><span class="p" data-group-id="8026972552-15">(</span><span class="p" data-group-id="8026972552-15">)</span><span class="w"> </span><span class="n">function</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="nc">SUDO_CONF_ERROR_MSG</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">present</span><span class="w"> </span><span class="n">additional</span><span class="w"> </span><span class="n">error</span><span class="w"> </span><span class="n">information</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">user</span><span class="o">.</span><span class="w">

       </span><span class="nc">The</span><span class="w"> </span><span class="n">function</span><span class="w"> </span><span class="n">arguments</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="ss">follows</span><span class="p">:</span><span class="w">

       </span><span class="n">version</span><span class="w">
             </span><span class="nc">The</span><span class="w"> </span><span class="n">version</span><span class="w"> </span><span class="n">passed</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">sudoers</span><span class="w"> </span><span class="n">allows</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">plugin</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">determine</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">major</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">minor</span><span class="w"> </span><span class="n">version</span><span class="w"> </span><span class="n">number</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">group</span><span class="w"> </span><span class="n">plugin</span><span class="w"> </span><span class="nc">API</span><span class="w"> </span><span class="n">supported</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">sudoers</span><span class="o">.</span><span class="w">

       </span><span class="n">plugin_printf</span><span class="w">
             </span><span class="nc">A</span><span class="w"> </span><span class="n">pointer</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">printf</span><span class="p" data-group-id="8026972552-16">(</span><span class="p" data-group-id="8026972552-16">)</span><span class="o">-</span><span class="n">style</span><span class="w"> </span><span class="n">function</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">may</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">used</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">display</span><span class="w"> </span><span class="n">informational</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">error</span><span class="w"> </span><span class="n">message</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">user</span><span class="o">.</span><span class="w">  </span><span class="nc">Returns</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">number</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">characters</span><span class="w"> </span><span class="n">printed</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">success</span><span class="w"> </span><span class="ow">and</span><span class="w">
             </span><span class="o">-</span><span class="mi">1</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">failure</span><span class="o">.</span><span class="w">

       </span><span class="n">argv</span><span class="w">  </span><span class="nc">A</span><span class="w"> </span><span class="nc">NULL</span><span class="o">-</span><span class="n">terminated</span><span class="w"> </span><span class="n">array</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">arguments</span><span class="w"> </span><span class="n">generated</span><span class="w"> </span><span class="n">from</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">group_plugin</span><span class="w"> </span><span class="n">option</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">sudoers</span><span class="o">.</span><span class="w">  </span><span class="nc">If</span><span class="w"> </span><span class="n">no</span><span class="w"> </span><span class="n">arguments</span><span class="w"> </span><span class="n">were</span><span class="w"> </span><span class="n">given</span><span class="p">,</span><span class="w"> </span><span class="n">argv</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="nc">NULL</span><span class="o">.</span><span class="w">

 </span><span class="n">cleanup</span><span class="w">
       </span><span class="n">void</span><span class="w"> </span><span class="p" data-group-id="8026972552-17">(</span><span class="o">*</span><span class="n">cleanup</span><span class="p" data-group-id="8026972552-17">)</span><span class="p" data-group-id="8026972552-18">(</span><span class="p" data-group-id="8026972552-18">)</span><span class="p">;</span><span class="w">

       </span><span class="nc">The</span><span class="w"> </span><span class="n">cleanup</span><span class="p" data-group-id="8026972552-19">(</span><span class="p" data-group-id="8026972552-19">)</span><span class="w"> </span><span class="n">function</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">called</span><span class="w"> </span><span class="ow">when</span><span class="w"> </span><span class="n">sudoers</span><span class="w"> </span><span class="n">has</span><span class="w"> </span><span class="n">finished</span><span class="w"> </span><span class="n">its</span><span class="w"> </span><span class="n">group</span><span class="w"> </span><span class="n">checks</span><span class="o">.</span><span class="w">  </span><span class="nc">The</span><span class="w"> </span><span class="n">plugin</span><span class="w"> </span><span class="n">should</span><span class="w"> </span><span class="n">free</span><span class="w"> </span><span class="n">any</span><span class="w"> </span><span class="n">memory</span><span class="w"> </span><span class="n">it</span><span class="w"> </span><span class="n">has</span><span class="w"> </span><span class="n">allocated</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">close</span><span class="w"> </span><span class="n">open</span><span class="w"> </span><span class="n">file</span><span class="w"> </span><span class="n">handles</span><span class="o">.</span><span class="w">

 </span><span class="n">query</span><span class="w">
       </span><span class="n">int</span><span class="w"> </span><span class="p" data-group-id="8026972552-20">(</span><span class="o">*</span><span class="n">query</span><span class="p" data-group-id="8026972552-20">)</span><span class="p" data-group-id="8026972552-21">(</span><span class="n">const</span><span class="w"> </span><span class="n">char</span><span class="w"> </span><span class="o">*</span><span class="n">user</span><span class="p">,</span><span class="w"> </span><span class="n">const</span><span class="w"> </span><span class="n">char</span><span class="w"> </span><span class="o">*</span><span class="n">group</span><span class="p">,</span><span class="w">
           </span><span class="n">const</span><span class="w"> </span><span class="n">struct</span><span class="w"> </span><span class="n">passwd</span><span class="w"> </span><span class="o">*</span><span class="n">pwd</span><span class="p" data-group-id="8026972552-21">)</span><span class="p">;</span><span class="w">

       </span><span class="nc">The</span><span class="w"> </span><span class="n">query</span><span class="p" data-group-id="8026972552-22">(</span><span class="p" data-group-id="8026972552-22">)</span><span class="w"> </span><span class="n">function</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">used</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">ask</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">group</span><span class="w"> </span><span class="n">plugin</span><span class="w"> </span><span class="n">whether</span><span class="w"> </span><span class="n">user</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">member</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">group</span><span class="o">.</span><span class="w">

       </span><span class="nc">The</span><span class="w"> </span><span class="n">function</span><span class="w"> </span><span class="n">arguments</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="ss">follows</span><span class="p">:</span><span class="w">

       </span><span class="n">user</span><span class="w">  </span><span class="nc">The</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">user</span><span class="w"> </span><span class="n">being</span><span class="w"> </span><span class="n">looked</span><span class="w"> </span><span class="n">up</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">external</span><span class="w"> </span><span class="n">group</span><span class="w"> </span><span class="n">database</span><span class="o">.</span><span class="w">

       </span><span class="n">group</span><span class="w">
             </span><span class="nc">The</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">group</span><span class="w"> </span><span class="n">being</span><span class="w"> </span><span class="n">queried</span><span class="o">.</span><span class="w">

       </span><span class="n">pwd</span><span class="w">   </span><span class="nc">The</span><span class="w"> </span><span class="n">password</span><span class="w"> </span><span class="n">database</span><span class="w"> </span><span class="n">entry</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">user</span><span class="p">,</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">any</span><span class="o">.</span><span class="w">  </span><span class="nc">If</span><span class="w"> </span><span class="n">user</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">present</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">password</span><span class="w"> </span><span class="n">database</span><span class="p">,</span><span class="w"> </span><span class="n">pwd</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="nc">NULL</span><span class="o">.</span><span class="w">

 </span><span class="nc">Group</span><span class="w"> </span><span class="nc">API</span><span class="w"> </span><span class="nc">Version</span><span class="w"> </span><span class="nc">Macros</span><span class="w">

 </span><span class="o">/</span><span class="o">*</span><span class="w"> </span><span class="nc">Sudoers</span><span class="w"> </span><span class="n">group</span><span class="w"> </span><span class="n">plugin</span><span class="w"> </span><span class="n">version</span><span class="w"> </span><span class="n">major</span><span class="o">/</span><span class="n">minor</span><span class="w"> </span><span class="o">*</span><span class="o">/</span><span class="w">
 </span><span class="c1">#define GROUP_API_VERSION_MAJOR 1</span><span class="w">
 </span><span class="c1">#define GROUP_API_VERSION_MINOR 0</span><span class="w">
 </span><span class="c1">#define GROUP_API_VERSION ((GROUP_API_VERSION_MAJOR &lt;&lt; 16) | \</span><span class="w">
                            </span><span class="nc">GROUP_API_VERSION_MINOR</span><span class="p">)</span><span class="w">
 </span><span class="nc">For</span><span class="w"> </span><span class="n">getters</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">setters</span><span class="w"> </span><span class="n">see</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nc">Policy</span><span class="w"> </span><span class="n">plugin</span><span class="w"> </span><span class="nc">API</span><span class="o">.</span></code></pre><p>PLUGIN API CHANGELOG</p><pre><code class="makeup elixir" translate="no"><span class="w"> </span><span class="nc">The</span><span class="w"> </span><span class="n">following</span><span class="w"> </span><span class="n">revisions</span><span class="w"> </span><span class="n">have</span><span class="w"> </span><span class="n">been</span><span class="w"> </span><span class="n">made</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nc">Sudo</span><span class="w"> </span><span class="nc">Plugin</span><span class="w"> </span><span class="nc">API</span><span class="o">.</span><span class="w">

 </span><span class="nc">Version</span><span class="w"> </span><span class="mf">1.0</span><span class="w">
       </span><span class="nc">Initial</span><span class="w"> </span><span class="nc">API</span><span class="w"> </span><span class="n">version</span><span class="o">.</span><span class="w">

 </span><span class="nc">Version</span><span class="w"> </span><span class="mf">1.1</span><span class="w"> </span><span class="p" data-group-id="1888360418-1">(</span><span class="n">sudo</span><span class="w"> </span><span class="mf">1.8</span><span class="o">.</span><span class="mi">0</span><span class="p" data-group-id="1888360418-1">)</span><span class="w">
       </span><span class="nc">The</span><span class="w"> </span><span class="nc">I</span><span class="o">/</span><span class="nc">O</span><span class="w"> </span><span class="n">logging</span><span class="w"> </span><span class="n">plugin</span><span class="sc">&#39;s open() function was modified to take the command_info list as an argument.

 Version 1.2 (sudo 1.8.5)
       The Policy and I/O logging plugins&#39;</span><span class="w"> </span><span class="n">open</span><span class="p" data-group-id="1888360418-2">(</span><span class="p" data-group-id="1888360418-2">)</span><span class="w"> </span><span class="n">functions</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">now</span><span class="w"> </span><span class="n">passed</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">list</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">plugin</span><span class="w"> </span><span class="n">parameters</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">any</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">specified</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">sudo</span><span class="o">.</span><span class="n">conf</span><span class="p" data-group-id="1888360418-3">(</span><span class="mi">5</span><span class="p" data-group-id="1888360418-3">)</span><span class="o">.</span><span class="w">

       </span><span class="nc">A</span><span class="w"> </span><span class="n">simple</span><span class="w"> </span><span class="n">hooks</span><span class="w"> </span><span class="nc">API</span><span class="w"> </span><span class="n">has</span><span class="w"> </span><span class="n">been</span><span class="w"> </span><span class="n">introduced</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">allow</span><span class="w"> </span><span class="n">plugins</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">hook</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">system</span><span class="err">&#39;</span><span class="n">s</span><span class="w"> </span><span class="n">environment</span><span class="w"> </span><span class="n">handling</span><span class="w"> </span><span class="n">functions</span><span class="o">.</span><span class="w">

       </span><span class="nc">The</span><span class="w"> </span><span class="n">init_session</span><span class="p" data-group-id="1888360418-4">(</span><span class="p" data-group-id="1888360418-4">)</span><span class="w"> </span><span class="nc">Policy</span><span class="w"> </span><span class="n">plugin</span><span class="w"> </span><span class="n">function</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">now</span><span class="w"> </span><span class="n">passed</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">pointer</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">user</span><span class="w"> </span><span class="n">environment</span><span class="w"> </span><span class="n">which</span><span class="w"> </span><span class="n">can</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">updated</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="n">needed</span><span class="o">.</span><span class="w">  </span><span class="nc">This</span><span class="w"> </span><span class="n">can</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">used</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">merge</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">environment</span><span class="w"> </span><span class="n">variables</span><span class="w">
       </span><span class="n">stored</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nc">PAM</span><span class="w"> </span><span class="n">handle</span><span class="w"> </span><span class="n">before</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">command</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">run</span><span class="o">.</span><span class="w">

 </span><span class="nc">Version</span><span class="w"> </span><span class="mf">1.3</span><span class="w"> </span><span class="p" data-group-id="1888360418-5">(</span><span class="n">sudo</span><span class="w"> </span><span class="mf">1.8</span><span class="o">.</span><span class="mi">7</span><span class="p" data-group-id="1888360418-5">)</span><span class="w">
       </span><span class="nc">Support</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">exec_background</span><span class="w"> </span><span class="n">entry</span><span class="w"> </span><span class="n">has</span><span class="w"> </span><span class="n">been</span><span class="w"> </span><span class="n">added</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">command_info</span><span class="w"> </span><span class="n">list</span><span class="o">.</span><span class="w">

       </span><span class="nc">The</span><span class="w"> </span><span class="n">max_groups</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">plugin_dir</span><span class="w"> </span><span class="n">entries</span><span class="w"> </span><span class="n">were</span><span class="w"> </span><span class="n">added</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">settings</span><span class="w"> </span><span class="n">list</span><span class="o">.</span><span class="w">

       </span><span class="nc">The</span><span class="w"> </span><span class="n">version</span><span class="p" data-group-id="1888360418-6">(</span><span class="p" data-group-id="1888360418-6">)</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">close</span><span class="p" data-group-id="1888360418-7">(</span><span class="p" data-group-id="1888360418-7">)</span><span class="w"> </span><span class="n">functions</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">now</span><span class="w"> </span><span class="n">optional</span><span class="o">.</span><span class="w">  </span><span class="nc">Previously</span><span class="p">,</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">missing</span><span class="w"> </span><span class="n">version</span><span class="p" data-group-id="1888360418-8">(</span><span class="p" data-group-id="1888360418-8">)</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">close</span><span class="p" data-group-id="1888360418-9">(</span><span class="p" data-group-id="1888360418-9">)</span><span class="w"> </span><span class="n">function</span><span class="w"> </span><span class="n">would</span><span class="w"> </span><span class="n">result</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">crash</span><span class="o">.</span><span class="w">  </span><span class="nc">If</span><span class="w"> </span><span class="n">no</span><span class="w"> </span><span class="n">policy</span><span class="w"> </span><span class="n">plugin</span><span class="w"> </span><span class="n">close</span><span class="p" data-group-id="1888360418-10">(</span><span class="p" data-group-id="1888360418-10">)</span><span class="w"> </span><span class="n">function</span><span class="w"> </span><span class="n">is</span><span class="w">
       </span><span class="n">defined</span><span class="p">,</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">default</span><span class="w"> </span><span class="n">close</span><span class="p" data-group-id="1888360418-11">(</span><span class="p" data-group-id="1888360418-11">)</span><span class="w"> </span><span class="n">function</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">provided</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">sudo</span><span class="w"> </span><span class="n">front</span><span class="o">-</span><span class="k">end</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">displays</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">warning</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">command</span><span class="w"> </span><span class="n">could</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">executed</span><span class="o">.</span><span class="w">

       </span><span class="nc">The</span><span class="w"> </span><span class="n">sudo</span><span class="w"> </span><span class="n">front</span><span class="o">-</span><span class="k">end</span><span class="w"> </span><span class="n">now</span><span class="w"> </span><span class="n">installs</span><span class="w"> </span><span class="n">default</span><span class="w"> </span><span class="n">signal</span><span class="w"> </span><span class="n">handlers</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">trap</span><span class="w"> </span><span class="n">common</span><span class="w"> </span><span class="n">signals</span><span class="w"> </span><span class="n">while</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">plugin</span><span class="w"> </span><span class="n">functions</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">run</span><span class="o">.</span><span class="w">

 </span><span class="nc">Version</span><span class="w"> </span><span class="mf">1.4</span><span class="w"> </span><span class="p" data-group-id="1888360418-12">(</span><span class="n">sudo</span><span class="w"> </span><span class="mf">1.8</span><span class="o">.</span><span class="mi">8</span><span class="p" data-group-id="1888360418-12">)</span><span class="w">
       </span><span class="nc">The</span><span class="w"> </span><span class="n">remote_host</span><span class="w"> </span><span class="n">entry</span><span class="w"> </span><span class="n">was</span><span class="w"> </span><span class="n">added</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">settings</span><span class="w"> </span><span class="n">list</span><span class="o">.</span><span class="w">

 </span><span class="nc">Version</span><span class="w"> </span><span class="mf">1.5</span><span class="w"> </span><span class="p" data-group-id="1888360418-13">(</span><span class="n">sudo</span><span class="w"> </span><span class="mf">1.8</span><span class="o">.</span><span class="mi">9</span><span class="p" data-group-id="1888360418-13">)</span><span class="w">
       </span><span class="nc">The</span><span class="w"> </span><span class="n">preserve_fds</span><span class="w"> </span><span class="n">entry</span><span class="w"> </span><span class="n">was</span><span class="w"> </span><span class="n">added</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">command_info</span><span class="w"> </span><span class="n">list</span><span class="o">.</span><span class="w">

 </span><span class="nc">Version</span><span class="w"> </span><span class="mf">1.6</span><span class="w"> </span><span class="p" data-group-id="1888360418-14">(</span><span class="n">sudo</span><span class="w"> </span><span class="mf">1.8</span><span class="o">.</span><span class="mi">11</span><span class="p" data-group-id="1888360418-14">)</span><span class="w">
       </span><span class="nc">The</span><span class="w"> </span><span class="n">behavior</span><span class="w"> </span><span class="ow">when</span><span class="w"> </span><span class="n">an</span><span class="w"> </span><span class="nc">I</span><span class="o">/</span><span class="nc">O</span><span class="w"> </span><span class="n">logging</span><span class="w"> </span><span class="n">plugin</span><span class="w"> </span><span class="n">returns</span><span class="w"> </span><span class="n">an</span><span class="w"> </span><span class="n">error</span><span class="w"> </span><span class="p" data-group-id="1888360418-15">(</span><span class="o">-</span><span class="mi">1</span><span class="p" data-group-id="1888360418-15">)</span><span class="w"> </span><span class="n">has</span><span class="w"> </span><span class="n">changed</span><span class="o">.</span><span class="w">  </span><span class="nc">Previously</span><span class="p">,</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">sudo</span><span class="w"> </span><span class="n">front</span><span class="o">-</span><span class="k">end</span><span class="w"> </span><span class="n">took</span><span class="w"> </span><span class="n">no</span><span class="w"> </span><span class="n">action</span><span class="w"> </span><span class="ow">when</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">log_ttyin</span><span class="p" data-group-id="1888360418-16">(</span><span class="p" data-group-id="1888360418-16">)</span><span class="p">,</span><span class="w"> </span><span class="n">log_ttyout</span><span class="p" data-group-id="1888360418-17">(</span><span class="p" data-group-id="1888360418-17">)</span><span class="p">,</span><span class="w"> </span><span class="n">log_stdin</span><span class="p" data-group-id="1888360418-18">(</span><span class="p" data-group-id="1888360418-18">)</span><span class="p">,</span><span class="w">
       </span><span class="n">log_stdout</span><span class="p" data-group-id="1888360418-19">(</span><span class="p" data-group-id="1888360418-19">)</span><span class="p">,</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">log_stderr</span><span class="p" data-group-id="1888360418-20">(</span><span class="p" data-group-id="1888360418-20">)</span><span class="w"> </span><span class="n">function</span><span class="w"> </span><span class="n">returned</span><span class="w"> </span><span class="n">an</span><span class="w"> </span><span class="n">error</span><span class="o">.</span><span class="w">

       </span><span class="nc">The</span><span class="w"> </span><span class="n">behavior</span><span class="w"> </span><span class="ow">when</span><span class="w"> </span><span class="n">an</span><span class="w"> </span><span class="nc">I</span><span class="o">/</span><span class="nc">O</span><span class="w"> </span><span class="n">logging</span><span class="w"> </span><span class="n">plugin</span><span class="w"> </span><span class="n">returns</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="n">has</span><span class="w"> </span><span class="n">changed</span><span class="o">.</span><span class="w">  </span><span class="nc">Previously</span><span class="p">,</span><span class="w"> </span><span class="n">output</span><span class="w"> </span><span class="n">from</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">command</span><span class="w"> </span><span class="n">would</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">displayed</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">terminal</span><span class="w"> </span><span class="n">even</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">an</span><span class="w"> </span><span class="n">output</span><span class="w"> </span><span class="n">logging</span><span class="w"> </span><span class="n">function</span><span class="w"> </span><span class="n">re</span><span class="err">‐</span><span class="w">
       </span><span class="n">turned</span><span class="w"> </span><span class="mi">0</span><span class="o">.</span><span class="w">

 </span><span class="nc">Version</span><span class="w"> </span><span class="mf">1.7</span><span class="w"> </span><span class="p" data-group-id="1888360418-21">(</span><span class="n">sudo</span><span class="w"> </span><span class="mf">1.8</span><span class="o">.</span><span class="mi">12</span><span class="p" data-group-id="1888360418-21">)</span><span class="w">
       </span><span class="nc">The</span><span class="w"> </span><span class="n">plugin_path</span><span class="w"> </span><span class="n">entry</span><span class="w"> </span><span class="n">was</span><span class="w"> </span><span class="n">added</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">settings</span><span class="w"> </span><span class="n">list</span><span class="o">.</span><span class="w">

       </span><span class="nc">The</span><span class="w"> </span><span class="n">debug_flags</span><span class="w"> </span><span class="n">entry</span><span class="w"> </span><span class="n">now</span><span class="w"> </span><span class="n">starts</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">debug</span><span class="w"> </span><span class="n">file</span><span class="w"> </span><span class="n">path</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">may</span><span class="w"> </span><span class="n">occur</span><span class="w"> </span><span class="n">multiple</span><span class="w"> </span><span class="n">times</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">there</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">multiple</span><span class="w"> </span><span class="n">plugin</span><span class="o">-</span><span class="n">specific</span><span class="w"> </span><span class="nc">Debug</span><span class="w"> </span><span class="n">lines</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">sudo</span><span class="o">.</span><span class="n">conf</span><span class="p" data-group-id="1888360418-22">(</span><span class="mi">5</span><span class="p" data-group-id="1888360418-22">)</span><span class="w"> </span><span class="n">file</span><span class="o">.</span><span class="w">

 </span><span class="nc">Version</span><span class="w"> </span><span class="mf">1.8</span><span class="w"> </span><span class="p" data-group-id="1888360418-23">(</span><span class="n">sudo</span><span class="w"> </span><span class="mf">1.8</span><span class="o">.</span><span class="mi">15</span><span class="p" data-group-id="1888360418-23">)</span><span class="w">
       </span><span class="nc">The</span><span class="w"> </span><span class="n">sudoedit_checkdir</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">sudoedit_follow</span><span class="w"> </span><span class="n">entries</span><span class="w"> </span><span class="n">were</span><span class="w"> </span><span class="n">added</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">command_info</span><span class="w"> </span><span class="n">list</span><span class="o">.</span><span class="w">  </span><span class="nc">The</span><span class="w"> </span><span class="n">default</span><span class="w"> </span><span class="n">value</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">sudoedit_checkdir</span><span class="w"> </span><span class="n">was</span><span class="w"> </span><span class="n">changed</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="no">true</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">sudo</span><span class="w"> </span><span class="mf">1.8</span><span class="o">.</span><span class="mi">16</span><span class="o">.</span><span class="w">

       </span><span class="nc">The</span><span class="w"> </span><span class="n">sudo</span><span class="w"> </span><span class="n">conversation</span><span class="p" data-group-id="1888360418-24">(</span><span class="p" data-group-id="1888360418-24">)</span><span class="w"> </span><span class="n">function</span><span class="w"> </span><span class="n">now</span><span class="w"> </span><span class="n">takes</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">pointer</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">struct</span><span class="w"> </span><span class="n">sudo_conv_callback</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="n">its</span><span class="w"> </span><span class="n">fourth</span><span class="w"> </span><span class="n">argument</span><span class="o">.</span><span class="w">  </span><span class="nc">The</span><span class="w"> </span><span class="n">sudo_conv_t</span><span class="w"> </span><span class="n">definition</span><span class="w"> </span><span class="n">has</span><span class="w"> </span><span class="n">been</span><span class="w"> </span><span class="n">updated</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">match</span><span class="o">.</span><span class="w">  </span><span class="nc">The</span><span class="w"> </span><span class="n">plugin</span><span class="w">
       </span><span class="n">must</span><span class="w"> </span><span class="n">specify</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">it</span><span class="w"> </span><span class="n">supports</span><span class="w"> </span><span class="n">plugin</span><span class="w"> </span><span class="nc">API</span><span class="w"> </span><span class="n">version</span><span class="w"> </span><span class="mf">1.8</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">higher</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="k">receive</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">conversation</span><span class="w"> </span><span class="n">function</span><span class="w"> </span><span class="n">pointer</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">supports</span><span class="w"> </span><span class="n">this</span><span class="w"> </span><span class="n">argument</span><span class="o">.</span><span class="w">

 </span><span class="nc">Version</span><span class="w"> </span><span class="mf">1.9</span><span class="w"> </span><span class="p" data-group-id="1888360418-25">(</span><span class="n">sudo</span><span class="w"> </span><span class="mf">1.8</span><span class="o">.</span><span class="mi">16</span><span class="p" data-group-id="1888360418-25">)</span><span class="w">
       </span><span class="nc">The</span><span class="w"> </span><span class="n">execfd</span><span class="w"> </span><span class="n">entry</span><span class="w"> </span><span class="n">was</span><span class="w"> </span><span class="n">added</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">command_info</span><span class="w"> </span><span class="n">list</span><span class="o">.</span><span class="w">

 </span><span class="nc">Version</span><span class="w"> </span><span class="mf">1.10</span><span class="w"> </span><span class="p" data-group-id="1888360418-26">(</span><span class="n">sudo</span><span class="w"> </span><span class="mf">1.8</span><span class="o">.</span><span class="mi">19</span><span class="p" data-group-id="1888360418-26">)</span><span class="w">
       </span><span class="nc">The</span><span class="w"> </span><span class="n">umask</span><span class="w"> </span><span class="n">entry</span><span class="w"> </span><span class="n">was</span><span class="w"> </span><span class="n">added</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">user_info</span><span class="w"> </span><span class="n">list</span><span class="o">.</span><span class="w">  </span><span class="nc">The</span><span class="w"> </span><span class="n">iolog_group</span><span class="p">,</span><span class="w"> </span><span class="n">iolog_mode</span><span class="p">,</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">iolog_user</span><span class="w"> </span><span class="n">entries</span><span class="w"> </span><span class="n">were</span><span class="w"> </span><span class="n">added</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">command_info</span><span class="w"> </span><span class="n">list</span><span class="o">.</span><span class="w">

 </span><span class="nc">Version</span><span class="w"> </span><span class="mf">1.11</span><span class="w"> </span><span class="p" data-group-id="1888360418-27">(</span><span class="n">sudo</span><span class="w"> </span><span class="mf">1.8</span><span class="o">.</span><span class="mi">20</span><span class="p" data-group-id="1888360418-27">)</span><span class="w">
       </span><span class="nc">The</span><span class="w"> </span><span class="n">timeout</span><span class="w"> </span><span class="n">entry</span><span class="w"> </span><span class="n">was</span><span class="w"> </span><span class="n">added</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">settings</span><span class="w"> </span><span class="n">list</span><span class="o">.</span><span class="w">

 </span><span class="nc">Version</span><span class="w"> </span><span class="mf">1.12</span><span class="w"> </span><span class="p" data-group-id="1888360418-28">(</span><span class="n">sudo</span><span class="w"> </span><span class="mf">1.8</span><span class="o">.</span><span class="mi">21</span><span class="p" data-group-id="1888360418-28">)</span><span class="w">
       </span><span class="nc">The</span><span class="w"> </span><span class="n">change_winsize</span><span class="p" data-group-id="1888360418-29">(</span><span class="p" data-group-id="1888360418-29">)</span><span class="w"> </span><span class="n">function</span><span class="w"> </span><span class="n">was</span><span class="w"> </span><span class="n">added</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">struct</span><span class="w"> </span><span class="n">io_plugin</span><span class="o">.</span><span class="w">

 </span><span class="nc">Version</span><span class="w"> </span><span class="mf">1.13</span><span class="w"> </span><span class="p" data-group-id="1888360418-30">(</span><span class="n">sudo</span><span class="w"> </span><span class="mf">1.8</span><span class="o">.</span><span class="mi">26</span><span class="p" data-group-id="1888360418-30">)</span><span class="w">
       </span><span class="nc">The</span><span class="w"> </span><span class="n">log_suspend</span><span class="p" data-group-id="1888360418-31">(</span><span class="p" data-group-id="1888360418-31">)</span><span class="w"> </span><span class="n">function</span><span class="w"> </span><span class="n">was</span><span class="w"> </span><span class="n">added</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">struct</span><span class="w"> </span><span class="n">io_plugin</span><span class="o">.</span><span class="w">

 </span><span class="nc">Version</span><span class="w"> </span><span class="mf">1.14</span><span class="w"> </span><span class="p" data-group-id="1888360418-32">(</span><span class="n">sudo</span><span class="w"> </span><span class="mf">1.8</span><span class="o">.</span><span class="mi">29</span><span class="p" data-group-id="1888360418-32">)</span><span class="w">
       </span><span class="nc">The</span><span class="w"> </span><span class="n">umask_override</span><span class="w"> </span><span class="n">entry</span><span class="w"> </span><span class="n">was</span><span class="w"> </span><span class="n">added</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">command_info</span><span class="w"> </span><span class="n">list</span><span class="o">.</span><span class="w">

 </span><span class="nc">Version</span><span class="w"> </span><span class="mf">1.15</span><span class="w"> </span><span class="p" data-group-id="1888360418-33">(</span><span class="n">sudo</span><span class="w"> </span><span class="mf">1.9</span><span class="o">.</span><span class="mi">0</span><span class="p" data-group-id="1888360418-33">)</span><span class="w">
       </span><span class="nc">The</span><span class="w"> </span><span class="n">cwd_optional</span><span class="w"> </span><span class="n">entry</span><span class="w"> </span><span class="n">was</span><span class="w"> </span><span class="n">added</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">command_info</span><span class="w"> </span><span class="n">list</span><span class="o">.</span><span class="w">

       </span><span class="nc">The</span><span class="w"> </span><span class="n">event_alloc</span><span class="p" data-group-id="1888360418-34">(</span><span class="p" data-group-id="1888360418-34">)</span><span class="w"> </span><span class="n">function</span><span class="w"> </span><span class="n">was</span><span class="w"> </span><span class="n">added</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">struct</span><span class="w"> </span><span class="n">policy_plugin</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">struct</span><span class="w"> </span><span class="n">io_plugin</span><span class="o">.</span><span class="w">

       </span><span class="nc">The</span><span class="w"> </span><span class="n">errstr</span><span class="w"> </span><span class="n">argument</span><span class="w"> </span><span class="n">was</span><span class="w"> </span><span class="n">added</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">policy</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="nc">I</span><span class="o">/</span><span class="nc">O</span><span class="w"> </span><span class="n">plugin</span><span class="w"> </span><span class="n">functions</span><span class="w"> </span><span class="n">which</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">plugin</span><span class="w"> </span><span class="n">function</span><span class="w"> </span><span class="n">can</span><span class="w"> </span><span class="kn">use</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">return</span><span class="w"> </span><span class="n">an</span><span class="w"> </span><span class="n">error</span><span class="w"> </span><span class="n">string</span><span class="o">.</span><span class="w">  </span><span class="nc">This</span><span class="w"> </span><span class="n">string</span><span class="w"> </span><span class="n">may</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">used</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">audit</span><span class="w"> </span><span class="n">plugin</span><span class="w">
       </span><span class="n">to</span><span class="w"> </span><span class="n">report</span><span class="w"> </span><span class="n">failure</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">error</span><span class="w"> </span><span class="n">conditions</span><span class="w"> </span><span class="n">set</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">other</span><span class="w"> </span><span class="n">plugins</span><span class="o">.</span><span class="w">

       </span><span class="nc">The</span><span class="w"> </span><span class="n">close</span><span class="p" data-group-id="1888360418-35">(</span><span class="p" data-group-id="1888360418-35">)</span><span class="w"> </span><span class="n">function</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">now</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">called</span><span class="w"> </span><span class="n">regardless</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">whether</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">command</span><span class="w"> </span><span class="n">was</span><span class="w"> </span><span class="n">actually</span><span class="w"> </span><span class="n">executed</span><span class="o">.</span><span class="w">  </span><span class="nc">This</span><span class="w"> </span><span class="n">makes</span><span class="w"> </span><span class="n">it</span><span class="w"> </span><span class="n">possible</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">plugins</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">perform</span><span class="w"> </span><span class="n">cleanup</span><span class="w"> </span><span class="n">even</span><span class="w"> </span><span class="ow">when</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">command</span><span class="w">
       </span><span class="n">was</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">run</span><span class="o">.</span><span class="w">

       </span><span class="nc">SUDO_CONV_REPL_MAX</span><span class="w"> </span><span class="n">has</span><span class="w"> </span><span class="n">increased</span><span class="w"> </span><span class="n">from</span><span class="w"> </span><span class="mi">255</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="mi">1023</span><span class="w"> </span><span class="n">bytes</span><span class="o">.</span><span class="w">

       </span><span class="nc">Support</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">audit</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">approval</span><span class="w"> </span><span class="n">plugins</span><span class="w"> </span><span class="n">was</span><span class="w"> </span><span class="n">added</span><span class="o">.</span><span class="w">

 </span><span class="nc">Version</span><span class="w"> </span><span class="mf">1.16</span><span class="w"> </span><span class="p" data-group-id="1888360418-36">(</span><span class="n">sudo</span><span class="w"> </span><span class="mf">1.9</span><span class="o">.</span><span class="mi">3</span><span class="p" data-group-id="1888360418-36">)</span><span class="w">
       </span><span class="nc">Initial</span><span class="w"> </span><span class="n">resource</span><span class="w"> </span><span class="n">limit</span><span class="w"> </span><span class="n">values</span><span class="w"> </span><span class="n">were</span><span class="w"> </span><span class="n">added</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">user_info</span><span class="w"> </span><span class="n">list</span><span class="o">.</span><span class="w">

       </span><span class="nc">The</span><span class="w"> </span><span class="n">cmnd_chroot</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">cmnd_cwd</span><span class="w"> </span><span class="n">entries</span><span class="w"> </span><span class="n">were</span><span class="w"> </span><span class="n">added</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">settings</span><span class="w"> </span><span class="n">list</span><span class="o">.</span><span class="w">

 </span><span class="nc">Version</span><span class="w"> </span><span class="mf">1.17</span><span class="w"> </span><span class="p" data-group-id="1888360418-37">(</span><span class="n">sudo</span><span class="w"> </span><span class="mf">1.9</span><span class="o">.</span><span class="mi">4</span><span class="p" data-group-id="1888360418-37">)</span><span class="w">
       </span><span class="nc">The</span><span class="w"> </span><span class="n">event_alloc</span><span class="p" data-group-id="1888360418-38">(</span><span class="p" data-group-id="1888360418-38">)</span><span class="w"> </span><span class="n">function</span><span class="w"> </span><span class="n">was</span><span class="w"> </span><span class="n">added</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">struct</span><span class="w"> </span><span class="n">audit_plugin</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">struct</span><span class="w"> </span><span class="n">approval_plugin</span><span class="o">.</span><span class="w">

 </span><span class="nc">Version</span><span class="w"> </span><span class="mf">1.18</span><span class="w"> </span><span class="p" data-group-id="1888360418-39">(</span><span class="n">sudo</span><span class="w"> </span><span class="mf">1.9</span><span class="o">.</span><span class="mi">9</span><span class="p" data-group-id="1888360418-39">)</span><span class="w">
       </span><span class="nc">The</span><span class="w"> </span><span class="n">policy</span><span class="w"> </span><span class="n">may</span><span class="w"> </span><span class="n">now</span><span class="w"> </span><span class="n">set</span><span class="w"> </span><span class="n">resource</span><span class="w"> </span><span class="n">limit</span><span class="w"> </span><span class="n">values</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">command_info</span><span class="w"> </span><span class="n">list</span><span class="o">.</span><span class="w">  </span><span class="nc">The</span><span class="w"> </span><span class="n">intercept</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">log_subcmds</span><span class="w"> </span><span class="n">entries</span><span class="w"> </span><span class="n">were</span><span class="w"> </span><span class="n">added</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">command_info</span><span class="w"> </span><span class="n">list</span><span class="o">.</span><span class="w">

 </span><span class="nc">Version</span><span class="w"> </span><span class="mf">1.19</span><span class="w"> </span><span class="p" data-group-id="1888360418-40">(</span><span class="n">sudo</span><span class="w"> </span><span class="mf">1.9</span><span class="o">.</span><span class="mi">11</span><span class="p" data-group-id="1888360418-40">)</span><span class="w">
       </span><span class="nc">The</span><span class="w"> </span><span class="n">intercept_ptrace</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">intercept_setid</span><span class="w"> </span><span class="n">entries</span><span class="w"> </span><span class="n">were</span><span class="w"> </span><span class="n">added</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">settings</span><span class="w"> </span><span class="n">list</span><span class="o">.</span><span class="w">  </span><span class="nc">The</span><span class="w"> </span><span class="n">apparmor_profile</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">use_ptrace</span><span class="w"> </span><span class="n">entries</span><span class="w"> </span><span class="n">were</span><span class="w"> </span><span class="n">added</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">command_info</span><span class="w"> </span><span class="n">list</span><span class="o">.</span><span class="w">

 </span><span class="nc">Version</span><span class="w"> </span><span class="mf">1.20</span><span class="w"> </span><span class="p" data-group-id="1888360418-41">(</span><span class="n">sudo</span><span class="w"> </span><span class="mf">1.9</span><span class="o">.</span><span class="mi">12</span><span class="p" data-group-id="1888360418-41">)</span><span class="w">
       </span><span class="nc">The</span><span class="w"> </span><span class="n">update_ticket</span><span class="w"> </span><span class="n">entry</span><span class="w"> </span><span class="n">was</span><span class="w"> </span><span class="n">added</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">settings</span><span class="w"> </span><span class="n">list</span><span class="o">.</span><span class="w">  </span><span class="nc">The</span><span class="w"> </span><span class="n">intercept_verify</span><span class="w"> </span><span class="n">entry</span><span class="w"> </span><span class="n">was</span><span class="w"> </span><span class="n">added</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">command_info</span><span class="w"> </span><span class="n">list</span><span class="o">.</span><span class="w">

 </span><span class="nc">Version</span><span class="w"> </span><span class="mf">1.21</span><span class="w"> </span><span class="p" data-group-id="1888360418-42">(</span><span class="n">sudo</span><span class="w"> </span><span class="mf">1.9</span><span class="o">.</span><span class="mi">13</span><span class="p" data-group-id="1888360418-42">)</span><span class="w">
       </span><span class="nc">The</span><span class="w"> </span><span class="n">sudoedit_nfiles</span><span class="w"> </span><span class="n">entry</span><span class="w"> </span><span class="n">was</span><span class="w"> </span><span class="n">added</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">command_info</span><span class="w"> </span><span class="n">list</span><span class="o">.</span></code></pre><p>SEE ALSO</p><pre><code class="makeup elixir" translate="no"><span class="w"> </span><span class="n">sudo</span><span class="o">.</span><span class="n">conf</span><span class="p" data-group-id="4120217054-1">(</span><span class="mi">5</span><span class="p" data-group-id="4120217054-1">)</span><span class="p">,</span><span class="w"> </span><span class="n">sudoers</span><span class="p" data-group-id="4120217054-2">(</span><span class="mi">5</span><span class="p" data-group-id="4120217054-2">)</span><span class="p">,</span><span class="w"> </span><span class="n">sudo</span><span class="p" data-group-id="4120217054-3">(</span><span class="mi">8</span><span class="p" data-group-id="4120217054-3">)</span></code></pre><p>AUTHORS</p><pre><code class="makeup elixir" translate="no"><span class="w"> </span><span class="nc">Many</span><span class="w"> </span><span class="n">people</span><span class="w"> </span><span class="n">have</span><span class="w"> </span><span class="n">worked</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">sudo</span><span class="w"> </span><span class="n">over</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">years</span><span class="p">;</span><span class="w"> </span><span class="n">this</span><span class="w"> </span><span class="n">version</span><span class="w"> </span><span class="n">consists</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">code</span><span class="w"> </span><span class="n">written</span><span class="w"> </span><span class="n">primarily</span><span class="w"> </span><span class="ss">by</span><span class="p">:</span><span class="w">

       </span><span class="nc">Todd</span><span class="w"> </span><span class="nc">C</span><span class="o">.</span><span class="w"> </span><span class="nc">Miller</span><span class="w">

 </span><span class="nc">See</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nc">CONTRIBUTORS</span><span class="o">.</span><span class="n">md</span><span class="w"> </span><span class="n">file</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">sudo</span><span class="w"> </span><span class="n">distribution</span><span class="w"> </span><span class="p" data-group-id="5598596634-1">(</span><span class="n">https</span><span class="ss">://</span><span class="n">www</span><span class="o">.</span><span class="n">sudo</span><span class="o">.</span><span class="n">ws</span><span class="o">/</span><span class="n">about</span><span class="o">/</span><span class="n">contributors</span><span class="o">/</span><span class="p" data-group-id="5598596634-1">)</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">an</span><span class="w"> </span><span class="n">exhaustive</span><span class="w"> </span><span class="n">list</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">people</span><span class="w"> </span><span class="n">who</span><span class="w"> </span><span class="n">have</span><span class="w"> </span><span class="n">contributed</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">sudo</span><span class="o">.</span></code></pre><p>BUGS</p><pre><code class="makeup elixir" translate="no"><span class="w"> </span><span class="nc">If</span><span class="w"> </span><span class="n">you</span><span class="w"> </span><span class="n">believe</span><span class="w"> </span><span class="n">you</span><span class="w"> </span><span class="n">have</span><span class="w"> </span><span class="n">found</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">bug</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">sudo</span><span class="p">,</span><span class="w"> </span><span class="n">you</span><span class="w"> </span><span class="n">can</span><span class="w"> </span><span class="n">submit</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">bug</span><span class="w"> </span><span class="n">report</span><span class="w"> </span><span class="n">at</span><span class="w"> </span><span class="n">https</span><span class="ss">://</span><span class="n">bugzilla</span><span class="o">.</span><span class="n">sudo</span><span class="o">.</span><span class="n">ws</span><span class="o">/</span></code></pre><p>SUPPORT</p><pre><code class="makeup elixir" translate="no"><span class="w"> </span><span class="nc">Limited</span><span class="w"> </span><span class="n">free</span><span class="w"> </span><span class="n">support</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">available</span><span class="w"> </span><span class="n">via</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">sudo</span><span class="o">-</span><span class="n">users</span><span class="w"> </span><span class="n">mailing</span><span class="w"> </span><span class="n">list</span><span class="p">,</span><span class="w"> </span><span class="n">see</span><span class="w"> </span><span class="n">https</span><span class="ss">://</span><span class="n">www</span><span class="o">.</span><span class="n">sudo</span><span class="o">.</span><span class="n">ws</span><span class="o">/</span><span class="n">mailman</span><span class="o">/</span><span class="n">listinfo</span><span class="o">/</span><span class="n">sudo</span><span class="o">-</span><span class="n">users</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">subscribe</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">search</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">archives</span><span class="o">.</span></code></pre><p>DISCLAIMER</p><pre><code class="makeup elixir" translate="no"><span class="w"> </span><span class="n">sudo</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">provided</span><span class="w"> </span><span class="err">“</span><span class="nc">AS</span><span class="w"> </span><span class="nc">IS</span><span class="err">”</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">any</span><span class="w"> </span><span class="n">express</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">implied</span><span class="w"> </span><span class="n">warranties</span><span class="p">,</span><span class="w"> </span><span class="n">including</span><span class="p">,</span><span class="w"> </span><span class="n">but</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">limited</span><span class="w"> </span><span class="n">to</span><span class="p">,</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">implied</span><span class="w"> </span><span class="n">warranties</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">merchantability</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">fitness</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">particular</span><span class="w"> </span><span class="n">purpose</span><span class="w"> </span><span class="n">are</span><span class="w">
 </span><span class="n">disclaimed</span><span class="o">.</span><span class="w">  </span><span class="nc">See</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nc">LICENSE</span><span class="o">.</span><span class="n">md</span><span class="w"> </span><span class="n">file</span><span class="w"> </span><span class="n">distributed</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">sudo</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">https</span><span class="ss">://</span><span class="n">www</span><span class="o">.</span><span class="n">sudo</span><span class="o">.</span><span class="n">ws</span><span class="o">/</span><span class="n">about</span><span class="o">/</span><span class="n">license</span><span class="o">/</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">complete</span><span class="w"> </span><span class="n">details</span><span class="o">.</span></code></pre><p>Sudo 1.9.13p1                                                                        January 18, 2023                                                                       Sudo 1.9.13p1</p>
<div class="bottom-actions">
  <div class="bottom-actions-item">

      <a href="sudo_logsrv-proto.html" class="bottom-actions-button" rel="prev">
        <span class="subheader">
          ← Previous Page
        </span>
        <span class="title">
sudo_logsrv.proto
        </span>
      </a>

  </div>
  <div class="bottom-actions-item">

      <a href="swtpm-localca-conf.html" class="bottom-actions-button" rel="next">
        <span class="subheader">
          Next Page →
        </span>
        <span class="title">
swtpm-localca.conf
        </span>
      </a>

  </div>
</div>
      <footer class="footer">
        <p>

          <span class="line">
            <button class="a-main footer-button display-quick-switch" title="Search HexDocs packages">
              Search HexDocs
            </button>

          </span>
        </p>

        <p class="built-using">
          Built using
          <a href="https://github.com/elixir-lang/ex_doc" title="ExDoc" target="_blank" rel="help noopener" translate="no">ExDoc</a> (v0.29.2) for the

            <a href="https://elixir-lang.org" title="Elixir" target="_blank" translate="no">Elixir programming language</a>

        </p>
      </footer>
    </div>
  </div>
</section>
</div>


  </body>
</html>
